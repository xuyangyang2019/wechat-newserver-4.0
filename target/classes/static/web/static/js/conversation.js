(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["conversation"],{"0100":function(e,t,i){"use strict";var n=i("96c9"),s=i.n(n);s.a},"0511":function(e,t,i){},"06f7":function(e,t,i){e.exports=i.p+"static/img/tupian.svg"},"0759":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAAXNSR0IArs4c6QAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAEaADAAQAAAABAAAAEQAAAACtW7E7AAABmElEQVQ4Ea2Uz1XCQBDGN5ADnMAKtAPpADzkPbhBBdIB2kGswFCBdKCe4EaowNBB7CCe4BASfxN2lyU8L+q8t5k/37eTmZ1NvOFwOPU871kp1WW5kpRlOVmtVmkQBL1ms/kK78YlYGfC8TEiDAVhYwj4Xfwe/pQVkiDUCSxHc/vEQ59Hh8BmuVwONKCoTuy18eFUVbocwUajUSm6IY+/yr8kkTMR6VBa/2gqVRTFLS0Y12qXY4MYPoe4ZYMcYmyARsMWmOpYgpaXxNq3iv2ZVDLGmNroyUgZ70Lc3W4XttvtVKZ2go/Wfr+P6rFf+Z6+SHLZ6pLylsc4jjO5kID3hkD7CdU9Ud0L1W195A3w2hBcDWmLH+kzGxiMjVetVmuOviPmyZlIgovLxsY1pOoMuGQPcGTVpcLNiOvgmU87cu1nJJ2gx4AzhzC3s3SCP5lfh8Mhq4MkrkZcj1/4jDokKEtE2pJlRdr5ZPXNx2QRDEqv3gwW4botVL8J8A8qeffzPB8zISGdCaCMeCFB7IQN7m8gAcuYkMTSb3VApofBrJTbAAAAAElFTkSuQmCC"},"0856":function(e,t,i){"use strict";var n=i("e1a9"),s=i.n(n);s.a},"0ad7":function(e,t,i){e.exports=i.p+"static/img/wenben.svg"},"0b16":function(e,t,i){"use strict";var n=i("5203"),s=i.n(n);s.a},"0c01":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAEqADAAQAAAABAAAAEgAAAAC5YZBvAAABXUlEQVQ4Ea1UwW2EMBDEgQf8KOFSQdLBkQcSvC6pIKQDOjg6SAnhOrgfPJ0OuA4uHVx+PEBkxrEjBwEKyq1k7e7s7njXNogoisIgCN4cx3nEmpKnqqqOJpAkyVEIcQaWG4za832/hN4Nw3BCwoWgEWD0G+NTI2cH9W5jtD0GSFLX9f04uMb3mDzuZEygx2EnRrZpmg500MQBTWSKyETnNDYqUaBGhL1H3gf8UudLpcmM9e3oyJKay79ZKpqKoZPPKXw1EUbLuq7LDVkcx+qS/nRGpojaflMYk4SvuIzb1R3ZpBgz1P7mX0Q26dWIBOZrcIB3aLPgDrBP9jkQQ04EtaVtC3Jz1Ak8yNDr+z5zXVcCLKwkQVsT7BGLrNjYfCGgCvgHwMfLa8xQ9IxdHmD/EMA/wC+xfknbto2U8kJQEZkoOihAxE9AiSYo0PpZQ7Nq8h2tIZhlRleb2eBC4AszxILnaCX/+AAAAABJRU5ErkJggg=="},"0d41":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAABKCAYAAABzTVwZAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIQSURBVHgB7dy/SwJhHMfxrxX9QJoCg4Yih6DooiD6B2poaYggqD/QJvcGG1qjyYsCwYQEQckixKAgyucRBU3N1uf9ecHRdd72fXf33AUmvltMsCZM0BQAnAKAUwBwCgBOAcApADgFAKcA4BQAnAKAUwBwCgBOAcApADgFAKcA4BQAnAKAUwBwCgBOAcApADgFAKcA4BQAnAKAUwBwUxa4TOZi7HOTyaQdHOz7nxTBB+AcHZ9a4/1r5Dn1SsFKpUfL5a5QESACcMOv1D9GnjPT2lZX036fFAFyDbC7Nu+3QaJo09LptI+g2Wxa6FABLC3M9Ay+P4JarWpxfOf3E4n2lSB0iFuAM+wvviOVSvX87m4HcRxb6DAB3BYaIz8vv821FgIrfUfDD0DvAUaIoshCh7kC/JdbLywtbFrodAUYoD38aSNAXgHy1azla9meY1uLJ7aVOukZvnsicI+FIcNdAQYNv3N8crbYHb57cUR4CkAFMGz4zuH6me0sb/t9N/xK/dMIMAH8NfzDjXO/f/lw4TcKxBqg+Ho9/vDvM93PZv1/CMKGCKB882x7dv7ruHvOjzbaizy34Htp3fK75z0ZQkJfFs2m9wBwCgBOAcApADgFAKcA4BQAnAKAUwBwCgBOAcApADgFAKcA4BQAnAKAUwBwCgBOAcApADgFAKcA4BQAnAKAUwBwCgBOAcApALgfcOV9OKPdo6wAAAAASUVORK5CYII="},"0e06":function(e,t,i){e.exports=i.p+"static/img/tianjiashipin.png"},"0e5c":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));i("d3b7");var n=i("bc3a"),s=n.create({timeout:1e4});function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.append("packageName","com.jubo.pc"),new Promise((function(t,i){s({url:"http://127.0.0.1:10089/fileUpload2020",method:"post",data:e}).then((function(e){t(e)})).catch((function(e){i(e)}))}))}s.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8",s.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),s.interceptors.response.use((function(e){return e.data}),(function(e){return Promise.reject(e)}))},1093:function(e,t,i){},1644:function(e,t,i){"use strict";var n=i("ba81"),s=i.n(n);s.a},"1baa":function(e,t,i){},"1e59":function(e,t,i){},2532:function(e,t,i){"use strict";var n=i("23e7"),s=i("5a34"),a=i("1d80"),r=i("ab13");n({target:"String",proto:!0,forced:!r("includes")},{includes:function(e){return!!~String(a(this)).indexOf(s(e),arguments.length>1?arguments[1]:void 0)}})},"261c":function(e,t,i){e.exports=i.p+"static/img/tupian-active.svg"},2630:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"friend-circle"},[n("div",{staticClass:"friend-circle-title"},[n("p",[n("span",{staticStyle:{color:"green"},domProps:{textContent:e._s(e.currentFriend.FriendNick)}}),e._v(" 的朋友圈 "),n("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.refreshCircles}},[e._v("刷新")]),n("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.queryCircleListNext}},[e._v("下一页")])],1),n("i",{staticClass:"el-icon-close",on:{click:e.$parent.resetPage}})]),n("ul",{staticClass:"circle-list scroll"},[e._l(e.circleList,(function(t,s){return n("li",{key:s,staticClass:"circle-item"},[t?[t.Content.Text?n("div",{staticClass:"circle-text",domProps:{textContent:e._s(t.Content.Text)}}):e._e(),t.Content.Link?n("div",{staticClass:"circle-link",attrs:{title:"点击打开链接"},on:{click:function(i){return e.openLink(t)}}},[t.Content.Images?n("img",{attrs:{src:t.Content.Images[0].ThumbImg,alt:"这是link"}}):n("span",{staticClass:"circle-link-description",domProps:{textContent:e._s("无效链接")}}),n("span",{staticClass:"circle-link-description",domProps:{textContent:e._s(t.Content.Link.Description)}})]):t.Content.Images?n("div",{staticClass:"circle-img"},e._l(t.Content.Images,(function(e,t){return n("img",{key:t,staticClass:"friend-circle-img",staticStyle:{margin:"5px"},attrs:{src:e.ThumbImg,alt:e.ThumbImg?"图片地址错误":"点击刷新获取缩略图"}})})),0):t.Content.Video?n("div",{staticClass:"circle-video"},[t.Content.Video.Url&&t.Content.Video.Url.startsWith("http")?n("video",{staticClass:"video",attrs:{controls:""}},[n("source",{attrs:{src:t.Content.Video.Url,type:"video/mp4"}})]):n("div",{staticStyle:{position:"relative"}},[t.Content&&t.Content.Video?n("img",{staticClass:"video-thumb",attrs:{src:t.Content.Video.ThumbImg}}):e._e(),n("i",{staticClass:"el-icon-caret-right",attrs:{title:"点击获取视频地址"},on:{click:function(i){return e.pullVideoUrl(t)}}})])]):e._e(),n("div",{staticClass:"time-operation"},[n("span",{staticStyle:{"font-size":"12px",color:"#b2b2b2"},domProps:{textContent:e._s(e.$options.filters.timeFilter(t.PublishTime))}}),n("div",[n("el-button",{attrs:{type:"text",size:"mini",circle:"",icon:"el-icon-star-off",title:"点赞"},on:{click:function(i){return e.likeCircle(t)}}}),n("el-button",{attrs:{type:"text",size:"mini",circle:"",icon:"el-icon-edit",title:"评论"},on:{click:function(i){return e.circleCommentReplyTask(t)}}}),n("el-button",{attrs:{type:"text",size:"mini",circle:"",icon:"el-icon-refresh",title:"刷新"},on:{click:function(i){return e.triggerCirclePushTask(t)}}})],1)]),t.Likes?n("div",{staticClass:"likes-box"},[n("i",{staticClass:"fa fa-heart-o",attrs:{"aria-hidden":"true"}}),n("div",e._l(t.Likes,(function(t,s){return n("div",{key:s},[n("img",{attrs:{src:e.friendsMap[t.FriendId]?e.friendsMap[t.FriendId].Avatar:i("f067")}})])})),0)]):e._e(),t.Comments?n("div",{staticClass:"comment-box"},e._l(t.Comments,(function(s,a){return n("div",{key:a,staticClass:"every-comment"},[n("img",{attrs:{src:e.friendsMap[s.FromWeChatId]?e.friendsMap[s.FromWeChatId].Avatar:i("f067")}}),n("div",{staticClass:"comment-info"},[n("div",{staticClass:"name-time"},[n("span",{staticClass:"ellipsis",domProps:{textContent:e._s(e.friendsMap[s.FromWeChatId]?e.friendsMap[s.FromWeChatId].FriendNick:s.FromWeChatId)}}),n("span",{domProps:{textContent:e._s(e.$options.filters.timeFilter(s.PublishTime))}})]),n("div",{staticClass:"reply-1"},[n("div",{staticClass:"reply-to-friend",attrs:{title:s.Content}},[s.ToWeChatId?n("span",[e._v(" 回复 "),n("span",{staticClass:"reply-friend-name",domProps:{textContent:e._s(e.friendsMap[s.ToWeChatId]?e.friendsMap[s.ToWeChatId].FriendNick:s.ToWeChatId)}}),e._v(" : ")]):e._e(),n("span",{staticClass:"comment-content",domProps:{textContent:e._s(s.Content)}})]),s.FromWeChatId===e.currentFriend.WeChatId?n("i",{staticClass:"fa fa-trash",attrs:{"aria-hidden":"true",title:"删除"},on:{click:function(i){return e.circleCommentDeleteTask(t,s)}}}):n("i",{staticClass:"fa fa-reply",attrs:{"aria-hidden":"true",title:"回复"},on:{click:function(i){return e.circleCommentReplyTask(t,s)}}})])])])})),0):e._e()]:e._e()],2)})),n("li",{staticClass:"ret-tips",domProps:{textContent:e._s(e.retTips)}})],2)])},s=[],a=(i("2ca0"),i("b85c")),r=i("5530"),o=i("2f62"),c=i("2c32"),l={name:"FriendCircle",data:function(){return{loading:!1,pullFriendCircle:!1}},computed:Object(r["a"])({},Object(o["b"])({friendsMap:"nedb/friendsMap",bigImageMap:"conversation/bigImageMap",currentFriend:"conversation/currentFriend",currentFriendId:"conversation/currentFriendId",currentWeChatId:"conversation/currentWeChatId",circleList:"conversation/circleList",retTips:"conversation/retTips"})),watch:{currentFriendId:function(){this.clearCircles(),this.queryCircleList()}},created:function(){this.queryCircleList()},beforeDestroy:function(){this.clearCircles()},methods:{pullVideoUrl:function(e){var t,i=e.CircleId,n=e.Content,s=null===n||void 0===n||null===(t=n.Video)||void 0===t?void 0:t.mediaId;s&&(this.bigImageMap[s]?this.$alert("已经获取到了url,请刷新朋友圈！","提示",{type:"info"}):(this.$message({message:"正在获取视频详情，请稍后再试!",type:"success",duration:2e3}),this.currentWeChatId&&i&&Object(c["n"])(this.currentWeChatId,i,!0)))},queryCircleList:function(){this.currentFriendId&&this.currentWeChatId&&Object(c["q"])(this.currentWeChatId,this.currentFriendId,0)},queryCircleListNext:function(){if(this.currentFriendId){var e=0,t=this.circleList.length-1;t<=0||(this.circleList[t]&&(e=this.circleList[t].CircleId),0!==e&&Object(c["q"])(this.currentWeChatId,this.currentFriendId,e))}else this.$alert("请先指定一个好友！","提示",{type:"warning"})},refreshCircles:function(){console.log("refreshCircles",this.circleList),this.clearCircles(),this.queryCircleList()},clearCircles:function(){this.$store.commit("conversation/SET_RETTIPS",""),this.$store.commit("conversation/RESET_CIRCLE_LIST")},likeCircle:function(e){var t=!1;if(e.Likes){var i,n=Object(a["a"])(e.Likes);try{for(n.s();!(i=n.n()).done;){var s=i.value;if(s.FriendId===this.currentWeChatId){t=!0;break}}}catch(o){n.e(o)}finally{n.f()}}var r=e.CircleId;Object(c["d"])(this.currentWeChatId,r,t,"")},triggerCirclePushTask:function(e){Object(c["B"])(this.currentWeChatId,[e.CircleId])},circleCommentReplyTask:function(e,t){var i=this;this.$prompt("请输入评论内容","评论",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S{1,500}/,inputErrorMessage:"评论字数1-500"}).then((function(n){var s=n.value;i.$message.info("任务已经下发！");var a="",r="";t&&(a=t.FromWeChatId,r=t.CommentId),Object(c["c"])(i.currentWeChatId,e.CircleId,s,a,r)})).catch((function(){}))},circleCommentDeleteTask:function(e,t){var i=this;t.CommentId&&this.$confirm("确认删除该评论 ?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.$message.info("已提交任务"),Object(c["b"])(i.currentWeChatId,e.CircleId,t.CommentId)})).catch((function(){}))},openLink:function(e){var t=e.Content.Link.Url;if(t.startsWith("https://mp.weixin.qq.com/mp"))this.$alert("先程序链接，请在手机上打开！","提示",{type:"info"});else{var i=document.createElement("a");i.setAttribute("href",t),i.setAttribute("target","_blank"),i.setAttribute("id","js_a"),document.getElementById("js_a")&&document.body.removeChild(document.getElementById("js_a")),document.body.appendChild(i),i.click()}}}},d=l,u=(i("cab8"),i("2877")),h=Object(u["a"])(d,n,s,!1,null,"ee99b3e0",null);t["default"]=h.exports},"27ac":function(e,t,i){},"284b":function(e,t,i){"use strict";var n=i("3683"),s=i.n(n);s.a},"2ca0":function(e,t,i){"use strict";var n=i("23e7"),s=i("06cf").f,a=i("50c4"),r=i("5a34"),o=i("1d80"),c=i("ab13"),l=i("c430"),d="".startsWith,u=Math.min,h=c("startsWith"),f=!l&&!h&&!!function(){var e=s(String.prototype,"startsWith");return e&&!e.writable}();n({target:"String",proto:!0,forced:!f&&!h},{startsWith:function(e){var t=String(o(this));r(e);var i=a(u(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return d?d.call(t,n,i):t.slice(i,i+n.length)===n}})},"2e72":function(e,t,i){"use strict";var n=i("8f2e"),s=i.n(n);s.a},"2eac":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAASCAYAAABSO15qAAAAAXNSR0IArs4c6QAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAEKADAAQAAAABAAAAEgAAAABtXQCoAAABt0lEQVQ4EbWTzW3CQBCFseEAp5AK4lQAqSDmgAQ3qACoIHQAJZgKQjrgBhIHTAUxFYRUEHKCA8j5nrW7MlbCLSvZM/tm3pv9mfVKhRGGYb1arb4ADz3PC0x4kabpbLVaxWbujOc8HJFrtdoGtwnhG4EEW8c2lIc/QmQu3w7fOrJUjjAiv51Op2C5XIYQmufz+Qlsh9Brp9MJlWuHW4Gp/kVgK6JNsLbdbjcrlcq7xBEdWtytgOpNgSTENpi36/U6Yf7J95zHnUAOjHN+0d3nDjaL/SZQJN2c/4tAcLNkIehWcLlcDoqxx+wwC3lZj4DpALf5mMe9ziHdcXV9/AS/oXs3p+5yTd6AWxoB7vkm5M4kMMWZKMAqEt21YUVgWSf6vj8EU4Pt1Fi2EPNHTw1ED+h6Uiq3REZkgXmQnxuz4/E4VbeSOwCfseqxH8fxAWAIUIe4KZfLDQKBtgHWp0oL4j024p28ioy/kxjxkqefRrfb7RHIzgO7B4r5ZDVCiGHmcYiQeyqsuRPQxGxnbFZ0tQVVJSUqvsYrAYnYwUEFCH2IyMsMbUUbt9b1gQWspdJePiKHv8iK/wCS8NS2ZBY2NQAAAABJRU5ErkJggg=="},"30bc":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJoSURBVHgB7ZpPaxNBGId/0XbD/oPawkZCSmlAVDA95+JecvMmvfgh/Bx+lPTUe+9echCRbFAomFBcAololEjqJpW676SVht2mrnknxOk8MMwwM0t4MrMz8w6bO4/BLeIObhlaWHW0sOpoYdXRwqqjhVVHC6uOFlYdLaw6a2CiXj/AopRKJfj+U8iETZgoFDx4XgFZ6fd76PX6CMMQjUYD1WoVsmAVJtmN+w8w+vkr23NxImHHsdFud0SdLGlWYYJkh6fZhPMX+e5uWeRBEIhchjS7cBqueReuNf2p4ehs7h9SqTwRuSzp5QjHssUtQ5S7cbppBsiUlir8cNsSo3sVEqf05niY6E+L14WjQMY7LUW4uDV9K/Pr2bZ5WrgopdVzIUnYyNTf87x4GldS22irGo/H4EKKcNp0ncen72Y8HXYS9ZPxKQaDALZtg4v/4mhpGOvgYuWFaeHyfR9crLSwmTdQq9VYp/RS9uF/wYhX+EfbDoy1HDhZyRGeylrsssTSRrjZO0Szf5jatlfYx563L8oyZYmljPA82avt18l2Oh1wIV34JtlLwh+vUS6eJ2SDoIVmMwAXUoX/VnbT9vDSfwUn78zUn3S//QkguJAmnFV205q9Kel+idD9ynekvETKorWo7NGHAyH8eOMZuGEXJtFFZY/e10V5Eo3g4h44YRWmyCY6i1CezI9dbcfBc/9FQvZd6y2OW22UMX0++jyAmXPACZswHf8ojHPjKznX9K7tZxiGuIq1rdnjIgX6Jx9D7JjJMJHO01zk9Jd4iqOFVUcLq44WVh0trDpaWHW0sOpoYdXRwqrzG5kPz20AMo0bAAAAAElFTkSuQmCC"},"365b":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAAAXNSR0IArs4c6QAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAFKADAAQAAAABAAAAEgAAAAAeVSdnAAACHElEQVQ4EYWTT27aUBDGsY0ErEj3SCUS+9IbOAskWCU5AcmuWTW5AT1B0113uLvu4q5AYhHnBs4eKXADsoKIf/19lonGbuKONH7zZr753rx5Y6dkpNPptMvl8v1+vz8fj8eRCf1jdrvd0HGc2Wg0urZB127W6/UMsjnAO5HbmLUhC8Ccgo2tX3aGMIqixWq18vE/q1Lf948EsgLZALI+ZN+4RWBjsp28Q3tV53leROLTcrk80UHyQ3aBbwjZL8gu5MtLpsJDcDKZ6CpnaLtWqw3l1yEiw3x4j0y4NytUQHKoCDNEfSqbqyWHioXJi5d32P10Oo1brRaFOV8ge4GsXUSm3DevfCDVo0B2qj1rvVqtqg2FUkgIQUB2Gz2nwkdIh0XjpJPeJTSzdsnwhuqdSDVORaTJo+hqlUql77quzyEa7gXVDLB/2D+BQ5r4YmJPu90uEB5sjE9jNGMtOSJjNO6xdbU5+hGVPEDmJ5b59Ho99fEudb3iIb7UoLv06ZbNMXoCQZNB/oD9h4RPaUWGrlQidoY+bzabzwav/n5XceqhTgxhj5SZjsU15hHqoxkhsY8G6fBn8NzUdwnW0UUm6z8bKszgt9vt695Nr9fPvdwg5Yzy3MJTwFfbDv77BE8sdszL1XGIoElCk/WGHt2yZsTggScvnOCxk0fx+L0WjUbjJ/P1AtEx2Y/oDT39nWFKNwYPPMHrpa/Ah4L8BQlCGXSLn9/lAAAAAElFTkSuQmCC"},3683:function(e,t,i){},"3d50":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAASCAYAAAC9+TVUAAAAAXNSR0IArs4c6QAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAEaADAAQAAAABAAAAEgAAAADq+8vrAAABuUlEQVQ4EZ2SwXHCQAxFbcYHOIVUEKcC6CDODU6QCuJUAB1AKgjpwHQAJ2C4mAriVBDTgW9wgCHvL96MMczARDNaSV9/pV3tuq1WK3Nd9875n2Sz2ezeU4HD4TCmRlSo4+NLTwRuAjcTiN/F9OR7WpB0Pp/Hxrtx4QYBhQxbRdZ2X7vd7tKpYeNLVidZLBafxZyKpAWgT/WnQnzmkldTW2Qlgr1OkbxiWEERuOZXRKB6IGuHJv8G8S2nfBJN/5WhDSyhbPf7/XS5XCY09m3OU3eAeg6keXJoCWXred4zWFDEdZLEgjxzhC+9KLxeXEpor2NmYhN6YvTLxtesnaEtYv4GoK7VvLLZdM+5hmoHq80OQ0u4s8Ngf5jNBKL5D9hOpVIJoajBBNWLNsCNb08i3NHUSTxCmGLfsComfSf+hvLCHxoZcmHRSWJ0wCw+drvdmOEmxH2pZsTmej5wIEen9CnaM0H+290gCOrValXfPSTxgOo0o+12O43jOBM553TgqHgTXaOTzWYzFMcl+JO8cwi5A5hRbKIkcRdTJ57iR1zJ4MpJToocoWPnWq0WEveFsTnCRFwrxZ7JL5lIvI/3lINgAAAAAElFTkSuQmCC"},"3d6b":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"slot-friends",attrs:{"append-to-body":"",title:e.dialogTilte,visible:e.friendsDialogVisible,"before-close":e.beforeCloseSlotFriendsDialog}},[i("div",{staticClass:"slot-friends-content"},[i("div",{staticClass:"operation-box"},[i("el-input",{staticClass:"search-input",attrs:{size:"small","suffix-icon":"el-icon-search",type:"text",placeholder:"输入昵称搜索"},model:{value:e.searchContent,callback:function(t){e.searchContent=t},expression:"searchContent"}}),i("ul",{directives:[{name:"show",rawName:"v-show",value:!e.searchContent,expression:"!searchContent"}],staticClass:"label-list scroll"},[i("li",{staticClass:"label-item",class:{"current-label":"allFriends"===e.currentLabel},on:{click:function(t){return e.showFriends("allFriends")}}},[i("input",{staticStyle:{"margin-left":"5px"},attrs:{type:"checkbox"},domProps:{checked:e.friendsChecked.length===e.friends.length},on:{click:function(t){return e.choseFriendsByLabel(t,"allFriends")}}}),i("p",[e._v("全部好友")])]),e._l(e.labels,(function(t,n){return i("li",{key:n,staticClass:"label-item",class:[{"current-label":e.currentLabel===t.LabelId},{"label-disabled":0===e.friendsOfEveryLabel[t.LabelId].length}],on:{click:function(i){0!==e.friendsOfEveryLabel[t.LabelId].length&&e.showFriends(t.LabelId)}}},[i("input",{staticStyle:{"margin-left":"5px"},attrs:{type:"checkbox"},domProps:{checked:0!==e.friendsOfEveryLabel[t.LabelId].length&&e.friendsOfEveryLabel[t.LabelId].length===e.friendsCheckedByLabel[t.LabelId].length},on:{click:function(i){return e.choseFriendsByLabel(i,t.LabelId)}}}),i("p",[e._v(e._s(t.LabelName)+"("+e._s(e.friendsOfEveryLabel[t.LabelId].length)+")")])])}))],2)],1),i("div",{staticClass:"friends-list"},[i("el-table",{attrs:{data:e.tableData,stripe:""}},[i("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"60px"}}),i("el-table-column",{attrs:{label:"昵称",prop:"FriendNick"}}),i("el-table-column",{staticStyle:{border:"solid red 1px"},attrs:{label:"头像",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("el-image",{staticStyle:{width:"30px",height:"30px"},attrs:{src:e.row.Avatar}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"30px"}})])])]}}])}),i("el-table-column",{attrs:{label:"备注名",prop:"Memo"}}),i("el-table-column",{attrs:{width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return["allFriends"===e.currentLabel?i("input",{staticStyle:{"margin-left":"5px"},attrs:{type:"checkbox"},domProps:{checked:e.friendsChecked.indexOf(t.row.FriendId)>=0},on:{click:function(i){return e.choseFriend(i,t.row)}}}):i("input",{staticStyle:{"margin-left":"5px"},attrs:{type:"checkbox"},domProps:{checked:e.friendsCheckedByLabel[e.currentLabel].indexOf(t.row.FriendId)>=0},on:{click:function(i){return e.choseFriend(i,t.row)}}})]}}])},[i("template",{slot:"header"})],2)],1)],1)]),i("div",{staticClass:"tip"},[i("p",[e._v("*点击左侧好友标签一键选中当前页面该标签好友")]),i("p",[e._v("共"+e._s(e.friends.length)+"人,已选"+e._s(e.finalFriends.length)+"人")])]),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:e.beforeCloseSlotFriendsDialog}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.submit}},[e._v("确 定")])],1)])},s=[],a=(i("99af"),i("4de4"),i("4160"),i("c975"),i("a15b"),i("d81d"),i("a434"),i("a9e3"),i("159b"),i("b85c")),r=i("5530"),o=i("2f62"),c=i("ca00"),l=i("2c32"),d={props:{currentFriend:{type:Object,required:!0,default:function(){return{}}},friendsDialogVisible:{type:Boolean,required:!0,default:!1},dialogTilte:{type:String,required:!0,default:"好友列表"},action:{type:[String,Number],required:!1,default:0},friends:{type:Array,default:function(){return[]}}},data:function(){return{tableData:this.friends,searchContent:"",currentLabel:"allFriends",friendsChecked:[],friendsCheckedByLabel:{},labelsCheckedId:[],finalFriends:[]}},computed:Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(o["d"])("nedb",{labels:"labels"})),Object(o["b"])({currentWeChatId:"conversation/currentWeChatId",currentFriendId:"conversation/currentFriendId",labelNameMap:"nedb/labelNameMap",labelIdMap:"nedb/labelIdMap"})),{},{friendsOfEveryLabel:function(){var e,t=this,i={},n=Object(a["a"])(this.labels);try{var s=function(){var n=e.value;i[n.LabelId]=t.friends.filter((function(e){return e.LabelIds&&e.LabelIds.indexOf(String(n.LabelId))>=0}))};for(n.s();!(e=n.n()).done;)s()}catch(r){n.e(r)}finally{n.f()}return Object(c["c"])(i,"FriendId")},allReadyMember:function(){var e=[];return 2===this.action&&(this.currentFriend.MemberList&&(e=[].concat(this.currentFriend.MemberList)),this.currentFriend.WeChatId===this.currentFriend.Owner&&e.push(this.currentFriend.WeChatId)),e}}),watch:{searchContent:function(e){var t=this;this.tableData=e?this.friends.filter((function(e){return e.FriendNick?e.FriendNick.indexOf(t.searchContent)>=0:e.Memo?e.Memo.indexOf(t.searchContent)>=0:e.NickName?e.NickName.indexOf(t.searchContent)>=0:e.Nickname?e.Nickname.indexOf(t.searchContent)>=0:void 0})):this.friends}},created:function(){var e,t=Object(a["a"])(this.labels);try{for(t.s();!(e=t.n()).done;){var i=e.value;this.friendsCheckedByLabel[i.LabelId]=[]}}catch(n){t.e(n)}finally{t.f()}},methods:{indexMethod:function(e){return e+1},beforeCloseSlotFriendsDialog:function(){this.$emit("closeSlotFriends",!0)},submit:function(){var e=this.finalFriends.length,t=this.currentFriend.MemberList?this.currentFriend.MemberList.length:0;if(0!==e){var i={WeChatId:this.currentWeChatId};switch(this.action){case 2:if(t+e>=500)return void this.$message.warning("群人数不能超过500人！");i.ChatRoomId=this.currentFriend.UserName,i.Action=this.action,i.Content=this.finalFriends.join(","),this.$store.dispatch("websocket/ChatRoomActionTask",i);break;case 3:i.ChatRoomId=this.currentFriend.UserName,i.Action=this.action,i.Content=this.finalFriends.join(","),this.$store.dispatch("websocket/ChatRoomActionTask",i);break;case 8:if(e>500)return void this.$alert("群聊人数不能大于500！","提示",{type:"warning"});i.ChatRoomId=this.currentFriend.UserName,i.Action=this.action,i.Content=this.finalFriends.join(","),this.$store.dispatch("websocket/ChatRoomActionTask",i);break;case 10:if(1!==e)return void this.$alert("转让群主，只能选择一个群成员！","提示",{type:"warning"});i.ChatRoomId=this.currentFriend.UserName,i.Action=this.action,i.Content=this.finalFriends.join(","),this.$store.dispatch("websocket/ChatRoomActionTask",i);break;case"NameCard":if(e>1)return void this.$message.warning("发名片，只能选择一个好友员！");Object(l["y"])(this.currentWeChatId,this.currentFriendId,this.action,this.finalFriends.join(","));break;case"SendFriendCircle":this.$emit("handlerCheckedFriends",this.finalFriends);break;default:break}"SendFriendCircle"!==this.action&&this.$message.info("任务已经下发!"),this.beforeCloseSlotFriendsDialog()}else this.$alert("请选中好友！","提示",{type:"warning"})},showFriends:function(e){this.tableData="allFriends"===e?this.friends:this.friends.filter((function(t){return t.LabelIds&&t.LabelIds.indexOf(String(e))>=0})),this.currentLabel=e},computedFriends:function(){var e=[].concat(this.friendsChecked);for(var t in this.friendsCheckedByLabel)Object.hasOwnProperty.call(this.friendsCheckedByLabel,t)&&(e=e.concat(this.friendsCheckedByLabel[t]));this.finalFriends=Object(c["c"])(e,"FriendId")},choseFriendsByLabel:function(e,t){var i=this;if("allFriends"===t){if(this.friendsChecked.length===this.friends.length)for(var n in this.friendsChecked=[],this.friendsCheckedByLabel)Object.hasOwnProperty.call(this.friendsCheckedByLabel,n)&&(this.friendsCheckedByLabel[n]=[]);else for(var s in this.friends.forEach((function(e){i.friendsChecked.indexOf(e.FriendId)<0&&i.friendsChecked.push(e.FriendId)})),this.friendsOfEveryLabel)if(Object.hasOwnProperty.call(this.friendsOfEveryLabel,s)){var a=this.friendsOfEveryLabel[s];this.friendsCheckedByLabel[s]=a.map((function(e){return e.FriendId}))}}else{if(0===this.friendsOfEveryLabel[t].length)return void e.preventDefault();var r=this.friendsOfEveryLabel[t],o=this.friendsCheckedByLabel[t];r.length===o.length?this.friendsCheckedByLabel[t]=[]:r.forEach((function(e){o.indexOf(e.FriendId)<0&&o.push(e.FriendId)}))}this.computedFriends()},choseFriend:function(e,t){var i=t.FriendId,n=this.currentLabel;if("allFriends"===this.currentLabel){var s=this.friendsChecked.indexOf(i);s>=0?this.friendsChecked.splice(s,1):this.friendsChecked.push(i)}else{var a=this.friendsCheckedByLabel[n].indexOf(i);a>=0?this.friendsCheckedByLabel[n].splice(a,1):this.friendsCheckedByLabel[n].push(i),this.$forceUpdate()}this.computedFriends()}}},u=d,h=i("2877"),f=Object(h["a"])(u,n,s,!1,null,"544d6a21",null);t["a"]=f.exports},"3e80":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"friend-info scroll"},[i("div",{staticClass:"friend-info-item"},[i("div",{staticClass:"friend-item-title"},[e._v("微信号")]),i("div",{staticClass:"friend-item-content"},[e._v(e._s(e.currentFriend.FriendNo||e.currentFriend.FriendId||"--"))])]),i("div",{staticClass:"friend-info-item"},[i("div",{staticClass:"friend-item-title"},[e._v("昵称")]),i("div",{staticClass:"friend-item-content"},[e._v(" "+e._s(e.currentFriend.FriendNick||"")+" ")])]),i("div",{staticClass:"friend-info-item"},[i("div",{staticClass:"friend-item-title"},[i("span",{staticClass:"tip"},[e._v("备注")]),i("div",{staticClass:"btns"},[i("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-edit-outline",circle:""},on:{click:e.modifyMemo}}),i("el-button",{attrs:{type:"danger",plain:"",icon:"el-icon-delete",circle:""},on:{click:e.deleteMemo}})],1)]),i("div",{staticClass:"friend-item-content"},[e._v(e._s(e.currentFriend.Memo||""))])]),i("div",{staticClass:"friend-info-item"},[i("div",{staticClass:"friend-item-title"},[i("span",{staticClass:"tip"},[e._v("标签")]),i("div",{staticClass:"btns"},[i("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus",circle:""},on:{click:e.addNewLabel}}),i("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-price-tag",circle:""},on:{click:e.showLabelDialog}})],1)]),i("div",{staticClass:"friend-item-content"},e._l(e.currentFriend.LabelIds,(function(t,n){return i("el-tag",{key:n,attrs:{closable:"",type:""},on:{close:function(i){return e.removeLabel(t)}}},[i("span",{domProps:{textContent:e._s(e.labelIdMap[t]||t)}})])})),1)]),i("div",{staticClass:"friend-info-item"},[i("div",{staticClass:"friend-item-title"},[i("span",{staticClass:"tip"},[e._v("电话")]),i("div",{staticClass:"btns"},[i("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus",circle:""},on:{click:e.addPhone}}),i("el-button",{attrs:{type:"danger",plain:"",icon:"el-icon-delete",circle:"",title:"清空号码"},on:{click:e.deleteAllPhone}})],1)]),i("div",{staticClass:"friend-item-content"},e._l(e.phones,(function(t,n){return i("div",{key:n,staticClass:"phone-item"},[i("span",{domProps:{textContent:e._s(t)}}),i("el-button",{staticClass:"delete-one-phone",staticStyle:{padding:"2px"},attrs:{type:"primary",plain:"",icon:"el-icon-close",circle:""},on:{click:function(t){return e.deleteOnePhone(n)}}})],1)})),0)]),i("div",{staticClass:"friend-info-item"},[i("div",{staticClass:"friend-item-title"},[i("span",{staticClass:"tip"},[e._v("描述")]),i("div",{staticClass:"btns"},[i("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-edit-outline",circle:""},on:{click:e.modifyDesc}}),i("el-button",{attrs:{type:"danger",plain:"",icon:"el-icon-delete",circle:""},on:{click:e.deleteDesc}})],1)]),i("div",{staticClass:"friend-item-content"},[e._v(e._s(e.currentFriend.Desc||"--"))])]),i("div",{staticClass:"friend-info-item"},[e._m(0),i("div",{staticClass:"friend-item-content"},[e.currentFriend.Source?i("div",{domProps:{textContent:e._s(e.$options.filters.getFriendSource(e.currentFriend.Source))}}):e._e()])]),i("div",{staticClass:"friend-info-item"},[e._m(1),i("div",{staticClass:"friend-item-content"},[i("div",{domProps:{textContent:e._s(e.currentFriend.SourceExt||"--")}})])]),i("el-dialog",{staticClass:"label-remark-add-label",attrs:{title:"添加标签","append-to-body":"",visible:e.labelDialogVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.labelDialogVisible=t}}},[i("p",{staticClass:"p-class"},[e._v("手机标签")]),i("ul",e._l(e.labels,(function(t,n){return i("li",{key:"label"+n,staticClass:"label-class",class:{chose:e.currentTag===t.LabelName},on:{click:function(){e.currentTag=t.LabelName,e.tagKey=t.LabelId}}},[e._v(" "+e._s(t.LabelName)+" ")])})),0),i("p",{staticClass:"p-class"},[e._v("公共标签")]),i("ul",e._l(e.publicTags,(function(t,n){return i("li",{key:"tag"+n,staticClass:"label-class",class:{chose:e.currentTag===t.name},on:{click:function(i){e.currentTag=t.name}}},[e._v(" "+e._s(t.name)+" ")])})),0),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.labelDialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.modifyLabels}},[e._v("确 定")])],1)])],1)},s=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"friend-item-title"},[i("span",{staticClass:"tip"},[e._v("来源")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"friend-item-title"},[i("span",{staticClass:"tip"},[e._v("来源扩展信息")])])}],a=(i("4de4"),i("c975"),i("a15b"),i("4d63"),i("ac1f"),i("25f0"),i("5319"),i("1276"),i("b85c")),r=i("5530"),o=i("2f62"),c=i("3496"),l={name:"FriendInfo",data:function(){return{publicTags:[],labelDialogVisible:!1,currentTag:"",tagKey:0}},computed:Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(o["d"])("nedb",{labels:"labels"})),Object(o["b"])({currentUser:"currentUser",labelIdMap:"nedb/labelIdMap",labelNameMap:"nedb/labelNameMap",currentFriend:"conversation/currentFriend"})),{},{phones:function(){if(this.currentFriend.Phone){var e=this.currentFriend.Phone.replace(/，$/,"");return e.split("，")}return[]}}),mounted:function(){var e=this;Object(c["n"])(this.currentUser.UnionId).then((function(t){0===t.code&&(e.publicTags=t.data||[])})).catch((function(t){e.$message.error(t.message)}))},methods:{modifyMemo:function(){var e=this;this.currentFriend.FriendId?this.currentFriend.isGh?this.$message.warning("不能修改公众号的备注！"):this.$prompt('修改<b style="color:green;"> '.concat(this.currentFriend.FriendNick," </b>的备注"),"修改备注",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:this.currentFriend.Memo,inputValue:this.currentFriend.Memo,dangerouslyUseHTMLString:!0,inputPattern:/\S{1,50}/,inputErrorMessage:"备注长度1-50，不能含有特殊字符！"}).then((function(t){var i=t.value,n={WeChatId:e.currentFriend.WeChatId,FriendId:e.currentFriend.FriendId,Memo:i};e.$store.dispatch("websocket/ModifyFriendMemoTask",n)})).catch((function(){e.$message({type:"info",message:"取消输入"})})):this.$message.warning("请先选择一个好友！")},deleteMemo:function(){var e=this;this.currentFriend.FriendId?this.currentFriend.Memo?this.$confirm("删除备注?","删除备注",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={WeChatId:e.currentFriend.WeChatId,FriendId:e.currentFriend.FriendId,DelFlag:1};e.$store.dispatch("websocket/ModifyFriendMemoTask",t)})).catch((function(){e.$message({type:"info",message:"已取消删除"})})):this.$message.warning("该好友没有备注，无需删除！"):this.$message.warning("请先选择一个好友！")},modifyDesc:function(){var e=this;this.currentFriend.FriendId?this.currentFriend.isGh?this.$message.warning("不能修改公众号的描述！"):this.$prompt('修改<b style="color:green;"> '.concat(this.currentFriend.FriendNick," </b>的描述"),"修改描述",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:this.currentFriend.Desc,inputValue:this.currentFriend.Desc,dangerouslyUseHTMLString:!0,inputPattern:/\S{1,200}/,inputErrorMessage:"备注长度1-200，不能含有特殊字符！"}).then((function(t){var i=t.value,n={WeChatId:e.currentFriend.WeChatId,FriendId:e.currentFriend.FriendId,Desc:i};e.$store.dispatch("websocket/ModifyFriendMemoTask",n)})).catch((function(){e.$message({type:"info",message:"取消输入"})})):this.$message.warning("请先选择一个好友！")},deleteDesc:function(){var e=this;this.currentFriend.FriendId?this.currentFriend.Desc?this.$confirm("删除描述?","删除描述",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={WeChatId:e.currentFriend.WeChatId,FriendId:e.currentFriend.FriendId,DelFlag:2};e.$store.dispatch("websocket/ModifyFriendMemoTask",t)})).catch((function(){e.$message({type:"info",message:"已取消删除"})})):this.$message.warning("该好友没有描述，无需删除！"):this.$message.warning("请先选择一个好友！")},addPhone:function(){var e=this;this.currentFriend.FriendId?this.currentFriend.isGh?this.$message.warning("不能修改公众号的电话！"):this.$prompt('修改<b style="color:green;"> '.concat(this.currentFriend.FriendNick," </b>的电话号码"),"修改电话号码",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"两个号码之间用逗号隔开",inputValue:this.currentFriend.Phone,dangerouslyUseHTMLString:!0}).then((function(t){var i=t.value,n=new RegExp(/0\d{2,3}-[1-9]\d{6,7}|1[3-9]\d{9}/),s=i.replace(/,/g,"，").split("，"),a=s.filter((function(e){return n.test(e)}));if(0===a.length)e.$message.warning("电话号码的格式有问题，请重新输入！");else{var r={WeChatId:e.currentFriend.WeChatId,FriendId:e.currentFriend.FriendId,Phone:a.join(",").replace(/,/g,"，")};e.$store.dispatch("websocket/ModifyFriendMemoTask",r)}})).catch((function(t){e.$message({type:"warning",message:t})})):this.$message.warning("请先选择一个好友！")},deleteAllPhone:function(){var e=this;this.currentFriend.FriendId?this.currentFriend.Phone?this.$confirm("清空电话?","清空电话",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={WeChatId:e.currentFriend.WeChatId,FriendId:e.currentFriend.FriendId,DelFlag:4};e.$store.dispatch("websocket/ModifyFriendMemoTask",t)})).catch((function(){e.$message({type:"info",message:"已取消删除"})})):this.$message.warning("该好友没有电话，无需清空！"):this.$message.warning("请先选择一个好友！")},deleteOnePhone:function(e){var t=this;this.currentFriend.FriendId?this.currentFriend.Phone?this.$confirm("删除该电话?","删除该电话",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i,n="",s=Object(a["a"])(t.phones);try{for(s.s();!(i=s.n()).done;){var r=i.value;r!==t.phones[e]&&(n=r+"，")}}catch(l){s.e(l)}finally{s.f()}n=n.replace(/，$/,"");var o={WeChatId:t.currentFriend.WeChatId,FriendId:t.currentFriend.FriendId,Phone:n};if(""!==n)t.$store.dispatch("websocket/ModifyFriendMemoTask",o);else{var c={WeChatId:t.currentFriend.WeChatId,FriendId:t.currentFriend.FriendId,DelFlag:4};t.$store.dispatch("websocket/ModifyFriendMemoTask",c)}})).catch((function(){t.$message({type:"info",message:"已取消删除"})})):this.$message.warning("该好友没有电话，无需清空！"):this.$message.warning("请先选择一个好友！")},addNewLabel:function(){var e=this;this.currentFriend.FriendId?this.currentFriend.isGh?this.$message.warning("不能给公众号打标签！"):this.$prompt("标签名不能与现有的重复！","新建标签",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S{1,200}/,inputErrorMessage:"标签长度不对"}).then((function(t){var i=t.value,n={WeChatId:e.currentFriend.WeChatId,LabelName:i,LabelId:0,AddList:e.currentFriend.FriendId};e.$store.dispatch("websocket/ContactLabelTask",n)})).catch((function(){})):this.$message.warning("请先选择一个好友！")},modifyLabels:function(){if(0===this.tagKey&&(this.tagKey=this.labelNameMap[this.currentTag]||0),this.currentTag)if(this.currentFriend.LabelIds&&this.currentFriend.LabelIds.indexOf(String(this.tagKey))>=0)this.$alert("该标签已经打过，不能重复打！","提示",{type:"warning"});else{var e={WeChatId:this.currentFriend.WeChatId,AddList:this.currentFriend.FriendId,LabelName:this.currentTag,LabelId:this.tagKey};this.$store.dispatch("websocket/ContactLabelTask",e),this.labelDialogVisible=!1,this.currentTag="",this.tagKey=0}else this.$message.warning("请选择一个标签！")},removeLabel:function(e){var t=this;this.currentFriend.FriendId?this.$confirm("移除该标签?","移除标签",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i={WeChatId:t.currentFriend.WeChatId,LabelId:e,DelList:t.currentFriend.FriendId};t.$store.dispatch("websocket/ContactLabelTask",i)})).catch((function(){})):this.$message.warning("请先选择一个好友！")},showLabelDialog:function(){this.currentFriend.FriendId?this.currentFriend.isGh?this.$message.warning("不能给公众号打标签！"):this.labelDialogVisible=!0:this.$message.warning("请先选择一个好友！")},handleClose:function(e){this.currentTag="",this.tagKey=0,e()}}},d=l,u=(i("5129"),i("2877")),h=Object(u["a"])(d,n,s,!1,null,"55a347e0",null);t["default"]=h.exports},"3f99":function(e,t,i){"use strict";var n=i("1baa"),s=i.n(n);s.a},"423f":function(e,t,i){},"440d":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAAAXNSR0IArs4c6QAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAFKADAAQAAAABAAAAEQAAAABZ9V23AAABpElEQVQ4Ea2TzW3CQBBGcfABbpQQKggd4ByQzClQQaACQgWBCiAVxB1ATiBxiKkgpoKYDuCGBMh5H7KRsVccICMN3p2defOzi+W6rmdZ1mvhHySKoq4dw5Zs/HuYcDpSWxDB5vP54B5gs9l0FH8CmkCNRqNWLBZfOAt3u92X7/sbk1/W9pA1aK+52rb9QwsD1CuXy79KYPLN2nJAYJqFLqk/m80sxlFF11Q7yQab9jkgTi0AK2BjBTDbkM8bSR5J5rC+KsYZEmyc1/F43Kh1xvENtZIi95O1qcIph3VurSUnx3EqJOhR9XaxWAT7/T5k/YEOEz0cDr58JbkKadGjNbU44RuqVTkiXf3Etz3QOi0UcNpeAFVNqVSaAHki+wqPAF2zrmEbkaBA24FeQALjrBrPOQ/keUwVzEkbJ7V+kjiRB/QTWBuf5+QsDZPtXCHZO+zrBLW54TNMTnGbLdrygY2AVGU3SfpSkudyAUsHAdNDv/p8zhXiGBLspwHZNX/BgLEss/b03qKNCMOS7Hpbtwr1WD2CVzagIZt3tH4rTXFwtjDGf5xzw1vg9C/XAAAAAElFTkSuQmCC"},4475:function(e,t,i){},5129:function(e,t,i){"use strict";var n=i("87c8"),s=i.n(n);s.a},5203:function(e,t,i){},"53ad":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"conversation-list"},[i("div",{staticClass:"search-box"},[i("el-input",{attrs:{"prefix-icon":"el-icon-search",type:"text",placeholder:"搜索",maxlength:"20",size:"small","show-word-limit":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchChange(t)}},model:{value:e.searchInfo,callback:function(t){e.searchInfo=t},expression:"searchInfo"}})],1),i("el-row",{staticStyle:{margin:"5px"},attrs:{type:"flex",justify:"center"}},[i("el-button",{attrs:{size:"small"},on:{click:e.autoRead}},[e._v("一键设为已读")]),i("el-button",{attrs:{size:"small",type:e.onlyUnRead?"warning":"plain"},on:{click:e.findUnReadMsg}},[e._v("仅展示未读")])],1),i("div",{staticClass:"friends-content scroll",attrs:{id:"friends-list"},on:{scroll:e.handlerScroll}},[i("div",[i("el-row",{staticStyle:{height:"40px","font-weight":"600",cursor:"pointer"},attrs:{type:"flex",align:"middle",justify:"space-between"},nativeOn:{click:function(t){return e.toggleQwData(t)}}},[i("p",[e._v("企业微信的消息")]),e.showQw?i("i",{staticClass:"el-icon-arrow-up"}):i("i",{staticClass:"el-icon-arrow-right"})]),e._l(e.qwData,(function(t,n){return i("div",{directives:[{name:"show",rawName:"v-show",value:e.showQw,expression:"showQw"}],key:n,staticClass:"friend-info",class:{selected:e.currentFriendId===t.UserName},staticStyle:{"margin-left":"10px"},on:{click:function(i){return e.$parent.choseFriend(t)}}},[i("div",{staticClass:"avatar-tip"},[i("el-avatar",{key:t.Avatar,attrs:{shape:"square",size:40,src:t.Avatar}},[i("i",{staticClass:"fa fa-picture-o",attrs:{"aria-hidden":"true",title:"头像miss"}})]),t.UnreadCnt?i("div",{staticClass:"tip",attrs:{title:t.UnreadCnt},domProps:{textContent:e._s(t.UnreadCnt>99?"...":t.UnreadCnt)}}):e._e()],1),i("div",{staticClass:"nick-content"},[i("div",{staticClass:"friend-nick ellipsis",domProps:{textContent:e._s(t.ShowName)}}),t.Digest?i("div",{staticClass:"chat-content ellipsis"},[t.AtCount?i("span",{staticStyle:{color:"red"}},[e._v("[有人@你]")]):e._e(),i("span",{domProps:{textContent:e._s(t.Digest.replace("%s:",""))}})]):i("div",{staticClass:"chat-content ellipsis",domProps:{textContent:e._s("")}})]),i("div",{staticClass:"time-disturb"},[i("div",{domProps:{textContent:e._s(e.$options.filters.transformTime(t.UpdateTime))}}),e._e()])])}))],2),e._l(e.searchInfo?e.searchResult:e.conversations,(function(t,n){return i("div",{key:n,staticClass:"friend-info",class:{selected:e.currentFriendId===t.UserName},on:{click:function(i){return e.$parent.choseFriend(t)}}},[i("div",{staticClass:"avatar-tip"},[i("el-avatar",{key:t.Avatar,attrs:{shape:"square",size:40,src:t.Avatar}},[i("i",{staticClass:"fa fa-picture-o",attrs:{"aria-hidden":"true",title:"头像miss"}})]),t.IsSilent||!t.UnreadCnt||!t.Digest||t.Digest.startsWith("你已添加了")||t.Digest.startsWith("以上是打招呼的内容")?e._e():i("div",{staticClass:"tip",attrs:{title:t.UnreadCnt},domProps:{textContent:e._s(t.UnreadCnt<99?t.UnreadCnt:"...")}})],1),i("div",{staticClass:"nick-content"},[i("div",{staticClass:"friend-nick ellipsis",domProps:{textContent:e._s(t.ShowName)}}),t.Digest?i("div",{staticClass:"chat-content ellipsis"},[t.AtCount?i("span",{staticStyle:{color:"red"}},[e._v("[有人@你]")]):e._e(),i("span",{domProps:{textContent:e._s(t.Digest.replace("%s:",""))}})]):i("div",{staticClass:"chat-content ellipsis",domProps:{textContent:e._s("")}})]),i("div",{staticClass:"time-disturb"},[i("div",{domProps:{textContent:e._s(e.$options.filters.transformTime(t.UpdateTime))}}),i("div",{staticClass:"opration-btns"},["notifymessage"!==t.UserName?[i("i",{staticClass:"el-icon-upload2",class:{"top-convs":t.IsTop},attrs:{"aria-hidden":"true",title:"置顶"},on:{click:function(i){return i.stopPropagation(),e.setTop(t)}}}),i("i",{staticClass:"fa fa-retweet sigle-fresh",attrs:{"aria-hidden":"true",title:"刷新"},on:{click:function(i){return i.stopPropagation(),e.$parent.getFriendDetail(t)}}}),i("i",{staticClass:"el-icon-close-notification",class:{"msg-silent":t.IsSilent},attrs:{"aria-hidden":"true",title:"免打扰"},on:{click:function(i){return i.stopPropagation(),e.msgSilent(t)}}}),t.UnreadCnt?e._e():i("i",{staticClass:"el-icon-warning-outline",attrs:{"aria-hidden":"true",title:"设为未读"},on:{click:function(i){return i.stopPropagation(),e.setUnread(t)}}})]:e._e()],2)])])})),e.currentWeChatId&&e.maxNumber>=e.currentConvs.length?i("div",{staticClass:"current-info-null"},[i("el-button",{attrs:{size:"small"},on:{click:e.queryMoreConv}},[e._v("加载更多")]),i("el-button",{attrs:{size:"small"},on:{click:function(t){return e.queryMoreConv("all")}}},[e._v("加载全部")])],1):e._e()],2)],1)},s=[],a=(i("99af"),i("4de4"),i("4160"),i("c975"),i("fb6a"),i("159b"),i("5530")),r=i("2f62"),o=i("2c32"),c={data:function(){return{maxNumber:20,searchInfo:"",searchResult:[],onlyUnRead:!1,conversUnread:[],showQw:!1}},computed:Object(a["a"])(Object(a["a"])({},Object(r["b"])({currentConvs:"conversation/currentConvs",qwConversations:"conversation/qwConversations",currentFriendId:"conversation/currentFriendId",currentWeChatId:"conversation/currentWeChatId"})),{},{conversations:function(){var e=this;if(this.onlyUnRead){var t=this.currentConvs.filter((function(t){return!!t.UnreadCnt||e.conversUnread.indexOf(t.WeChatId+t.UserName)>=0}));return t}var i=this.currentConvs.filter((function(e){return e.IsTop})),n=this.currentConvs.filter((function(e){return!e.IsTop})),s=i.concat(n).slice(0,this.maxNumber);return s},qwData:function(){return this.qwConversations}}),watch:{searchInfo:function(){this.debounceInput()},currentWeChatId:function(){this.maxNumber=20,this.onlyUnRead=!1,this.conversUnread=[]}},created:function(){this.debounceInput=this._.debounce(this.debounceInput,500)},methods:{toggleQwData:function(){this.showQw=!this.showQw},autoRead:function(){var e=this;this.currentConvs.forEach((function(t){t.UnreadCnt>0&&e.$parent.setMessageRead(t)}))},findUnReadMsg:function(){if(this.onlyUnRead=!this.onlyUnRead,this.onlyUnRead){var e=[];this.currentConvs.forEach((function(t){t.UnreadCnt&&e.push(t.WeChatId+t.UserName)})),this.conversUnread=e}else this.conversUnread=[]},handlerScroll:function(){var e=document.getElementById("friends-list").scrollTop,t=document.getElementById("friends-list").clientHeight,i=document.getElementById("friends-list").scrollHeight;e+t+2>=i&&this.maxNumber<=this.currentConvs.length&&(this.maxNumber=this.maxNumber+5)},debounceInput:function(){var e=this;if(this.searchInfo){var t=this.currentConvs.filter((function(t){return t.ShowName&&t.ShowName.indexOf(e.searchInfo)>=0}));this.searchResult=t}else this.searchResult=[]},msgSilent:function(e){var t={WeChatId:e.WeChatId,ChatRoomId:e.UserName,Action:6,IntValue:e.IsSilent?1:0};this.$store.dispatch("websocket/ChatRoomActionTask",t),this.$message.success("任务已经下发！")},setUnread:function(e){Object(o["G"])(e.WeChatId,e.UserName),this.$store.commit("conversation/SET_CONV_UNREAD",e)},setTop:function(e){var t={WeChatId:e.WeChatId,ChatRoomId:e.UserName,Action:16,IntValue:e.IsTop?0:1};this.$store.dispatch("websocket/ChatRoomActionTask",t),this.$message.success("任务已经下发！")},queryMoreConv:function(e){var t=this.currentConvs.length;if("all"!==e&&0!==t){if(t>0){var i=this.currentConvs[t-1].UpdateTime,n=i-2592e5;Object(o["C"])(this.currentWeChatId,n,i)}}else Object(o["C"])(this.currentWeChatId,0)}}},l=c,d=(i("3f99"),i("2877")),u=Object(d["a"])(l,n,s,!1,null,"b565bbea",null);t["default"]=u.exports},"556a":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAEqADAAQAAAABAAAAEgAAAAC5YZBvAAAB+UlEQVQ4EY2TsVLCQBCGCVBIpQ9AkQJm6EhpRyyYgc7SzvgEwpNIpx3xDbQChsLkDbCzoNAnUHsY/P6b20xgdGRnNnv7396f//bugsovNhgMYuDrIAgioly22u12K+LjfD7PBJQtKCf9fj+q1Wp3EMSGs/hVY7BuCcu22+14uVyK2FlBJJJ6vf4Ceobn+GQ2mz25Kv8ZDoeXDEd4D//abDYXRuaIyiQouEF6SuGfxtYTFE4pKMiqqkbJhHB2DInq/Y/GWqNWCAvUWNi1pZytxJIP4S25lL0TC6M2JJlaf6jNyHvUX0hRgsukqgIY+WaHyg9MW4pRoV7J3BpiIqJIyGFjhf1ntgbyblUfVLgj1kLyFUGn9o4fWgqQ+xo359dGdWVM7BzKx//lyfJy9D2Ly5iNq8ZogEVdCRtb/A1DhNtRrdVqnZNE7Xb7db1ev2mR7gkNnTEXNpvNPAzDk06ncw/2APZBnbZf8Rf0iuFCzU5xnZaO3Cwj/+YHSaPR+JRrLIyCzIqIIz9Oq+xbEzmFsZRoQr3grsQsfFYu01iY3S1f22MqF0fxRJCdQXbKgqOfiFcYidwR6Y9qZIlMW5ssFotCkWrs1ku9SKRw79GqSOYf74ShJJu5xpJEBhBzXv7ISIQXikpFOrWYPMH1XLpE9UiXVqSpekLcsx8rygtzZR1tWQAAAABJRU5ErkJggg=="},"594f":function(e,t,i){},5980:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"group-assistant"},[e.showAddPage?i("GroupAssistantSend"):[i("div",{staticClass:"group-assistant-title"},[i("div",{staticClass:"log-type"},[i("p",[e._v("群发列表")]),i("el-radio-group",{staticClass:"send-log-tab",model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},[i("el-radio",{attrs:{label:1}},[e._v("群发好友")]),i("el-radio",{attrs:{label:5}},[e._v("群发群")])],1)],1),i("el-button",{staticStyle:{"background-color":"#ff9f00",color:"#ffffff",border:"solid #ff9f00 1px"},attrs:{size:"small",icon:"el-icon-plus"},on:{click:e.togglePage}},[e._v(" 新增群发 ")])],1),i("GroupAssistantLog",{attrs:{currentTab:e.currentTab}})]],2)},s=[],a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"group-send"},[n("div",{staticClass:"filter-box"},[n("div",{staticClass:"tab-title"},[n("p",{staticClass:"can-not-select",class:{tabChose:"friendsTab"===e.currentTab},on:{click:function(t){e.currentTab="friendsTab"}}},[e._v(" 好友群发 ")]),n("p",{staticClass:"can-not-select",class:{tabChose:"roomsTab"===e.currentTab},on:{click:function(t){e.currentTab="roomsTab"}}},[e._v(" 群推送 ")])]),n("ul",{directives:[{name:"show",rawName:"v-show",value:!e.searchContent,expression:"!searchContent"}],staticClass:"labels-list scroll"},["friendsTab"===e.currentTab?[n("li",{staticClass:"label-item",class:{"current-label":"allFriends"===e.currentLabel},on:{click:function(t){return e.showFriends("allFriends")}}},[n("input",{staticStyle:{"margin-left":"5px"},attrs:{type:"checkbox"},domProps:{checked:e.friendsChecked.length===e.friends.length},on:{click:function(t){return e.choseFriendsByLabel(t,"allFriends")}}}),n("p",{domProps:{textContent:e._s("全部好友")}})]),e._l(e.labels,(function(t,i){return n("li",{key:i,staticClass:"label-item",class:[{"current-label":e.currentLabel===t.LabelId},{"label-disabled":0===e.friendsOfEveryLabel[t.LabelId].length}],on:{click:function(i){0!==e.friendsOfEveryLabel[t.LabelId].length&&e.showFriends(t.LabelId)}}},[n("input",{staticStyle:{"margin-left":"5px"},attrs:{type:"checkbox"},domProps:{checked:0!==e.friendsOfEveryLabel[t.LabelId].length&&e.friendsOfEveryLabel[t.LabelId].length===e.friendsCheckedByLabel[t.LabelId].length},on:{click:function(i){return e.choseFriendsByLabel(i,t.LabelId)}}}),n("p",{staticClass:"ellipsis"},[e._v(e._s(t.LabelName)+"("+e._s(e.friendsOfEveryLabel[t.LabelId].length)+")")])])}))]:[n("li",{staticClass:"label-item",class:{"current-label":"allFriends"===e.currentRoomLabel},on:{click:function(t){return e.showFriends("allFriends")}}},[n("input",{staticStyle:{"margin-left":"5px"},attrs:{type:"checkbox"},domProps:{checked:e.roomsChecked.length===e.chatRooms.length},on:{click:function(t){return e.choseRoomsByLabel(t,"allFriends")}}}),n("p",{domProps:{textContent:e._s("全部群组")}})])]],2)]),"friendsTab"===e.currentTab?n("div",{staticClass:"friends-list"},[n("div",{staticClass:"friends-list-title"},[n("p",[e._v("好友列表")]),n("div",[n("el-checkbox",{staticStyle:{"margin-right":"10px"},on:{change:e.changeFriends},model:{value:e.checkType,callback:function(t){e.checkType=t},expression:"checkType"}},[e._v("按号段选人")]),n("el-input-number",{staticStyle:{"margin-right":"10px"},attrs:{disabled:!e.checkType,size:"small",min:0,"controls-position":"right"},model:{value:e.startNum,callback:function(t){e.startNum=t},expression:"startNum"}}),n("el-input-number",{staticStyle:{"margin-right":"10px"},attrs:{disabled:!e.checkType,size:"small",min:0,"controls-position":"right"},model:{value:e.endNum,callback:function(t){e.endNum=t},expression:"endNum"}}),n("el-input",{staticClass:"search-input",attrs:{size:"small","suffix-icon":"el-icon-search",type:"text",placeholder:"输入昵称搜索"},model:{value:e.searchContent,callback:function(t){e.searchContent=t},expression:"searchContent"}})],1)]),e.forceRefresh?n("el-table",{staticClass:"scroll",attrs:{data:e.tableDataPage[e.currentPage-1],stripe:""}},[n("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"60px"}}),n("el-table-column",{attrs:{label:"昵称",prop:"FriendNick"}}),n("el-table-column",{staticStyle:{border:"solid red 1px"},attrs:{label:"头像",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("el-image",{staticStyle:{width:"30px",height:"30px"},attrs:{src:e.row.Avatar}},[n("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[n("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"30px"}})])])]}}],null,!1,1594755109)}),n("el-table-column",{attrs:{label:"备注名",prop:"Memo"}}),n("el-table-column",{attrs:{width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return["allFriends"===e.currentLabel?n("input",{staticStyle:{"margin-left":"5px"},attrs:{type:"checkbox"},domProps:{checked:e.friendsChecked.indexOf(t.row.FriendId)>=0},on:{click:function(i){return e.choseFriend(i,t.row)}}}):n("input",{staticStyle:{"margin-left":"5px"},attrs:{type:"checkbox"},domProps:{checked:e.friendsCheckedByLabel[e.currentLabel].indexOf(t.row.FriendId)>=0},on:{click:function(i){return e.choseFriend(i,t.row)}}})]}}],null,!1,722963418)},[n("template",{slot:"header"})],2)],1):e._e(),n("el-pagination",{staticStyle:{margin:"5px auto 0"},attrs:{"current-page":e.currentPage,"page-sizes":[50,100,150,200],"page-size":e.pageSize,"pager-count":7,layout:"total, sizes, prev, pager, next, jumper",total:e.tableData.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):n("ul",{staticClass:"chat-rooms-list scroll"},e._l(e.chatRooms,(function(t,i){return n("li",{key:i,staticClass:"room-item"},[n("el-avatar",{staticStyle:{"min-width":"34px","margin-right":"5px"},attrs:{size:34,shape:"square",src:t.Avatar}},[n("i",{staticClass:"fa fa-picture-o",attrs:{"aria-hidden":"true",title:"头像miss"}})]),n("p",{staticClass:"ellipsis",domProps:{textContent:e._s(t.NickName)}}),n("input",{attrs:{type:"checkbox"},domProps:{checked:e.roomsChecked.indexOf(t.UserName)>=0},on:{click:function(i){return e.choseRoom(i,t)}}})],1)})),0),n("div",{staticClass:"friends-chosed"},[n("div",{staticClass:"third-box-title"},[n("p",{staticStyle:{color:"#999999"},domProps:{textContent:e._s("friendsTab"===e.currentTab?"已选好友":"已选群组")}}),"friendsTab"===e.currentTab?n("p",[e._v(" 已选 "),n("span",{staticStyle:{color:"#ff0000"},domProps:{textContent:e._s(e.finalFriendsInfo.length)}}),e._v(" 人 ")]):n("p",[e._v(" 已选 "),n("span",{staticStyle:{color:"#ff0000"},domProps:{textContent:e._s(e.roomsChecked.length)}}),e._v(" 个 ")])]),n("div",{staticClass:"friends-chose-list scroll"},e._l("friendsTab"===e.currentTab?e.finalFriendsInfo:e.roomsCheckedInfo,(function(t,i){return n("el-tag",{key:i,staticStyle:{margin:"5px"},attrs:{closable:"",type:"info"},on:{close:function(i){"friendsTab"===e.currentTab?e.removeFriend(t):e.removeRoom(t)}}},[e._v(" "+e._s(t.FriendNick||t.NickName)+" ")])})),1),n("div",{staticClass:"friends-chosed-btns"},[n("el-button",{staticStyle:{"background-color":"#fff",color:"#999999"},attrs:{size:"mini"},on:{click:e.$parent.togglePage}},[e._v(" 返回 ")]),n("el-button",{staticStyle:{"background-color":"#ff9f00",color:"white"},attrs:{size:"mini"},on:{click:e.nextStep}},[e._v("下一步")])],1)]),n("el-dialog",{staticClass:"group-send-dialog",attrs:{title:"设置群发消息","append-to-body":"","close-on-click-modal":!1,visible:e.editDialg},on:{"update:visible":function(t){e.editDialg=t}}},[n("div",[n("div",{staticClass:"msg-list"},[0===e.msgList.length?n("div",{staticClass:"no-msg"},[n("img",{attrs:{src:i("c62c"),alt:""}}),n("p",{staticStyle:{"margin-top":"21px",color:"rgba(0, 0, 0, 0.25)"}},[e._v("您还未设置群发消息，请在下方设置")])]):e._e(),e._l(e.msgList,(function(t,s){return n("div",{key:s,staticClass:"msg-item"},[n("el-row",{attrs:{type:"flex",align:"middle"}},[n("div",{staticStyle:{"margin-right":"10px",color:"rgba(0, 0, 0, 0.45)"}},[e._v("["+e._s(e.contentTypeMap[t.ContentType])+"]")]),t.thumbUrl?n("el-image",{staticStyle:{width:"30px",height:"30px","margin-right":"10px","border-radius":"15px"},attrs:{src:t.thumbUrl}},[n("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[n("img",{attrs:{src:i("a82c"),alt:""}})])]):e._e(),n("p",{staticClass:"ellipsis",staticStyle:{width:"320px",color:"rgba(0, 0, 0, 0.65)"},domProps:{textContent:e._s(t.desc)}})],1),n("div",[n("el-button",{staticStyle:{color:"#a8a8a8"},attrs:{type:"text",icon:"el-icon-delete-solid"},on:{click:function(t){return e.deleteMsg(s)}}}),n("i",{staticClass:"fa fa-bars",staticStyle:{"margin-left":"10px",cursor:"pointer",color:"#a8a8a8"},attrs:{draggable:""},on:{dragover:function(t){return e.msgDragOver(t,s)},dragend:function(t){return e.msgDragEnd(t,s)}}})],1)],1)}))],2),n("div",{staticClass:"add-msg"},[n("el-tabs",{staticStyle:{height:"150px"},on:{"tab-click":e.setMsgType},model:{value:e.msgType,callback:function(t){e.msgType=t},expression:"msgType"}},[n("el-tab-pane",{attrs:{label:"文本",name:"Text"}},[n("el-input",{attrs:{type:"textarea",placeholder:"请输入内容",maxlength:"500","show-word-limit":"",resize:"none"},model:{value:e.textContent,callback:function(t){e.textContent=t},expression:"textContent"}})],1),n("el-tab-pane",{staticClass:"tab-pane-picture",attrs:{label:"图片",name:"Picture"}},[e.pictureUrl?e._e():n("label",{staticStyle:{cursor:"pointer",padding:"5px"},attrs:{for:"addPicture"}},[n("i",{staticClass:"el-icon-circle-plus",staticStyle:{color:"#bfbfbf"}}),n("span",{staticStyle:{color:"#bfbfbf","font-size":"14px","margin-left":"5px"}},[e._v("上传图片")])]),n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"pictureInputRef",attrs:{id:"addPicture",type:"file",accept:".jpg, .png, .jpeg"},on:{change:e.chosePicture}}),e.pictureUrl?n("img",{staticStyle:{"max-height":"82px","max-width":"100px"},attrs:{src:e.pictureUrl,alt:""}}):e._e(),e.pictureUrl?n("div",{staticClass:"pic-btn"},[n("p",{staticClass:"ellipsis",staticStyle:{"max-width":"400px"},domProps:{textContent:e._s(e.pictureName)}}),n("p",{staticStyle:{color:"#5a9cf8",cursor:"pointer"},on:{click:function(t){return e.resetContent("Picture")}}},[n("i",{staticClass:"el-icon-delete"}),e._v(" 删除 ")])]):e._e()]),n("el-tab-pane",{staticClass:"link-list",attrs:{label:"链接",name:"Link"}},e._l(e.linkList,(function(t,i){return n("div",{key:i,staticClass:"we-app-item",class:{"we-app-item-checked":e.linkContent.id===t.id},attrs:{title:t.content.Title},on:{click:function(i){e.linkContent=t}}},[t.content.Thumb&&t.content.Thumb.startsWith("http://www")?n("img",{staticClass:"we-app-img",attrs:{src:t.content.Thumb,alt:""}}):n("div",{staticClass:"we-app-img-no"},[n("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"20px"}})]),n("p",{staticClass:"we-app-name ellipsis",domProps:{textContent:e._s(t.content.Title)}})])})),0),n("el-tab-pane",{staticClass:"link-list",attrs:{label:"小程序",name:"WeApp"}},e._l(e.weAppList,(function(t,i){return n("div",{key:i,staticClass:"we-app-item",class:{"we-app-item-checked":e.appContent.id===t.id},on:{click:function(i){return e.setAppContent(t)}}},[n("img",{staticClass:"we-app-img",attrs:{src:t.content.Icon,alt:""}}),n("p",{staticClass:"we-app-name ellipsis",domProps:{textContent:e._s(t.content.Source)}})])})),0)],1),n("el-row",{staticStyle:{height:"42px",padding:"0 5px","border-top":"1px solid rgba(0, 0, 0, 0.08)"},attrs:{type:"flex",align:"middle",justify:"space-between"}},[n("div",{staticStyle:{"margin-left":"20px"}},["Text"===e.msgType?n("Expression",{on:{expressionContent:e.modifyContent}}):e._e()],1),n("div",[n("el-button",{attrs:{size:"small"},on:{click:function(t){return e.resetContent(e.msgType)}}},[e._v("重 置")]),n("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addMsgToList}},[e._v("添 加")])],1)])],1),n("el-input",{staticStyle:{"margin-top":"15px"},attrs:{clearable:"",size:"small",placeholder:"请输入备注",maxlength:"50","show-word-limit":""},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1),n("div",{staticClass:"preview-box"},[n("div",{staticClass:"preview-list"},e._l(e.msgList,(function(t,s){return n("div",{key:s,staticClass:"preview-item"},[n("img",{staticStyle:{height:"28px","margin-right":"5px"},attrs:{src:i("bf90"),alt:""}}),"Text"===t.ContentType?n("p",{staticClass:"preview-item-bg",staticStyle:{"line-height":"30px"}},[e._v(" "+e._s(t.Content)+" ")]):e._e(),"Picture"===t.ContentType?n("img",{staticStyle:{"max-width":"100px","max-height":"100px"},attrs:{src:t.Content,alt:""}}):e._e(),"Link"===t.ContentType?n("div",{staticClass:"preview-item-bg preview-item-link"},[n("p",{staticClass:"ellipsis",staticStyle:{width:"160px","font-weight":"600","font-size":"14px","line-height":"30px"},domProps:{textContent:e._s(t.jContent.Title)}}),n("el-row",{attrs:{type:"flex",align:"middle",justify:"space-between"}},[n("p",{staticClass:"ellipsis-3",staticStyle:{"font-size":"12px"},domProps:{textContent:e._s(t.jContent.Des)}}),n("el-image",{staticStyle:{width:"60px","min-width":"60px",height:"60px"},attrs:{src:t.jContent.Thumb}},[n("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[n("img",{attrs:{src:i("30bc"),alt:""}})])])],1)],1):e._e(),"WeApp"===t.ContentType?n("div",{staticClass:"preview-item-bg",staticStyle:{width:"170px"}},[n("p",{staticClass:"ellipsis",staticStyle:{width:"160px","font-weight":"600","font-size":"14px","line-height":"30px"},domProps:{textContent:e._s(t.jContent.Source)}}),n("el-image",{staticStyle:{width:"160px","min-width":"160px"},attrs:{src:t.jContent.Thumb}},[n("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[n("img",{staticStyle:{"margin-left":"16px"},attrs:{src:i("0d41"),alt:""}})])]),n("el-row",{staticStyle:{height:"30px"},attrs:{type:"flex",align:"middle"}},[n("img",{staticStyle:{widht:"18px",height:"18px","margin-right":"5px","border-radius":"50%"},attrs:{src:t.jContent.Icon,alt:""}}),n("p",{staticStyle:{"font-size":"10px",color:"#a8a8a8"}},[e._v("小程序")])])],1):e._e()])})),0)]),n("div",{staticClass:"group-send-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-radio-group",{model:{value:e.timeRadio,callback:function(t){e.timeRadio=t},expression:"timeRadio"}},[n("el-radio",{staticStyle:{"margin-right":"20px"},attrs:{size:"small",label:"rightNow"}},[e._v("立即发送")]),n("el-radio",{attrs:{size:"small",label:"timing"}},[e._v("定时发送")]),n("el-date-picker",{staticStyle:{width:"200px"},attrs:{size:"small",type:"datetime",placeholder:"选择日期时间",clearable:"",disabled:"rightNow"===e.timeRadio},model:{value:e.refTime,callback:function(t){e.refTime=t},expression:"refTime"}})],1),n("div",[n("span",{staticStyle:{color:"#606266"}},[e._v("群发间隔时间")]),n("el-input-number",{staticStyle:{width:"100px",margin:"0 5px"},attrs:{size:"small","controls-position":"right",min:0,max:30},model:{value:e.betweenTime,callback:function(t){e.betweenTime=t},expression:"betweenTime"}}),e._v(" 秒 ")],1),n("div",[n("el-button",{attrs:{size:"small"},on:{click:e.resetData}},[e._v("取 消")]),n("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.sureSend}},[e._v("发 送")])],1)],1)])],1)},r=[],o=(i("99af"),i("4de4"),i("4160"),i("c975"),i("d81d"),i("fb6a"),i("a434"),i("b0c0"),i("159b"),i("b85c")),c=i("5530"),l=i("2f62"),d=i("0e5c"),u=i("ca00"),h=i("3496"),f=i("a199"),p={name:"GroupAssistantSend",components:{Expression:f["a"]},data:function(){return{remarks:"",editDialg:!1,contentTypeMap:{Text:"文本",Picture:"图片",Link:"链接",WeApp:"小程序"},msgList:[],msgType:"Text",textContent:"",pictureUrl:"",pictureName:"",linkContent:"",appContent:"",linkList:[],weAppList:[],timeRadio:"rightNow",refTime:(new Date).getTime(),searchContent:"",currentTab:"friendsTab",currentLabel:"allFriends",tableData:[],friendsChecked:[],friendsCheckedByLabel:{},finalFriends:[],forceRefresh:!0,currentRoomLabel:"allFriends",roomsChecked:[],betweenTime:0,currentPage:1,pageSize:50,checkType:!1,startNum:0,endNum:0}},computed:Object(c["a"])(Object(c["a"])(Object(c["a"])({},Object(l["d"])("nedb",{labels:"labels",friends:"friends",chatRooms:"chatRooms"})),Object(l["b"])({currentUser:"currentUser",currentWeChatId:"conversation/currentWeChatId",currentFriend:"conversation/currentFriend",labelNameMap:"nedb/labelNameMap",labelIdMap:"nedb/labelIdMap"})),{},{friendsOfEveryLabel:function(){var e,t=this,i={},n=Object(o["a"])(this.labels);try{var s=function(){var n=e.value;i[n.LabelId]=t.friends.filter((function(e){return e.LabelIds&&e.LabelIds.indexOf(String(n.LabelId))>=0}))};for(n.s();!(e=n.n()).done;)s()}catch(a){n.e(a)}finally{n.f()}return i},finalFriendsInfo:function(){var e=this,t=[];return this.friends.forEach((function(i){e.finalFriends.indexOf(i.FriendId)>=0&&t.push(i)})),t},roomsCheckedInfo:function(){var e=this,t=[];return this.chatRooms.forEach((function(i){e.roomsChecked.indexOf(i.UserName)>=0&&t.push(i)})),t},tableDataPage:function(){for(var e=this.pageSize,t=[],i=0;i<this.tableData.length;i+=e)t.push(this.tableData.slice(i,i+e));return t}}),watch:{searchContent:function(e){var t=this;this.tableData=e?this.friends.filter((function(e){return e.FriendNick?e.FriendNick.indexOf(t.searchContent)>=0:e.Memo?e.Memo.indexOf(t.searchContent)>=0:e.NickName?e.NickName.indexOf(t.searchContent)>=0:e.Nickname?e.Nickname.indexOf(t.searchContent)>=0:void 0})):this.friends},currentWeChatId:function(){this.tableData=this.friends,this.currentLabel="allFriends",this.currentRoomLabel="allFriends"},labels:function(){this.initData()},startNum:function(e){this.friendsChecked=this.friends.slice(e,this.endNum).map((function(e){return e.FriendId}))},endNum:function(e){this.friendsChecked=this.friends.slice(this.startNum,e).map((function(e){return e.FriendId})),this.finalFriends=this.friendsChecked}},created:function(){this.initData()},methods:{handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.currentPage=e},initData:function(){var e=this;this.tableData=this.friends;var t,i=Object(o["a"])(this.labels);try{var n=function(){var i=t.value;e.friendsOfEveryLabel[i.LabelId]=e.friends.filter((function(e){return e.LabelIds&&e.LabelIds.indexOf(String(i.LabelId))>=0})),e.friendsCheckedByLabel[i.LabelId]=[]};for(i.s();!(t=i.n()).done;)n()}catch(s){i.e(s)}finally{i.f()}},indexMethod:function(e){return e+1},showFriends:function(e){this.tableData="allFriends"===e?this.friends:this.friends.filter((function(t){return t.LabelIds&&t.LabelIds.indexOf(String(e))>=0})),this.currentLabel=e},computedFriends:function(){var e=[].concat(this.friendsChecked);for(var t in this.friendsCheckedByLabel)Object.hasOwnProperty.call(this.friendsCheckedByLabel,t)&&(e=e.concat(this.friendsCheckedByLabel[t]));this.finalFriends=Object(u["c"])(e,"FriendId")},choseFriendsByLabel:function(e,t){var i=this;if("allFriends"===t){if(this.friendsChecked.length===this.friends.length)for(var n in this.friendsChecked=[],this.friendsCheckedByLabel)Object.hasOwnProperty.call(this.friendsCheckedByLabel,n)&&(this.friendsCheckedByLabel[n]=[]);else for(var s in this.friends.forEach((function(e){i.friendsChecked.indexOf(e.FriendId)<0&&i.friendsChecked.push(e.FriendId)})),this.friendsOfEveryLabel)if(Object.hasOwnProperty.call(this.friendsOfEveryLabel,s)){var a=this.friendsOfEveryLabel[s];this.friendsCheckedByLabel[s]=a.map((function(e){return e.FriendId}))}}else{if(0===this.friendsOfEveryLabel[t].length)return void e.preventDefault();var r=this.friendsOfEveryLabel[t],o=this.friendsCheckedByLabel[t];r.length===o.length?(this.friendsChecked=this.friendsChecked.filter((function(e){return o.indexOf(e)<0})),this.friendsCheckedByLabel[t]=[]):r.forEach((function(e){o.indexOf(e.FriendId)<0&&o.push(e.FriendId)}))}this.computedFriends()},choseFriend:function(e,t){var i=t.FriendId,n=this.currentLabel;if("allFriends"===this.currentLabel){var s=this.friendsChecked.indexOf(i);s>=0?this.friendsChecked.splice(s,1):this.friendsChecked.push(i)}else{var a=this.friendsCheckedByLabel[n].indexOf(i);a>=0?this.friendsCheckedByLabel[n].splice(a,1):this.friendsCheckedByLabel[n].push(i),this.$forceUpdate()}this.computedFriends()},choseRoomsByLabel:function(e,t){var i=this;"allFriends"===t&&(this.roomsChecked.length===this.chatRooms.length?this.roomsChecked=[]:this.chatRooms.forEach((function(e){i.roomsChecked.indexOf(e.UserName)<0&&i.roomsChecked.push(e.UserName)})))},choseRoom:function(e,t){var i=this.roomsChecked.indexOf(t.UserName);"allFriends"===this.currentRoomLabel&&(i>=0?this.roomsChecked.splice(i,1):this.roomsChecked.push(t.UserName))},removeFriend:function(e){var t=this,i=e.FriendId,n=this.friendsChecked.indexOf(i);for(var s in n>=0&&this.friendsChecked.splice(n,1),this.forceRefresh=!1,this.friendsCheckedByLabel)if(Object.hasOwnProperty.call(this.friendsCheckedByLabel,s)){var a=this.friendsCheckedByLabel[s],r=a.indexOf(i);r>=0&&a.splice(n,1)}setTimeout((function(){t.forceRefresh=!0}),50),this.$forceUpdate(),this.computedFriends()},removeRoom:function(e){this.roomsChecked.splice(this.roomsChecked.indexOf(e.UserName),1)},nextStep:function(){("friendsTab"!==this.currentTab||0!==this.finalFriends.length)&&("roomsTab"!==this.currentTab||0!==this.roomsChecked.length)?this.editDialg=!0:this.$alert("请选选择发送的对象！","提示",{type:"warning"})},setMsgType:function(e){var t=this,i=0;"Link"===e.name?i=6:"WeApp"===e.name&&(i=13),Object(h["s"])(this.currentUser.SupplierId,1,100,i).then((function(i){if(0===i.code&&i.data.rows){var n=i.data.rows.map((function(e){var t=Object(c["a"])({},e);try{t.content=JSON.parse(e.content)}catch(i){console.error(i)}return t}));"Link"===e.name?t.linkList=n:"WeApp"===e.name&&(t.weAppList=n)}else"Link"===e.name?t.linkList=[]:"WeApp"===e.name&&(t.weAppList=[])}))},resetContent:function(e){if("Text"===e)this.textContent="";else if("Picture"===e){this.pictureUrl="",this.pictureName="";var t=this.$refs.pictureInputRef;t.value=""}else"Link"===e?this.linkContent="":"WeApp"===e&&(this.appContent="")},setAppContent:function(e){this.appContent=e},addMsgToList:function(){var e={ContentType:this.msgType},t="";"Text"===this.msgType?this.textContent?(e.Content=this.textContent,e.desc=this.textContent):t="请填写文本！":"Picture"===this.msgType?this.pictureUrl?(e.Content=this.pictureUrl,e.thumbUrl=this.pictureUrl,e.desc=this.pictureName):t="请上传图片！":"Link"===this.msgType?this.linkContent?(e.Content=JSON.stringify(this.linkContent.content),e.jContent=this.linkContent.content,e.thumbUrl=this.linkContent.content.Thumb,e.desc=this.linkContent.content.Des||this.linkContent.content.Title):t="请选择链接！":"WeApp"===this.msgType&&(this.appContent?(e.Content=JSON.stringify(this.appContent.content),e.jContent=this.appContent.content,e.thumbUrl=this.appContent.content.Icon,e.desc=this.appContent.content.Source||this.appContent.content.Title||this.appContent.content.Des):t="请选择小程序！"),t?this.$message({type:"warning",message:t,duration:1e3}):(this.msgList.push(e),this.resetContent(this.msgType))},deleteMsg:function(e){this.msgList.splice(e,1)},msgDragOver:function(e,t){this.msgTarget=t,e.preventDefault()},msgDragEnd:function(e,t){var i=[this.msgList[this.msgTarget],this.msgList[t]];this.msgList[t]=i[0],this.msgList[this.msgTarget]=i[1],this.$forceUpdate(),e.preventDefault()},modifyContent:function(e){this.textContent=this.textContent+e},resetData:function(){this.editDialg=!1},chosePicture:function(){var e=this,t=this.$refs.pictureInputRef.files;if(t[0]){var i=t[0],n=i.type.indexOf("image")>=0,s=i.size>0&&i.size/1024/1024<20;if(!n)return void this.$alert("图片格式不对！","提示",{type:"warning"});if(!s)return void this.$alert("上传图片大小不能超过 20MB!","提示",{type:"warning"});var a=new FormData;a.append("myfile",i);var r=this.$loading({lock:!0,text:"文件上传中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(d["a"])(a).then((function(t){e.pictureName=i.name,e.pictureUrl=t.data.url,r.close()})).catch((function(t){e.$alert("".concat(t),"文件上传失败",{type:"error"}),r.close()}))}},deletePicture:function(){this.pictureName="",this.pictureUrl=""},transformTime:function(e){var t=new Date(e),i=t.getFullYear()+"-",n=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",s=(t.getDate()<10?"0"+t.getDate():t.getDate())+" ",a=(t.getHours()<10?"0"+t.getHours():t.getHours())+":",r=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),o=i+n+s+a+r;return o},sureSend:function(){var e=this,t="friendsTab"===this.currentTab?this.finalFriends:this.roomsChecked,i="timing"===this.timeRadio?this.refTime:(new Date).getTime();if(t.length>5e3)this.$alert("群发不能超过5000人！","提示",{type:"warning"});else if(0!==t.length)if(0!==this.msgList.length){var n={accountid:this.$store.getters.currentUser.UnionId,tasktype:"friendsTab"===this.currentTab?1:5,state:1,wechatId:this.currentWeChatId,wechatList:t,execute_time:this.transformTime(i),content:JSON.stringify(this.msgList),between_time:this.betweenTime,remarks:this.remarks};Object(h["d"])(n).then((function(t){0===t.code?(e.$message({type:"success",message:"创建定时任务成功！",duration:1e3}),e.resetData()):e.$message({type:"error",message:"创建定时任务失败！",duration:1e3})})).catch((function(t){e.$message.error(t.message)})),this.$parent.togglePage()}else this.$message.warning("请设置群发内容！");else this.$alert("请选择发送的对象！","提示",{type:"warning"})},changeFriends:function(e){e&&this.startNum<this.endNum?(this.friendsChecked=this.friends.slice(this.startNum,this.endNum).map((function(e){return e.FriendId})),this.finalFriends=this.friendsChecked):(this.finalFriends=[],this.friendsChecked=[])}}},m=p,g=(i("bfbf"),i("2877")),C=Object(g["a"])(m,a,r,!1,null,"4d237bec",null),b=C.exports,v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"group-send-log"},[n("el-table",{staticClass:"group-send-log-table",attrs:{data:e.groupSendLog,stripe:"",height:"100%"}},[n("el-table-column",{attrs:{label:"任务类型",prop:"tasktype",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{domProps:{textContent:e._s(e.tasktypeMap[t.row.tasktype])}})]}}])}),n("el-table-column",{attrs:{label:"微信昵称"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{domProps:{textContent:e._s(e.wechatsNameMap[t.row.wechatId]||t.row.wechatId)}})]}}])}),n("el-table-column",{attrs:{label:"当前状态",prop:"state",formatter:e.taskStateFormatter}}),n("el-table-column",{attrs:{label:"备注",prop:"remarks"}}),n("el-table-column",{attrs:{label:"执行时间",prop:"execute_time"}}),n("el-table-column",{attrs:{label:"完成时间",prop:"update_time"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.update_time?n("span",{domProps:{textContent:e._s(e.$options.filters.transformTime2Minute(t.row.update_time))}}):n("span",{domProps:{textContent:e._s("待执行")}})]}}])}),n("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[1===i.state?n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.modifyState(i,-1)}}},[e._v("暂停")]):e._e(),-1===i.state?n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.modifyState(i,1)}}},[e._v("继续")]):e._e(),1===i.state||-1===i.state?n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.modifyState(i,2)}}},[e._v(" 取消 ")]):e._e(),n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.getAutoTaskDetail(i)}}},[e._v("详情")]),n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.deleteTask(i)}}},[e._v("删除")])]}}])})],1),n("el-pagination",{staticStyle:{margin:"5px"},attrs:{"current-page":e.currentPage,"page-sizes":[20,40,60,80],"page-size":e.pageSize,"pager-count":7,layout:"total, sizes, prev, pager, next, jumper",total:e.totalNum},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),n("el-button",{staticStyle:{position:"absolute",bottom:"5px",right:"20px"},attrs:{size:"small"},on:{click:e.queryLogData}},[e._v(" 刷新日志 ")]),n("el-dialog",{staticClass:"task-detail-dialog",attrs:{"append-to-body":"",title:"任务详情",visible:e.taskDetailVisiable},on:{"update:visible":function(t){e.taskDetailVisiable=t}}},[n("div",{staticClass:"preview-box"},[n("div",{staticClass:"preview-list"},e._l(e.rowDetail,(function(t,s){return n("div",{key:s,staticClass:"preview-item"},[n("img",{staticStyle:{height:"28px","margin-right":"5px"},attrs:{src:i("bf90"),alt:""}}),"Text"===t.ContentType?n("p",{staticClass:"preview-item-bg",staticStyle:{"line-height":"30px"}},[e._v(" "+e._s(t.Content)+" ")]):e._e(),"Picture"===t.ContentType?n("img",{staticStyle:{"max-width":"100px","max-height":"100px"},attrs:{src:t.Content,alt:""}}):e._e(),"Link"===t.ContentType?n("div",{staticClass:"preview-item-bg preview-item-link"},[n("p",{staticClass:"ellipsis",staticStyle:{width:"160px","font-weight":"600","font-size":"14px","line-height":"30px"},domProps:{textContent:e._s(t.jContent.Title)}}),n("el-row",{attrs:{type:"flex",align:"middle",justify:"space-between"}},[n("p",{staticClass:"ellipsis-3",staticStyle:{"font-size":"12px"},domProps:{textContent:e._s(t.jContent.Des)}}),n("el-image",{staticStyle:{width:"60px","min-width":"60px",height:"60px"},attrs:{src:t.jContent.Thumb}},[n("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[n("img",{attrs:{src:i("30bc"),alt:""}})])])],1)],1):e._e(),"WeApp"===t.ContentType?n("div",{staticClass:"preview-item-bg",staticStyle:{width:"170px"}},[n("p",{staticClass:"ellipsis",staticStyle:{width:"160px","font-weight":"600","font-size":"14px","line-height":"30px"},domProps:{textContent:e._s(t.jContent.Source)}}),n("el-image",{staticStyle:{width:"160px","min-width":"160px"},attrs:{src:t.jContent.Thumb}},[n("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[n("img",{staticStyle:{"margin-left":"16px"},attrs:{src:i("0d41"),alt:""}})])]),n("el-row",{staticStyle:{height:"30px"},attrs:{type:"flex",align:"middle"}},[n("img",{staticStyle:{widht:"18px",height:"18px","margin-right":"5px","border-radius":"50%"},attrs:{src:t.jContent.Icon,alt:""}}),n("p",{staticStyle:{"font-size":"10px",color:"#a8a8a8"}},[e._v("小程序")])])],1):e._e()])})),0)]),n("ul",{staticClass:"detail-ls"},[n("li",[n("p",{staticStyle:{width:"120px"},domProps:{textContent:e._s("任务总数")}}),n("p",{domProps:{textContent:e._s(e.taskDetail.task_allSize)}})]),n("li",[n("p",{staticStyle:{width:"120px"},domProps:{textContent:e._s("执行中的任务数")}}),n("p",{domProps:{textContent:e._s(e.taskDetail.task_startSize)}})]),n("li",[n("p",{staticStyle:{width:"120px"},domProps:{textContent:e._s("暂停的任务数")}}),n("p",{domProps:{textContent:e._s(e.taskDetail.task_stopSize)}})]),n("li",[n("p",{staticStyle:{width:"120px"},domProps:{textContent:e._s("取消的任务数")}}),n("p",{domProps:{textContent:e._s(e.taskDetail.task_cancelSize)}})]),n("li",[n("p",{staticStyle:{width:"120px"},domProps:{textContent:e._s("失败的任务数")}}),n("p",{domProps:{textContent:e._s(e.taskDetail.task_failSize)}})]),n("li",[n("p",{staticStyle:{width:"120px"},domProps:{textContent:e._s("结束的任务数")}}),n("p",{domProps:{textContent:e._s(e.taskDetail.task_endSize)}})]),n("li",[n("p",{staticStyle:{width:"120px"},domProps:{textContent:e._s("成功的任务数")}}),n("p",{domProps:{textContent:e._s(e.taskDetail.task_successSize)}})])]),n("span",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"medium"},on:{click:function(t){e.taskDetailVisiable=!1}}},[e._v("确 定")])],1)])],1)},A=[],D=(i("a9e3"),{name:"GroupAssistantLog",props:{currentTab:{type:[Number,String],default:1}},data:function(){return{groupSendLog:[],tasktypeMap:{1:"PC群发消息",2:"PC发朋友圈",3:"删除好友",4:"删除群聊",5:"群发群消息",6:"按标签群发",7:"发朋友圈",8:"批量加好友"},pageSize:20,currentPage:1,totalNum:0,taskDetail:{},rowDetail:[],taskDetailVisiable:!1}},computed:Object(c["a"])({},Object(l["b"])({currentUser:"currentUser",wechatsNameMap:"conversation/wechatsNameMap",currentWeChatId:"conversation/currentWeChatId"})),watch:{currentWeChatId:function(e){e?this.queryLogData():this.groupSendLog=[]},currentTab:function(){this.queryLogData()}},created:function(){this.currentWeChatId&&this.queryLogData()},methods:{queryLogData:function(){var e=this;Object(h["r"])(this.currentUser.SupplierId,this.currentUser.UnionId,this.currentPage,this.pageSize,this.currentTab,"").then((function(t){0===t.code&&(e.groupSendLog=t.data.list||[],e.totalNum=t.data.total||0)}))},getAutoTaskDetail:function(e){var t=this;this.rowDetail=JSON.parse(e.content),this.taskDetail={},Object(h["q"])(e.id).then((function(e){0===e.code&&e.data&&(t.taskDetail=e.data,t.taskDetailVisiable=!0)}))},deleteTask:function(e){var t=this;this.$confirm("确认删除该任务 ?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(h["t"])(e.id).then((function(i){0===i.code&&(t.groupSendLog=t.groupSendLog.filter((function(t){return t.id!==e.id})))}))})).catch((function(){}))},modifyState:function(e,t){var i=this;Object(h["v"])(e.id,t).then((function(n){if(0===n.code){var s,a=Object(o["a"])(i.groupSendLog);try{for(a.s();!(s=a.n()).done;){var r=s.value;if(r.id===e.id){r.state=t;break}}}catch(c){a.e(c)}finally{a.f()}}}))},taskStateFormatter:function(e){var t={"-1":"暂停",0:"已完成",1:"开启中",2:"取消"};return t[e.state]},handleSizeChange:function(e){this.pageSize!==e&&(this.pageSize=e,this.queryLogData())},handleCurrentChange:function(e){this.currentPage=e,this.queryLogData()}}}),y=D,k=(i("8d0d"),Object(g["a"])(y,v,A,!1,null,"5e33d296",null)),x=k.exports,I={components:{GroupAssistantLog:x,GroupAssistantSend:b},data:function(){return{showAddPage:!1,currentTab:1}},methods:{togglePage:function(){this.$store.getters["conversation/currentWeChatId"]?this.showAddPage=!this.showAddPage:this.$alert("请先选中一个微信！","提示",{type:"warning"})}}},w=I,T=(i("8504"),Object(g["a"])(w,n,s,!1,null,"38778e70",null));t["default"]=T.exports},"5e89":function(e,t,i){var n=i("861d"),s=Math.floor;e.exports=function(e){return!n(e)&&isFinite(e)&&s(e)===e}},6498:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAEqADAAQAAAABAAAAEgAAAAC5YZBvAAACIUlEQVQ4EW2TwXHiQBBFJaMDnFYZLI7AyoDxgSo4eR2BRQRmM1hHsGRgOQLgBBSHHUVgOQOcgX2jCij8/nhGJbbUVaPu+d399ac1iqMWG41GBvghjuMMryWrzudzhX9Zr9dWQNPi5mY4HGadTucvBCbgNL8pBrtpYPZ0Ov3ebrcidlYTiSRJkn+gKatkzVar1cJV+cd4PP5FOGUNWB/H4/E2kDmiJgkKJkgvKLwwjttHRapG4hyFzxTUZImqUTLDpW0kxpi02+3OdVzqIkh2EN4zgonINAp6b6/8YCW1bFPS6/X+iER5XvRC3Kd57mtL5cQhRTlLJlVtprlEzMvI05TSfKdxsFWPRORXPASocCHfYj8DpmNC4vaHw2EXesBuEj3CJ1aDn4nO3d/v9/fkHA9K+tS+stEsl9baDyXUC55JUUTwXU3MTBbsc9a1ivHKR5Cq8Y3GJ+Kc+MKSwChUb8UNhFFsiGvzCkwN+ICXuBNJUSXMXzafjnZq1DEFiDgkmr7RU4moUJLiRz7pjvCdt9xRNOf+aCY6mpVvsanHCnezabIAOtKEy1ZxTwpJVhHYUjPxRxPkjDFojs9sSl0Nd7MpzgEqJXRjUZZpXhrw/wRiCST0fbLNhTlFCvyfbyH7QYFlzTabzVK5YJoJ+CM1RiSoNxc/bSj0P++M/SBgePcx8FkDK/nzp4FEeK2oUSTphn3Oynh7mJW+nEgLjm7xF/YFaMUmrxWNIewAAAAASUVORK5CYII="},"678c":function(e,t,i){"use strict";var n=i("0511"),s=i.n(n);s.a},"67c6":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"friends-list"},[i("div",{staticClass:"search-box"},[i("el-input",{attrs:{"prefix-icon":"el-icon-search",type:"text",placeholder:"搜索",maxlength:"20",size:"small","show-word-limit":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchChange(t)}},model:{value:e.searchInfo,callback:function(t){e.searchInfo=t},expression:"searchInfo"}})],1),i("div",{staticClass:"friends-content scroll",attrs:{id:"friends-list"},on:{scroll:e.handlerScroll}},[e._l(e.searchInfo?e.searchResult:e.resetFriends,(function(t,n){return i("div",{key:n,staticClass:"friend-info",class:{selected:e.currentFriendId===t.FriendId},on:{click:function(i){return e.$parent.choseFriend(t)}}},[i("div",{staticClass:"avatar-tip"},[i("el-avatar",{key:t.Avatar,attrs:{shape:"square",size:40,src:t.Avatar}},[i("i",{staticClass:"fa fa-picture-o",attrs:{"aria-hidden":"true",title:"头像miss"}})])],1),i("div",{staticClass:"nick-content"},[i("div",{staticClass:"friend-nick",domProps:{textContent:e._s(t.Memo||t.FriendNick)}})]),i("div",{staticClass:"opration-btns"},[i("i",{staticClass:"fa fa-retweet sigle-fresh",attrs:{"aria-hidden":"true"},on:{click:function(i){return i.stopPropagation(),e.$parent.getFriendDetail(t)}}}),i("i",{staticClass:"el-icon-delete",on:{click:function(i){return i.stopPropagation(),e.deleteFriend(t)}}})])])})),e.currentWeChatId&&e.maxNumber>e.friendsList.length?i("div",{staticClass:"current-info-null"},[e._v("数据已经到底了！")]):e._e()],2)])},s=[],a=(i("4de4"),i("c975"),i("fb6a"),i("5530")),r=i("2f62"),o={data:function(){return{maxNumber:20,searchInfo:"",searchResult:[],chatToDel:{}}},computed:Object(a["a"])(Object(a["a"])(Object(a["a"])({},Object(r["d"])("nedb",{friendsList:"friends"})),Object(r["b"])({currentFriendId:"conversation/currentFriendId",currentWeChatId:"conversation/currentWeChatId"})),{},{resetFriends:function(){return this.friendsList.slice(0,this.maxNumber)}}),watch:{searchInfo:function(e){this.debounceInput()},currentWeChatId:function(){this.maxNumber=20}},created:function(){this.debounceInput=this._.debounce(this.debounceInput,500)},methods:{handlerScroll:function(){var e=document.getElementById("friends-list").scrollTop,t=document.getElementById("friends-list").clientHeight,i=document.getElementById("friends-list").scrollHeight;e+t+2>=i&&this.maxNumber<=this.resetFriends.length&&(this.maxNumber=this.maxNumber+5)},debounceInput:function(){var e=this;if(this.searchInfo){var t=this.friendsList.filter((function(t){return t.FriendNick&&t.FriendNick.indexOf(e.searchInfo)>=0||t.Memo&&t.Memo.indexOf(e.searchInfo)>=0?t:void 0}));this.searchResult=t}else this.searchResult=[]},deleteFriend:function(e){var t=this;this.$confirm("此操作将删除该好友, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$store.dispatch("websocket/DeleteFriendTask",e),t.$message({type:"info",message:"正在删除!"})})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}}},c=o,l=(i("7fba"),i("2877")),d=Object(l["a"])(c,n,s,!1,null,"c307d974",null);t["default"]=d.exports},"75a9":function(e,t,i){},"7ca9":function(e,t,i){"use strict";var n=i("423f"),s=i.n(n);s.a},"7e4f":function(e,t,i){e.exports=i.p+"static/img/lianjie.svg"},"7fba":function(e,t,i){"use strict";var n=i("8229"),s=i.n(n);s.a},8059:function(e,t,i){e.exports=i.p+"static/img/emoji.png"},8229:function(e,t,i){},"832d":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"friend-circle"},[i("MyCircle"),i("SendCircle")],1)},s=[],a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"my-circles"},[n("div",{staticClass:"my-circles-title"},[n("p",[e._v("我的朋友圈")]),n("el-checkbox",{staticStyle:{margin:"0 10px"},model:{value:e.onlyMe,callback:function(t){e.onlyMe=t},expression:"onlyMe"}},[e._v("仅看我的")]),n("el-button",{attrs:{icon:"el-icon-refresh",type:"text",size:"mini"},on:{click:e.refreshCircles}},[e._v("刷新")])],1),e.currentWeChatId&&0===e.circleList.length&&!e.retTips?n("div",{staticClass:"loading-circle"},[n("i",{staticClass:"el-icon-loading"}),n("span",{staticStyle:{"margin-left":"10px"}},[e._v("正在获取朋友圈")])]):e._e(),0===e.circleList.length?n("div",{staticClass:"no-circles"},[n("img",{staticStyle:{"margin-bottom":"30px"},attrs:{src:i("baeb"),alt:""}})]):n("ul",{staticClass:"circles-list scroll"},[e._l(e.circleList,(function(t,s){return n("li",{key:s,staticClass:"circle-item all-circle-item"},[n("el-avatar",{staticStyle:{"margin-right":"10px"},attrs:{size:30,src:e.friendsMap[t.WeChatId]?e.friendsMap[t.WeChatId].Avatar:""}},[n("i",{staticClass:"fa fa-picture-o",attrs:{"aria-hidden":"true",title:"头像miss"}})]),n("div",[n("p",{staticStyle:{color:"#409eff",height:"30px","line-height":"30px"},domProps:{textContent:e._s(e.friendsMap[t.WeChatId]?e.friendsMap[t.WeChatId].FriendNick:t.WeChatId)}}),t.Content.Text?n("div",{staticClass:"circle-text",domProps:{textContent:e._s(t.Content.Text)}}):e._e(),t.Content.Link?n("div",{staticClass:"circle-link",attrs:{title:"点击打开链接"},on:{click:function(i){return e.openLink(t)}}},[t.Content.Images?n("img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:t.Content.Images[0].ThumbImg,alt:"这是link"}}):n("span",{staticClass:"circle-link-description",domProps:{textContent:e._s("无效链接")}}),n("span",{staticClass:"circle-link-description",domProps:{textContent:e._s(t.Content.Link.Description)}})]):t.Content.Images?n("div",{staticClass:"circle-img"},e._l(t.Content.Images,(function(i,s){return n("div",{key:s},[n("img",{staticClass:"friend-circle-img",attrs:{src:i.ThumbImg,alt:i.ThumbImg?"图片地址错误":"点击刷新获取缩略图"},on:{click:function(n){return e.pullCircleDetailTask(i,t)}}}),i.Description?n("p",{domProps:{textContent:e._s(i.Description)}}):e._e()])})),0):t.Content.Video?n("div",{staticClass:"circle-video"},[t.Content.Video.Url&&t.Content.Video.Url.startsWith("http")?n("video",{staticClass:"video",attrs:{controls:""}},[n("source",{attrs:{src:t.Content.Video.Url,type:"video/mp4"}})]):n("div",{staticStyle:{position:"relative"}},[t.Content&&t.Content.Video?n("img",{staticClass:"video-thumb",attrs:{src:t.Content.Video.ThumbImg}}):e._e(),n("i",{staticClass:"el-icon-caret-right",attrs:{title:"点击获取视频地址"},on:{click:function(i){return e.pullVideoUrl(t)}}})])]):e._e(),n("div",{staticClass:"time-operation"},[n("span",{staticStyle:{"font-size":"12px",color:"#b2b2b2"},domProps:{textContent:e._s(e.$options.filters.timeFilter(t.PublishTime))}}),n("div",{staticClass:"operation-btns"},[n("el-button",{attrs:{type:"text ",size:"small",circle:"",icon:"el-icon-delete",title:"删除"},on:{click:function(i){return e.deleteSNSNewsTask(t)}}}),n("el-button",{attrs:{type:"text",size:"small",circle:"",icon:"el-icon-star-off",title:"点赞"},on:{click:function(i){return e.likeCircle(t)}}}),n("el-button",{attrs:{type:"text",size:"small",circle:"",icon:"el-icon-edit",title:"评论"},on:{click:function(i){return e.circleCommentReplyTask(t)}}}),n("el-button",{attrs:{type:"text",size:"small",circle:"",icon:"el-icon-refresh",title:"刷新"},on:{click:function(i){return e.triggerCirclePushTask(t)}}})],1)]),t.Likes?n("div",{staticClass:"likes-box"},[n("i",{staticClass:"fa fa-heart-o",attrs:{"aria-hidden":"true"}}),n("div",e._l(t.Likes,(function(t,i){return n("p",{key:i,staticStyle:{padding:"5px"}},[e._v(" "+e._s(t.NickName)+" ")])})),0)]):e._e(),t.Comments?n("div",{staticClass:"comment-box"},e._l(t.Comments,(function(s,a){return n("div",{key:a,staticClass:"every-comment"},[n("img",{attrs:{src:e.friendsMap[s.FromWeChatId]?e.friendsMap[s.FromWeChatId].Avatar:i("f067")}}),n("div",{staticClass:"comment-info"},[n("div",{staticClass:"name-time"},[n("span",{staticClass:"ellipsis",domProps:{textContent:e._s(s.FromName)}}),n("span",{domProps:{textContent:e._s(e.$options.filters.timeFilter(s.PublishTime))}})]),n("div",{staticClass:"reply-1"},[n("div",{staticClass:"reply-to-friend",attrs:{title:s.Content}},[s.ToWeChatId?n("span",[e._v(" 回复 "),n("span",{staticClass:"reply-friend-name",domProps:{textContent:e._s(e.friendsMap[s.ToWeChatId]?e.friendsMap[s.ToWeChatId].FriendNick:s.ToWeChatId)}}),e._v(" : ")]):e._e(),n("p",{staticClass:"ellipsis comment-content",domProps:{textContent:e._s(s.Content)}})]),s.FromWeChatId===t.WeChatId?n("i",{staticClass:"fa fa-trash",attrs:{"aria-hidden":"true",title:"删除"},on:{click:function(i){return e.circleCommentDeleteTask(t,s)}}}):n("i",{staticClass:"fa fa-reply",attrs:{"aria-hidden":"true",title:"回复"},on:{click:function(i){return e.circleCommentReplyTask(t,s)}}}),s.FromWeChatId!==t.WeChatId?n("i",{staticClass:"fa fa-comments-o",attrs:{"aria-hidden":"true",title:"发起聊天"},on:{click:function(i){return e.beginChat(t,s)}}}):e._e()])])])})),0):e._e()])],1)})),e.retTips?n("li",{staticClass:"ret-tips",domProps:{textContent:e._s(e.retTips)}}):e.circleList.length>=10?n("el-button",{staticStyle:{margin:"5px 50px"},attrs:{disabled:e.pullCircleFlag,type:"primary",size:"small",loading:e.pullCircleFlag},on:{click:e.queryCircleListNext}},[e._v(" 点击加载更多数据 ")]):e._e()],2),n("div",{staticClass:"demo-image__preview big-img-box",attrs:{id:"bigImage"}},[n("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{id:"bigImageBox",src:e.bigImageUrl,"preview-src-list":[e.bigImageUrl]}})],1)])},r=[],o=(i("ac1f"),i("5319"),i("2ca0"),i("b85c")),c=i("5530"),l=i("2f62"),d=i("2c32"),u={name:"MyCircle",data:function(){return{onlyMe:!0,pullCircleFlag:!1,bigImageUrl:"https://cube.elemecdn.com/9/c2/f0ee8a3c7c9638a54940382568c9dpng.png"}},computed:Object(c["a"])({},Object(l["b"])({circleList:"conversation/circleList",retTips:"conversation/retTips",bigImageMap:"conversation/bigImageMap",friendsMap:"nedb/friendsMap",currentWeChatId:"conversation/currentWeChatId"})),watch:{currentWeChatId:function(){this.clearCircles(),this.queryCircleList()}},mounted:function(){this.queryCircleList()},beforeDestroy:function(){this.clearCircles()},methods:{queryCircleList:function(){this.currentWeChatId&&Object(d["q"])(this.currentWeChatId,this.onlyMe?this.currentWeChatId:"",0)},refreshCircles:function(){this.clearCircles(),this.queryCircleList()},clearCircles:function(){this.$store.commit("conversation/SET_RETTIPS",""),this.$store.commit("conversation/RESET_CIRCLE_LIST")},messageTip:function(e,t){this.$message({type:t||"info",message:e||"任务已发出，请等候执行！",duration:1e3})},likeCircle:function(e){this.messageTip();var t=!1;if(e.Likes){var i,n=Object(o["a"])(e.Likes);try{for(n.s();!(i=n.n()).done;){var s=i.value;if(s.FriendId===this.currentWeChatId){t=!0;break}}}catch(r){n.e(r)}finally{n.f()}}var a=e.CircleId;Object(d["d"])(this.currentWeChatId,a,t,"")},triggerCirclePushTask:function(e){this.messageTip(),Object(d["B"])(this.currentWeChatId,[e.CircleId])},circleCommentReplyTask:function(e,t){var i=this;this.$prompt("请输入评论内容","评论",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S{1,500}/,inputErrorMessage:"评论字数1-500"}).then((function(n){var s=n.value;i.messageTip();var a="",r="";t&&(a=t.FromWeChatId,r=t.CommentId),Object(d["c"])(i.currentWeChatId,e.CircleId,s,a,r)})).catch((function(){}))},circleCommentDeleteTask:function(e,t){var i=this;t.CommentId&&this.$confirm("确认删除该评论 ?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.messageTip(),Object(d["b"])(i.currentWeChatId,e.CircleId,t.CommentId)})).catch((function(){}))},deleteSNSNewsTask:function(e){var t=this;this.$confirm("确认删除该朋友圈 ?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.messageTip(),Object(d["f"])(t.currentWeChatId,e.CircleId)})).catch((function(){}))},queryCircleListNext:function(){var e=this;if(this.currentWeChatId){var t=0,i=this.circleList.length-1;if(!(i<=0)){this.messageTip("正在获取更多数据,请稍等!","warning"),this.circleList[i]&&(t=this.circleList[i].CircleId),0!==t&&Object(d["q"])(this.currentWeChatId,this.onlyMe?this.currentWeChatId:"",t),this.pullCircleFlag=!0;var n=setTimeout((function(){e.pullCircleFlag=!1,clearTimeout(n),n=null}),2e3)}}else this.$alert("请先选中一个微信！","提示",{type:"warning"})},openLink:function(e){var t=e.Content.Link.Url;if(t.startsWith("https://mp.weixin.qq.com/mp"))this.$alert("先程序链接，请在手机上打开！","提示",{type:"info"});else{var i=document.createElement("a");i.setAttribute("href",t),i.setAttribute("target","_blank"),i.setAttribute("id","js_a"),document.getElementById("js_a")&&document.body.removeChild(document.getElementById("js_a")),document.body.appendChild(i),i.click()}},pullVideoUrl:function(e){var t,i=e.WeChatId,n=e.CircleId,s=e.Content,a=null===s||void 0===s||null===(t=s.Video)||void 0===t?void 0:t.mediaId;a&&(this.bigImageMap[a]?this.$alert("已经获取到了url,请刷新朋友圈！","提示",{type:"info"}):(this.messageTip("正在获取图片详情，请稍后再试!"),i&&n&&Object(d["n"])(i,n,!0)))},pullCircleDetailTask:function(e,t){if(e.Url)this.$alert("视频号请在手机上查看！","提示");else if(this.bigImageMap[e.mediaId]){this.bigImageUrl=this.bigImageMap[e.mediaId];var i=document.getElementById("bigImageBox");setTimeout((function(){i&&i.click()}),100)}else this.messageTip("正在获取图片详情，请稍后再试!"),Object(d["n"])(this.currentWeChatId,t.CircleId,!0)},beginChat:function(e,t){var i=t.FromWeChatId,n={FriendId:i,WeChatId:e.WeChatId};this.friendsMap[i]&&(n=this.friendsMap[i]),this.$store.commit("conversation/SET_CURRENT_FRIENDS",n),this.$router.replace({name:"conversation"})}}},h=u,f=(i("2e72"),i("2877")),p=Object(f["a"])(h,a,r,!1,null,"62650070",null),m=p.exports,g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"friend-circle-send"},[e._m(0),n("ul",{staticClass:"set-circle-type"},[n("li",{staticClass:"circle-type-item",class:{"circle-type-item-select":"text"===e.circleType},on:{click:function(t){e.circleType="text"}}},["text"===e.circleType?n("img",{attrs:{src:i("c6e7"),alt:""}}):n("img",{attrs:{src:i("0ad7"),alt:""}}),e._v(" 文本 ")]),n("li",{staticClass:"circle-type-item",class:{"circle-type-item-select":"picture"===e.circleType},on:{click:function(t){e.circleType="picture"}}},["picture"===e.circleType?n("img",{attrs:{src:i("261c"),alt:""}}):n("img",{attrs:{src:i("06f7"),alt:""}}),e._v(" 图片 ")]),n("li",{staticClass:"circle-type-item",class:{"circle-type-item-select":"video"===e.circleType},on:{click:function(t){e.circleType="video"}}},["video"===e.circleType?n("img",{attrs:{src:i("96e8"),alt:""}}):n("img",{attrs:{src:i("eaed"),alt:""}}),e._v(" 视频 ")]),n("li",{staticClass:"circle-type-item",class:{"circle-type-item-select":"link"===e.circleType},on:{click:function(t){return e.toggleCircleType("link")}}},["link"===e.circleType?n("img",{attrs:{src:i("c844"),alt:""}}):n("img",{attrs:{src:i("7e4f"),alt:""}}),e._v(" 链接 ")]),n("li",{staticClass:"circle-type-item",class:{"circle-type-item-select":"weapp"===e.circleType},on:{click:function(t){return e.toggleCircleType("weapp")}}},["weapp"===e.circleType?n("img",{attrs:{src:i("c844"),alt:""}}):n("img",{attrs:{src:i("7e4f"),alt:""}}),e._v(" 小程序 ")]),n("li",{staticClass:"circle-type-item",class:{"circle-type-item-select":"shipinhao"===e.circleType},on:{click:function(t){return e.toggleCircleType("shipinhao")}}},["shipinhao"===e.circleType?n("img",{attrs:{src:i("c844"),alt:""}}):n("img",{attrs:{src:i("7e4f"),alt:""}}),e._v(" 视频号 ")])]),n("div",{staticClass:"set-send-content scroll"},[n("el-input",{staticStyle:{height:"auto",width:"100%"},attrs:{type:"textarea",placeholder:"这一刻的想法...",maxlength:"500","show-word-limit":"",autosize:{minRows:6,maxRows:6},resize:"none"},model:{value:e.textContent,callback:function(t){e.textContent=t},expression:"textContent"}}),n("Expression",{staticClass:"qq-expression",on:{expressionContent:e.modifyContent}}),"picture"===e.circleType?n("div",{staticClass:"add-pictures"},[0===e.imagesList.length?n("img",{staticStyle:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},attrs:{src:i("efb7"),alt:""}}):e._e(),n("el-upload",{staticClass:"set-image-ulrs",class:{hide:e.hideUpload},attrs:{action:e.actionUrl,"list-type":"picture-card",accept:".jpg, .png, .jpeg",multiple:!0,limit:9,"file-list":e.imagesList,data:e.upData,"show-file-list":e.showFileList,"on-change":e.handleImageChange,"before-upload":e.beforeImageUpload,"on-success":e.handleImageSuccess,"on-error":e.handleImageError,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleImageRemove,"on-exceed":e.handleImageExceed}},[n("i",{staticClass:"el-icon-plus"})])],1):"video"===e.circleType?n("div",{staticClass:"add-video"},[e.videoUrl?[n("video",{attrs:{src:e.videoUrl,controls:""}}),n("div",{staticClass:"video-name-delete"},[n("p",{staticStyle:{"margin-right":"5px"},domProps:{textContent:e._s(e.videoName)}}),n("i",{staticClass:"el-icon-delete",on:{click:e.deleteVideo}})])]:[n("img",{attrs:{src:i("0e06"),alt:""}}),e._m(1),n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"videoInputRef",attrs:{id:"addVideo",type:"file",accept:".mp4"},on:{change:e.choseVideo}})]],2):"link"===e.circleType||"weapp"===e.circleType?n("div",{staticClass:"resource-box scroll"},e._l(e.resourcesDataList,(function(t,i){return n("div",{key:i,staticClass:"we-app-item",class:{"we-app-item-checked":e.rd2Send.Url===t.Url},attrs:{title:t.Title},on:{click:function(i){e.rd2Send=t}}},[n("img",{staticClass:"we-app-img",attrs:{src:t.Thumb,alt:""}}),n("p",{staticClass:"we-app-name ellipsis",domProps:{textContent:e._s(t.Title)}})])})),0):"shipinhao"===e.circleType?n("div",{staticClass:"resource-box scroll"},e._l(e.resourcesDataList,(function(t,i){return n("div",{key:i,staticClass:"we-app-item",class:{"we-app-item-checked":e.rd2Send.url===t.url},attrs:{title:t.des},on:{click:function(i){e.rd2Send=t}}},[n("img",{staticClass:"we-app-img",attrs:{src:t.cover,alt:""}}),n("el-row",{attrs:{type:"flex",align:"middle"}},[n("img",{staticStyle:{width:"20px",height:"20px","border-radius":"10px"},attrs:{src:t.avatar,alt:""}}),n("p",{staticClass:"we-app-name ellipsis",domProps:{textContent:e._s(t.nickname)}})])],1)})),0):e._e(),n("div",{staticClass:"set-circle-comment"},[e.addComment&&e.showComentArea?n("el-input",{staticClass:"add-commnet-area",attrs:{type:"textarea",placeholder:"如果有需要，请输入评论，多个评论用###分隔",maxlength:"300","show-word-limit":"",autosize:{minRows:6,maxRows:6},resize:"none"},model:{value:e.comment,callback:function(t){e.comment=t},expression:"comment"}}):e._e(),n("el-checkbox",{staticStyle:{"margin-right":"0"},on:{change:e.addCommentChange},model:{value:e.addComment,callback:function(t){e.addComment=t},expression:"addComment"}},[e._v("添加评论")]),n("p",{directives:[{name:"show",rawName:"v-show",value:e.addComment,expression:"addComment"}],staticStyle:{color:"#ff9f00",width:"50px"},domProps:{textContent:e._s(e.showComentArea?"收起":"展开")},on:{click:function(t){e.showComentArea=!e.showComentArea}}}),n("el-cascader",{staticStyle:{"margin-left":"20px","min-width":"200px"},attrs:{size:"small",options:e.cascaderData,props:e.props,"collapse-tags":"",placeholder:"请选择要发送的微信",clearable:""},model:{value:e.wechats2send,callback:function(t){e.wechats2send=t},expression:"wechats2send"}}),"rightNow"!==e.sendRadio?n("el-input",{staticStyle:{"margin-left":"10px",width:"300px"},attrs:{clearable:"",size:"small",placeholder:"请输入备注，非必须",maxlength:"50","show-word-limit":""},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}}):e._e()],1)],1),n("div",{staticClass:"send-circle-opration"},[n("el-radio-group",{model:{value:e.sendRadio,callback:function(t){e.sendRadio=t},expression:"sendRadio"}},[n("el-radio",{staticStyle:{width:"60px"},attrs:{label:"rightNow"}},[e._v("立即开始")]),n("el-radio",{staticStyle:{width:"60px"},attrs:{label:"timing"}},[e._v("定时任务")]),n("el-date-picker",{staticStyle:{width:"190px"},attrs:{type:"datetime",placeholder:"选择日期时间","prefix-icon":"el-icon-date",clearable:"",size:"small",disabled:"rightNow"===e.sendRadio},model:{value:e.refTime,callback:function(t){e.refTime=t},expression:"refTime"}})],1),n("div",{staticStyle:{"margin-left":"10px"}},[n("span",{staticClass:"tip"},[e._v("间隔(分)")]),n("el-input-number",{staticStyle:{margin:"0 5px",width:"90px"},attrs:{size:"small","controls-position":"right",disabled:"rightNow"===e.sendRadio,min:0,max:30},model:{value:e.breakTime,callback:function(t){e.breakTime=t},expression:"breakTime"}}),n("el-checkbox",{staticStyle:{"margin-left":"10px"},attrs:{disabled:"rightNow"===e.sendRadio},model:{value:e.replaceFlag,callback:function(t){e.replaceFlag=t},expression:"replaceFlag"}},[e._v(" 随机表情 ")])],1),n("el-button",{staticStyle:{"background-color":"#ff9f00",color:"#ffffff",border:"none","margin-left":"10px"},attrs:{size:"small",loading:e.sending,disabled:e.sending},on:{click:e.postSNSNewsTask}},[e._v(" 发送 ")])],1),n("el-dialog",{staticClass:"dialog-visible",attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},["picture"===e.circleType?n("img",{staticClass:"circle-send-dialog",attrs:{width:"100%",src:e.imageUrl,alt:""}}):e._e()])],1)},C=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"friend-circle-send-title"},[i("p",[e._v("发朋友圈")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("label",{staticClass:"add-video-label",attrs:{for:"addVideo"}},[i("i",{staticClass:"el-icon-plus"}),i("span",{staticStyle:{color:"#576c95","font-size":"14px"}},[e._v("添加视频")])])}],b=(i("99af"),i("4160"),i("c975"),i("a15b"),i("a434"),i("b0c0"),i("a9e3"),i("1276"),i("159b"),i("0e5c")),v=i("a199"),A=i("3496"),D=i("932e"),y={name:"SendFriendCircle",components:{Expression:v["a"]},data:function(){return{remarks:"",rd2Send:{},visibleType:0,breakTime:0,circleType:"text",addComment:!1,wechats2send:[],replaceFlag:!1,showComentArea:!1,textContent:"",comment:"",imageUrls:[],hideUpload:!1,showFileList:!0,upData:{myfile:"",packageName:"pc"},imagesList:[],imageUrl:"",dialogVisible:!1,videoUploading:!1,videoUrl:"",videoName:"",circleTypeTip:{picture:"只能上传jpg/png文件，且不超过20MB",video:"只能上传mp4文件，且不超过10秒",link:""},sendRadio:"rightNow",refTime:(new Date).getTime(),friendIdChose:[],sending:!1,circleContent:"",resourcesDataList:[],props:{multiple:!0},cascaderData:[]}},computed:Object(c["a"])({},Object(l["b"])({actionUrl:"actionUrl",currentUser:"currentUser",wechats:"conversation/wechats"})),mounted:function(){var e=this,t=[];this.wechats.forEach((function(e){e.groupid||t.push({value:e.WeChatId,label:e.WeChatNick})}));var i=[{value:"-1",label:"未分组",children:t}];Object(D["c"])(this.currentUser.SupplierId).then((function(t){if(t.data){var n,s=Object(o["a"])(t.data);try{for(s.s();!(n=s.n()).done;){var a=n.value;i.push({value:a.id,label:a.name,children:[]})}}catch(r){s.e(r)}finally{s.f()}e.wechats.forEach((function(t){var n,s=Object(o["a"])(i);try{for(s.s();!(n=s.n()).done;){var a=n.value;a.value===Number(t.groupid)&&a.children.push({value:t.WeChatId,label:t.WeChatNick})}}catch(r){s.e(r)}finally{s.f()}e.cascaderData=i}))}}))},methods:{addCommentChange:function(e){this.showComentArea=!!e},setFriendIdChose:function(e){this.friendIdChose=e},transformTime:function(e){var t=new Date(e),i=t.getFullYear()+"-",n=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",s=(t.getDate()<10?"0"+t.getDate():t.getDate())+" ",a=(t.getHours()<10?"0"+t.getHours():t.getHours())+":",r=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),o=i+n+s+a+r;return o},postSNSNewsTask:function(){var e=this;if("text"===this.circleType){if(!this.textContent)return void this.$message.warning("请设置文本内容!")}else if("picture"===this.circleType){if(0===this.imageUrls.length)return void this.$message.warning("请设置图片!")}else if("video"===this.circleType){if(!this.videoUrl)return void this.$message.warning("请设置视频!")}else if("{}"===JSON.stringify(this.rd2Send))return void this.$message.warning("请选择一个素材!");var t={Type:this.visibleType,Labels:"",Friends:""},i=null;switch(this.circleType){case"picture":i={Type:2,Content:this.imageUrls};break;case"video":i={Type:3,Content:[this.videoUrl]};break;case"link":i={Type:0,Content:[this.rd2Send.Url,this.rd2Send.Title,this.rd2Send.Thumb]};break;case"weapp":i={Type:6,Content:[JSON.stringify(this.rd2Send)]};break;case"shipinhao":i={Type:5,Content:[JSON.stringify(this.rd2Send)]};break;default:break}0!==this.wechats2send.length?this.$confirm("即将发送朋友圈, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){if("rightNow"===e.sendRadio){var n=e.addComment&&e.comment?e.comment:"",s=[];n&&(s=n.split("###"));var a,r=Object(o["a"])(e.wechats2send);try{for(r.s();!(a=r.n()).done;){var c=a.value;Object(d["l"])(c[1],e.textContent,i,"",0===s.length?null:s,t,"")}}catch(f){r.e(f)}finally{r.f()}}else{var l={accountid:e.currentUser.UnionId,tasktype:2,state:1,execute_time:e.transformTime(e.refTime),content:e.textContent,comment:e.addComment&&e.comment?e.comment:"",restype:i&&i.Type?i.Type:1,remarks:e.remarks};null!==i&&(l.attachtype=i.Type,l.attachtcontent=i.Content.join(",")),"3"===e.visibleType&&(l.whoinvisible=t.Friends);for(var u=function(t){var i=JSON.parse(JSON.stringify(l));i.wechatId=e.wechats2send[t][1],i.replace=e.replaceFlag?"true":"false",i.execute_time=e.transformTime(new Date(e.refTime).getTime()+60*e.breakTime*1e3*t),setTimeout((function(){Object(A["d"])(i).then((function(t){0===t.code?e.$message({type:"success",message:"创建定时任务成功！",duration:1e3}):e.$message({type:"error",message:"创建定时任务失败！",duration:1e3})})).catch((function(t){e.$alert(t,"提示",{type:"error"})}))}),500*t)},h=0;h<e.wechats2send.length;h++)u(h)}e.$message.success("任务已经下发！"),e.sending=!0,setTimeout((function(){e.sending=!1}),3e3)})).catch((function(){})):this.$message.warning("请选择微信!")},handleImageExceed:function(e,t){this.$message.warning("当前限制选择 9 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},handleImageChange:function(e,t){9===t.length&&(this.showFileList=!0,this.hideUpload=!0)},beforeImageUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type,i=e.size/1024/1024<20;return t||this.$message.warning("上传图片只能是 JPG|PNG 格式!"),i||this.$message.warning("上传图片大小不能超过 20MB!"),this.upData.myfile=e,t&&i},handleImageSuccess:function(e,t,i){var n,s=Object(o["a"])(i);try{for(s.s();!(n=s.n()).done;){var a=n.value;a.response&&(a.url=a.response.data.url)}}catch(r){s.e(r)}finally{s.f()}this.imagesList=i,this.imageUrls.push(e.data.url)},handleImageError:function(e){this.$alert(e,"文件上传失败",{type:"error"}),this.hideUpload=!1},handleImageRemove:function(e,t){var i=this.imageUrls.indexOf(e.response.data.url);this.imageUrls.splice(i,1),this.hideUpload=!1,this.imagesList=t},choseVideo:function(){var e=this,t=this.$refs.videoInputRef.files;if(t[0]){var i=t[0],n="video/mp4"===i.type,s=i.size>0&&i.size/1024/1024<20;if(!n)return void this.$alert("上传视频只能是 MP4 格式!","提示",{type:"warning"});if(!s)return void this.$alert("上传视频大小不能超过 20MB!","提示",{type:"warning"});var a=new FormData;a.append("myfile",i);var r=this.$loading({lock:!0,text:"文件上传中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Object(b["a"])(a).then((function(t){e.videoName=i.name,e.videoUrl=t.data.url,r.close()})).catch((function(t){e.$alert("".concat(t),"文件上传失败",{type:"error"}),r.close()}))}},deleteVideo:function(){this.videoUrl="",this.videoName=""},handlePictureCardPreview:function(e){"picture"===this.circleType?this.imageUrl=e.url:this.videoUrl=e.url,this.dialogVisible=!0},modifyContent:function(e){this.textContent=this.textContent+e},toggleCircleType:function(e){var t=this;this.circleType=e;var i=0;"link"===e?i=6:"weapp"===e?i=13:"shipinhao"===e&&(i=24),this.rd2Send={},i&&Object(A["s"])(this.currentUser.SupplierId,1,100,i,this.circleContent).then((function(e){if(0===e.code&&e.data.rows){var i=[];e.data.rows.forEach((function(e){i.push(JSON.parse(e.content))})),t.resourcesDataList=i}else t.resourcesDataList=[]}))}}},k=y,x=(i("9e8f"),Object(f["a"])(k,g,C,!1,null,"64212a65",null)),I=x.exports,w={components:{MyCircle:m,SendCircle:I},data:function(){return{}}},T=w,F=(i("0b16"),Object(f["a"])(T,n,s,!1,null,"be3835f8",null));t["default"]=F.exports},8504:function(e,t,i){"use strict";var n=i("1e59"),s=i.n(n);s.a},"87c8":function(e,t,i){},"8ba4":function(e,t,i){var n=i("23e7"),s=i("5e89");n({target:"Number",stat:!0},{isInteger:s})},"8d0d":function(e,t,i){"use strict";var n=i("a11d"),s=i.n(n);s.a},"8d36":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"chat-rooms-manager scroll"},[i("div",{staticClass:"room-info-item"},[i("div",{staticClass:"room-info-item-title"},[i("span",{staticClass:"tip"},[e._v("群聊名称")]),i("div",{staticClass:"btns"},[i("el-button",{staticStyle:{padding:"3px"},attrs:{plain:"",icon:"el-icon-edit-outline",circle:""},on:{click:e.changeRoomName}})],1)]),i("div",{staticClass:"room-info-item-content"},[e._v(e._s(e.currentFriend.NickName||""))])]),i("div",{staticClass:"room-info-item"},[i("div",{staticClass:"room-info-item-title"},[i("span",{staticClass:"tip"},[e._v("群公告")]),i("div",{staticClass:"btns"},[e.currentFriend.WeChatId===e.currentFriend.Owner?i("el-button",{attrs:{plain:"",icon:"el-icon-edit-outline",circle:""},on:{click:e.changeNotice}}):e._e()],1)]),i("div",{staticClass:"room-info-item-content"},[e._v(e._s(e.currentFriend.Notice||""))])]),i("div",{staticClass:"room-info-item"},[i("div",{staticClass:"room-info-item-title"},[i("span",{staticClass:"tip"},[e._v("群内昵称")]),i("div",{staticClass:"btns"},[i("el-button",{attrs:{plain:"",icon:"el-icon-edit-outline",circle:""},on:{click:e.changeMyRoomName}})],1)]),i("div",{staticClass:"room-info-item-content"},[e._v(e._s(e.currentFriend.SelfDisplayName||""))])]),i("div",{staticClass:"room-info-item"},[i("div",{staticClass:"room-info-item-title"},[i("span",{staticClass:"tip"},[e._v("群主")]),i("div",{staticClass:"btns"},[e.currentFriend.WeChatId===e.currentFriend.Owner?i("el-button",{attrs:{plain:"",icon:"el-icon-s-promotion",circle:""},on:{click:e.transferOwner}}):e._e()],1)]),i("div",{staticClass:"room-info-item-content owner"},[i("el-avatar",{staticClass:"avatar",attrs:{shape:"square",size:32,src:e.friendsMap[e.currentFriend.Owner]?e.friendsMap[e.currentFriend.Owner].Avatar:e.strangersMap[e.currentFriend.Owner]?e.strangersMap[e.currentFriend.Owner].Avatar:"",title:e.currentFriend.Owner},nativeOn:{click:function(t){return e.showMemberDetail(e.currentFriend.Owner)}}},[i("i",{staticClass:"fa fa-picture-o",attrs:{"aria-hidden":"true",title:"头像miss"}})]),i("div",{staticClass:"owner-name"},[e.friendsMap[e.currentFriend.Owner]?i("span",{domProps:{textContent:e._s(e.friendsMap[e.currentFriend.Owner].FriendNick)}}):e.strangersMap[e.currentFriend.Owner]?i("span",{domProps:{textContent:e._s(e.strangersMap[e.currentFriend.Owner].Nickname)}}):i("span",{domProps:{textContent:e._s(e.currentFriend.Owner)}})])],1)]),i("div",{staticClass:"room-info-item"},[i("div",{staticClass:"room-info-item-title"},[i("span",{staticClass:"tip"},[e._v(" 群成员 "),e.currentFriend.MemberList?i("span",{domProps:{textContent:e._s(e.currentFriend.MemberList.length+"个人")}}):e._e()]),i("div",{staticClass:"btns"},[i("el-button",{attrs:{plain:"",icon:"el-icon-plus",circle:""},on:{click:e.addMember}}),i("el-button",{attrs:{type:"danger",plain:"",icon:"el-icon-minus",circle:""},on:{click:e.kickMember}}),i("el-button",{attrs:{plain:"",icon:"el-icon-view",circle:""},on:{click:e.viewAllMember}})],1)]),i("div",{staticClass:"room-info-item-content avatars"},e._l(e.currentFriend.MemberList,(function(t,n){return i("el-avatar",{directives:[{name:"show",rawName:"v-show",value:n<e.maxNumber,expression:"index < maxNumber"}],key:n,staticClass:"avatar",class:{"not-friend":!e.friendsMap[t]},attrs:{shape:"square",size:32,src:e.friendsMap[t]&&e.friendsMap[t].Avatar?e.friendsMap[t].Avatar:e.strangersMap[t]&&e.strangersMap[t].Avatar?e.strangersMap[t].Avatar:"",title:e.friendsMap[t]&&e.friendsMap[t].FriendNick?e.friendsMap[t].FriendNick:e.strangersMap[t]&&e.strangersMap[t].Nickname?e.strangersMap[t].Nickname:t},nativeOn:{click:function(i){return e.showMemberDetail(t)}}},[i("i",{staticClass:"fa fa-picture-o",attrs:{"aria-hidden":"true",title:"头像miss"}})])})),1),i("div",{staticClass:"friend-item-footer"},[e.currentFriend.MemberList&&e.currentFriend.MemberList.length>32?i("el-button",{staticClass:"footer-btn",staticStyle:{"background-color":"#ff9f00",color:"#ffffff",border:"none"},attrs:{size:"small"},on:{click:e.showAllMember}},[e._v(" 查看全部群成员 ")]):e._e()],1)]),i("el-button",{staticStyle:{margin:"15px auto",width:"150px"},attrs:{type:"danger",size:"small"},on:{click:e.deleteAndLogout}},[e._v(" 删除并退出 ")]),e.friendsDialogVisible?i("SlotFriends",{attrs:{dialogTilte:e.dialogTilte,action:e.action,currentFriend:e.currentFriend,friends:e.dialogData,friendsDialogVisible:e.friendsDialogVisible},on:{closeSlotFriends:function(t){e.friendsDialogVisible=!1}}}):e._e(),i("el-dialog",{staticClass:"member-detail-dialog",attrs:{"append-to-body":"","close-on-click-modal":!1,title:"群成员详情",visible:e.memberDialog},on:{"update:visible":function(t){e.memberDialog=t}}},[i("div",{staticClass:"member-detail-info"},[i("el-avatar",{attrs:{shape:"square",size:100,src:e.memberDetail.Avatar}},[i("img",{attrs:{src:"https://cube.elemecdn.com/e/fd/0fc7d20532fdaf769a25683617711png.png"}})]),i("div",{staticClass:"member-detail-text"},[i("p",[e._v(" 微信： "),i("span",{domProps:{textContent:e._s(e.memberDetail.FriendId)}})]),i("p",[e._v(" 昵称： "),i("span",{domProps:{textContent:e._s(e.memberDetail.FriendNick||"- -")}})]),i("p",[e._v(" 性别： "),i("span",{domProps:{textContent:e._s(e.memberDetail.Gender||"- -")}})]),i("p",[e._v(" 地址： "),i("span",{domProps:{textContent:e._s(e.memberDetail.Province||"-")}}),e._v(" "),i("span",{domProps:{textContent:e._s(e.memberDetail.City||"-")}})])])],1),i("div",{staticClass:"member-detail-btns"},[e.friendsMap[e.memberDetail.FriendId]?e._e():i("el-button",{staticStyle:{"background-color":"#ff9f00",color:"#ffffff",border:"none"},attrs:{size:"medium"},on:{click:e.getMemberDetail}},[e._v(" 获取详情 ")]),e.friendsMap[e.memberDetail.FriendId]?e._e():i("el-button",{staticStyle:{"background-color":"#ff9f00",color:"#ffffff",border:"none"},attrs:{size:"medium"},on:{click:e.addToAddress}},[e._v(" 添加到通讯录 ")])],1)])],1)},s=[],a=(i("4de4"),i("c975"),i("498a"),i("b85c")),r=i("5530"),o=i("2f62"),c=i("2c32"),l=i("3d6b"),d={name:"ChatRoomManager",components:{SlotFriends:l["a"]},data:function(){return{maxNumber:30,memberDialog:!1,memberDetail:{},action:0,dialogTilte:"添加群成员",dialogData:[],friendsDialogVisible:!1,doNotTouch:0,saveToAddress:0,setInvitationConfirm:0}},computed:Object(r["a"])(Object(r["a"])({},Object(o["d"])("nedb",{friends:"friends"})),Object(o["b"])({currentFriend:"conversation/currentFriend",friendsMap:"nedb/friendsMap",strangersMap:"nedb/strangersMap"})),created:function(){this.viewAllMember=this._.throttle(this.viewAllMember,5e3)},methods:{changeRoomName:function(){var e=this;this.currentFriend.UserName?this.$prompt("修改群聊名称","修改群聊名称",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S{1,50}/,inputValue:this.currentFriend.NickName,inputPlaceholder:this.currentFriend.NickName,inputErrorMessage:"备注长度1-50，不能含有特殊字符！"}).then((function(t){var i=t.value;if(i.trim()!==e.currentFriend.NickName){var n={WeChatId:e.currentFriend.WeChatId,ChatRoomId:e.currentFriend.UserName,Action:0,Content:i};e.$store.dispatch("websocket/ChatRoomActionTask",n)}else e.$message.warning("群内名称没有改变")})).catch((function(){})):this.$message.warning("请先选择一个群！")},changeMyRoomName:function(){var e=this;this.currentFriend.UserName?this.$prompt("修改我的群昵称","修改我的群昵称",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S{1,50}/,inputValue:this.currentFriend.SelfDisplayName,inputPlaceholder:this.currentFriend.SelfDisplayName,inputErrorMessage:"备注长度1-50，不能含有特殊字符！"}).then((function(t){var i=t.value;if(i.trim()!==e.currentFriend.SelfDisplayName){var n={WeChatId:e.currentFriend.WeChatId,ChatRoomId:e.currentFriend.UserName,Action:4,Content:i};e.$store.dispatch("websocket/ChatRoomActionTask",n)}else e.$message.warning("群内昵称没有改变")})).catch((function(){})):this.$message.warning("请先选择一个群！")},changeNotice:function(){var e=this;this.currentFriend.UserName?this.$prompt("修改群公告","修改群公告",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S{1,500}/,inputErrorMessage:"备注长度1-500，不能含有特殊字符！"}).then((function(t){var i=t.value,n={WeChatId:e.currentFriend.WeChatId,ChatRoomId:e.currentFriend.UserName,Action:1,Content:i};e.$store.dispatch("websocket/ChatRoomActionTask",n)})).catch((function(){})):this.$message.warning("请先选择一个群！")},deleteAndLogout:function(){var e=this;this.currentFriend.UserName?this.$confirm("删除并退出群?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={WeChatId:e.currentFriend.WeChatId,ChatRoomId:e.currentFriend.UserName,Action:7};e.$store.dispatch("websocket/ChatRoomActionTask",t),e.$message.success("指令已经下发！")})).catch((function(){e.$message.info("已取消删除")})):this.$message.warning("请先选择一个群！")},addMember:function(){var e=this;this.dialogTilte="拉人进群",this.action=2,this.friendsDialogVisible=!0,this.dialogData=this.friends.filter((function(t){return e.currentFriend.MemberList.indexOf(t.FriendId)<0}))},kickMember:function(){if(this.currentFriend.WeChatId===this.currentFriend.Owner){var e,t=[],i=Object(a["a"])(this.currentFriend.MemberList);try{for(i.s();!(e=i.n()).done;){var n=e.value;if(n!==this.currentFriend.Owner){var s="";this.friendsMap[n]&&this.friendsMap[n].Avatar?s=this.friendsMap[n].Avatar:this.strangersMap[n]&&this.strangersMap[n].Avatar&&(s=this.strangersMap[n].Avatar);var r="";this.friendsMap[n]&&this.friendsMap[n].FriendNick?r=this.friendsMap[n].FriendNick:this.strangersMap[n]&&this.strangersMap[n].Nickname&&(r=this.strangersMap[n].Nickname);var o={WeChatId:this.currentFriend.WeChatId,FriendId:n,Avatar:s,FriendNick:r,LabelIds:this.friendsMap[n]&&this.friendsMap[n].LabelIds?this.friendsMap[n].LabelIds:""};t.push(o)}}}catch(c){i.e(c)}finally{i.f()}this.dialogData=t,this.dialogTilte="踢人出群",this.action=3,this.friendsDialogVisible=!0}else this.$message.warning("你不是群主！")},transferOwner:function(){if(this.currentFriend.WeChatId===this.currentFriend.Owner){var e,t=[],i=Object(a["a"])(this.currentFriend.MemberList);try{for(i.s();!(e=i.n()).done;){var n=e.value,s="";this.friendsMap[n]&&this.friendsMap[n].Avatar?s=this.friendsMap[n].Avatar:this.strangersMap[n]&&this.strangersMap[n].Avatar&&(s=this.strangersMap[n].Avatar);var r="";this.friendsMap[n]&&this.friendsMap[n].FriendNick?r=this.friendsMap[n].FriendNick:this.strangersMap[n]&&this.strangersMap[n].Nickname&&(r=this.strangersMap[n].Nickname);var o={WeChatId:this.currentFriend.WeChatId,FriendId:n,Avatar:s,FriendNick:r,LabelIds:this.friendsMap[n]&&this.friendsMap[n].LabelIds?this.friendsMap[n].LabelIds:""};t.push(o)}}catch(c){i.e(c)}finally{i.f()}this.dialogData=t,this.dialogTilte="群主转让",this.action=10,this.friendsDialogVisible=!0}else this.$message.warning("你不是群主！")},showAllMember:function(){30===this.maxNumber?this.maxNumber=500:this.maxNumber=30},viewAllMember:function(){var e={WeChatId:this.currentFriend.WeChatId,ChatRoomId:this.currentFriend.UserName,Action:9};this.$store.dispatch("websocket/ChatRoomActionTask",e),this.$message.info("指令已经下发！")},showMemberDetail:function(e){this.friendsMap[e]?this.memberDetail=this.friendsMap[e]:this.strangersMap[e]?this.memberDetail={WeChatId:this.currentFriend.WeChatId,FriendId:e,Avatar:this.strangersMap[e].Avatar?this.strangersMap[e].Avatar:"",FriendNick:this.strangersMap[e].Nickname?this.strangersMap[e].Nickname:"",LabelIds:""}:this.memberDetail={WeChatId:this.currentFriend.WeChatId,FriendId:e,Avatar:"",FriendNick:"",LabelIds:""},this.memberDialog=!0},addToAddress:function(){var e={WeChatId:this.memberDetail.WeChatId,ChatroomId:this.currentFriend.UserName,FriendId:this.memberDetail.FriendId,Message:"",Remark:""};this.$store.dispatch("websocket/AddFriendInChatRoomTask",e),this.memberDialog=!1,this.$message.info("指令已经下发！")},getMemberDetail:function(){Object(c["t"])(this.memberDetail.WeChatId,this.memberDetail.FriendId),this.memberDialog=!1,this.$message.info("指令已经下发！")}}},u=d,h=(i("1644"),i("2877")),f=Object(h["a"])(u,n,s,!1,null,"5bf61e74",null);t["default"]=f.exports},"8f2e":function(e,t,i){},"8fc2":function(e,t,i){"use strict";var n=i("75a9"),s=i.n(n);s.a},"8fd4":function(e,t,i){"use strict";var n=i("abac"),s=i.n(n);s.a},"932e":function(e,t,i){"use strict";i.d(t,"d",(function(){return s})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return r})),i.d(t,"e",(function(){return o})),i.d(t,"b",(function(){return c}));var n=i("1c1e");function s(e,t,i,s){return n["a"].post("/user/devicegroup/pageList",{cid:e,name:t,page:i,rows:s})}function a(e){return n["a"].post("/user/devicegroup/queryByCid",{cid:e})}function r(e,t){return n["a"].post("/user/devicegroup/add",{cid:e,name:t})}function o(e,t,i){return n["a"].post("/user/devicegroup/update",{id:e,cid:t,name:i})}function c(e){return n["a"].post("/user/devicegroup/deletes",{ids:e})}},"96c9":function(e,t,i){},"96e8":function(e,t,i){e.exports=i.p+"static/img/shipin-active.svg"},"9d09":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAPCAYAAADUFP50AAAAAXNSR0IArs4c6QAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAADqADAAQAAAABAAAADwAAAACjWDJwAAAA7klEQVQoFZWTjQ2CMBSEi3EANoANdAMZgQ10BEZgBJlARnAD2UA2kBHYoH5XqKlQE7zk+l7fu+sfIbHW9saYA/wHjcEopFtdaEvYeWO/xYzmCMfQeGEyqPFrZ3rSyFTBLmGwCSDIdIeviFlXSWABpav3DA54e5J8mv0e2cA1d0sJDR3ppjoxhU+YL3UrIzu3iHR0mR+woTYQv/A5qq9iuJJnsIAjPFMz84JMZ1C0Pg8j5RoWYU25anD6jmGTYguXqLyGRtwYCGqJ/NxHb1w9jhcQOzjAKNzjsMop0tXdM3p6qBDuh9Cz6/xl2NmQt28PNMYWUtmBmAAAAABJRU5ErkJggg=="},"9e8f":function(e,t,i){"use strict";var n=i("594f"),s=i.n(n);s.a},a11d:function(e,t,i){},a199:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"expression-page"},[n("el-popover",{attrs:{placement:"bottom-start",width:"400",trigger:"hover"}},[n("div",{staticClass:"scroll",staticStyle:{height:"210px","overflow-y":"scroll"}},[n("img",{staticClass:"qq-face",attrs:{src:i("e56e"),usemap:"#qqMap"}}),n("map",{attrs:{name:"qqMap"}},e._l(105,(function(t,i){return n("area",{key:i,attrs:{shape:"rect",coords:i%15*25+", "+25*parseInt(i/15)+", "+25*(i%15+1)+", "+25*(parseInt(i/15)+1),title:e.qqFaceMap[i]||i},on:{click:function(t){return e.selectExpression(i)}}})})),0),n("img",{attrs:{src:i("8059"),usemap:"#emojiMap"}}),n("map",{attrs:{name:"emojiMap"}},e._l(177,(function(t,i){return n("area",{key:i,attrs:{shape:"rect",coords:i%15*25+", "+25*parseInt(i/15)+", "+25*(i%15+1)+", "+25*(parseInt(i/15)+1),title:e.qqFaceMap[105+i]},on:{click:function(t){return e.selectExpression(105+i)}}})})),0)]),n("div",{staticClass:"expression-icon",attrs:{slot:"reference",title:"表情"},slot:"reference"},[n("i",{staticClass:"fa fa-smile-o",attrs:{"aria-hidden":"true"}})])])],1)},s=[],a=(i("c975"),i("f6d6"),i("decf")),r={name:"ErrorLog",computed:{qqFaceMap:function(){return a["b"]||{}}},methods:{selectExpression:function(e){"Text"!==this.contentType&&this.$store.commit("conversation/SET_CONTENT","");var t=a["b"][e],i=[113,114,115,116,117,118,124,125];if(t){if(e<105||i.indexOf(e)>=0)t="["+a["b"][e]+"]";else{t="<"+t+">",t=a["a"][t];var n=parseInt(t,16);t=String.fromCodePoint(n)}this.$emit("expressionContent",t)}}}},o=r,c=(i("d27f"),i("2877")),l=Object(c["a"])(o,n,s,!1,null,"31e1b3f2",null);t["a"]=l.exports},a82c:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAF6SURBVHgB7ZZPSwJBGMafdXXdsqytjAJLjRD6401sD9WliLz0AfoUfasueu9gl052idKNLiEEIaTIRrnErv+aHUmQjF5F8DIPLPPMu8PzY152h5E6TJiAPJiQBFiABXhs8lIWZTIZaNrCwHeO48CyLKTTpwgEAqCKBNY0DeG4Dqc54JBzTLyWDOTzeei6ToaTW+1C7UYbskdCdEXloztvtTtQFB+HunB392MFKz4P1kMqtiPTmJ2S+fgj03zn0HrdQi53TcojtdqV3yuhyXZXrjl9ddkfxOZOivtF9jw/3pLyyODPrxbsj8avut1kTZPne/NweA0UkcEULQV9iMb3SGtHApfMG9SdKvczSggb2mEXyj46qoYGF96yKFSyfbVVbY5B97kvFg0kErv/5gx1cg2CpiJHOIh3oeWazcBFUhZ5xw9/QM+TF9xfPV1ysAo/KY8Edv9Tq2piC8e9WiwWw0nyjPt74w4vRoV7FcuUSEjisifAAizAo+obY1R9rvmeykkAAAAASUVORK5CYII="},abac:function(e,t,i){},b946:function(e,t,i){},ba81:function(e,t,i){},baeb:function(e,t,i){e.exports=i.p+"static/img/refresh.png"},bd22:function(e,t,i){"use strict";var n=i("27ac"),s=i.n(n);s.a},bf90:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAEG0lEQVRIS72WW2gcVRjH/9+ZMzs7m80m9dINoVjboj4UaaMPBlvpgxQJiA+hoSapDyoiXmjE+qB4QRHFhwpGWpReRKj2QsX2oRL6JGIqVsESURBLhWosTdKGbnazMztzZo58szuSrruzqxDPsgu7O+f8znf7fx+N7PM2kggGECKtCRrLsEiDQtKOIeQEDe8vvyhAWQ34AGgZeHykJsAEYZFG9zlvaELYLkxUd0cXIw3NG9tcmjQEjex3Xm9zA6SECBXCShBdEJYBISSEUtXv7ay2gGwVEWimCDebhuztQoYPv1RAueRC5TuR1m1a2xLIML5+0YX/6Ca5cfM6455chm5kYMHVVybPB2c/+lpNdWVgxs8mWdoSaBBofhHeW4PmgxtWGf26mgBxcnFW09R08O2rJ/1T3TZSgU7O9EQgx+zyNThPbpF9g31ySOtqrNi9UerVDieCOHFOffbhV+qHnm7YSTFNBPLBjg+1d8R6rCdHtzKQD1/qsvi32ZL+/ZlPKgfSEkZSBjUFMsxTCPJZ2Lu3p3daMkqUyIV1MYp+8xScXcfd8ZkFOCkJI7a+Pp6tgTnY7w6lx1ISdhKwolB+4Zj7/kzpPwL5Zuw7VyHYM2I9ns/R6iSXzizoi08frhy0Tchm1kXxTyr8OGmeuE/ete1uua2WodG+2FVx1p6aCk7u/dL/bmUOtgqbC0HLsmDoXAHuaw9ZW/vX0JYa6Lo4/jgdnN15xPs830U2q09SaSQCuQYXfahsGubz95tb1+aN2wIFlTaR5ZiqEN7Vov7TlLDminr2ndPeFyUXfocJ2QzaFMgwjt8KG9abg9aOlVm6hZMmCKE4RoYBMwwRCAGj5mPi0nj5ROVQoQyPy6MRNBF4zYH33sOp4bU3ifWhRiCoenj94jhyQvH/v10Jf37uqHekmeo0BEoBMbsAZ6TfWP9IvznaKDubgVn2Pv7GP3T0++CXniwsv07qGgLNWmfYM2oNr7uZ7mwbWFOiC3P6p2c/rRzmLtISyLXnhdAdFuT4duupznTUGRopTEPXsoVFV18dO1b5gGVRArRU6v5hYSxpPV2U2T1kjaWMqNcFUe3FnX4JKhqCqpMQf2oiGH4Ad9fxyvjlgi7Xy1xDl8bl8MqA+UDfamNTO5186TPnLgZn3p7wT1sNVKchMGqkIVD04G++nXrvXSPvWLVC9OZsdFsmZUyBFHuCY+sH8FylufMX/pgPpycvqPOTv+pLnRmeSK53Z0tpY0sLLvySq1XKILohCyubgpkyIYiItNaaa7XsQM2XUfECrTstMnIJjbiltDGUDERzHWukCqOa+3t+ZUuliN78gg6gE6Xt34yJceeNx8TIRTV4G2NbdUwcPeC8BI2O/2MQDqFLtOOgtyEI1YDQZC/nqA8BV4fGxF/vmR1mDoPLwAAAAABJRU5ErkJggg=="},bfbf:function(e,t,i){"use strict";var n=i("4475"),s=i.n(n);s.a},c62c:function(e,t,i){e.exports=i.p+"static/img/noMsgBg.png"},c663:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAASCAYAAAC9+TVUAAAAAXNSR0IArs4c6QAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAEaADAAQAAAABAAAAEgAAAADq+8vrAAABb0lEQVQ4Ec1UwW2DQBA06JDgFTowJVACH2T4ORWYDuIOQgfBHVACP7D44AqSVBD8yJ+84IFEZhBnIYxj/MtKp93bnRn29k4ojuOYuq6/KYoSrB6wrutKrOh4PB4Uz/NiCOyQ+ISvluoAbwP/BPyzkAJZltlLBYhzXdcWQrxDbKsy8UgHxNPyPP+gB9fqRbiZMxzV2mw2L3O1cU5FOyusNQc8LgxxoKpqxNanNX5g4JocbIeWiKmQjJqmORRFUTFBYU3TLNk6cyTDvYITwNO+exEEZywTBU77Sgy5OfKZJwDnpPi+3wFzqut6i/eyR7yXYohjANmVNfoyySFuM5ZcAUBvwxFCHCEaiVFQQi5kmZD+IiITUgz7EOd3IGK2bVuO5yKx0l+JyAI9Wi7G+1vxn+/kFmma/z8iAtf1g/bW0xbv7Tl0YsAvOdgEN7BD8gtxibXIwHEIhE8EnvneMIwKmy1yfYHFe4YO+P+J0zRNfgGfH625I1IIfQAAAABJRU5ErkJggg=="},c6e7:function(e,t,i){e.exports=i.p+"static/img/wenben-active.svg"},c844:function(e,t,i){e.exports=i.p+"static/img/lianjie-active.svg"},caad:function(e,t,i){"use strict";var n=i("23e7"),s=i("4d64").includes,a=i("44d2"),r=i("ae40"),o=r("indexOf",{ACCESSORS:!0,1:0});n({target:"Array",proto:!0,forced:!o},{includes:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),a("includes")},cab8:function(e,t,i){"use strict";var n=i("e30d"),s=i.n(n);s.a},d0ea:function(e,t,i){"use strict";var n=i("1093"),s=i.n(n);s.a},d27f:function(e,t,i){"use strict";var n=i("f1e1"),s=i.n(n);s.a},dde2:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"conversation-friends"},[i("div",{staticClass:"search-box"},[i("el-input",{attrs:{"prefix-icon":"el-icon-search",type:"text",placeholder:"搜索",maxlength:"20",size:"small","show-word-limit":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchChange(t)}},model:{value:e.searchInfo,callback:function(t){e.searchInfo=t},expression:"searchInfo"}})],1),i("div",{staticClass:"friends-content scroll",attrs:{id:"friends-list"},on:{scroll:e.handlerScroll}},[e._l(e.searchInfo?e.searchResult:e.resetRooms,(function(t,n){return i("div",{key:n,staticClass:"friend-info",class:{selected:e.currentFriendId===t.UserName},on:{click:function(i){return e.$parent.choseFriend(t)}}},[i("div",{staticClass:"avatar-tip"},[i("el-avatar",{key:t.Avatar,attrs:{shape:"square",size:40,src:t.Avatar}},[i("i",{staticClass:"fa fa-picture-o",attrs:{"aria-hidden":"true",title:"头像miss"}})])],1),i("div",{staticClass:"nick-content"},[i("div",{staticClass:"friend-nick",domProps:{textContent:e._s(t.NickName)}})]),i("div",{staticClass:"opration-btns"},[i("i",{staticClass:"fa fa-retweet sigle-fresh",attrs:{"aria-hidden":"true"},on:{click:function(i){return i.stopPropagation(),e.$parent.getFriendDetail(t)}}}),i("i",{staticClass:"el-icon-close-notification",class:{"msg-silent":!t.MsgSilent},attrs:{"aria-hidden":"true"},on:{click:function(i){return e.msgSilent(t.UserName,!t.MsgSilent)}}})])])})),e.currentWeChatId&&e.maxNumber>=e.roomsList.length?i("div",{staticClass:"current-info-null"},[e._v("数据已经到底了！")]):e._e()],2)])},s=[],a=(i("4de4"),i("c975"),i("fb6a"),i("5530")),r=i("2f62"),o={data:function(){return{maxNumber:20,searchInfo:"",searchResult:[],chatToDel:{}}},computed:Object(a["a"])(Object(a["a"])(Object(a["a"])({},Object(r["d"])("nedb",{roomsList:"chatRooms"})),Object(r["b"])({currentFriendId:"conversation/currentFriendId",currentWeChatId:"conversation/currentWeChatId"})),{},{resetRooms:function(){return this.roomsList.slice(0,this.maxNumber)}}),watch:{searchInfo:function(e){this.debounceInput()},currentWeChatId:function(){this.maxNumber=20}},created:function(){this.debounceInput=this._.debounce(this.debounceInput,500)},methods:{handlerScroll:function(){var e=document.getElementById("friends-list").scrollTop,t=document.getElementById("friends-list").clientHeight,i=document.getElementById("friends-list").scrollHeight;e+t+2>=i&&this.maxNumber<this.roomsList.length&&(this.maxNumber=this.maxNumber+2)},debounceInput:function(){var e=this;if(this.searchInfo){var t=this.roomsList.filter((function(t){return t.NickName&&t.NickName.indexOf(e.searchInfo)>=0||t.Memo&&t.Memo.indexOf(e.searchInfo)>=0?t:void 0}));this.searchResult=t}else this.searchResult=[]},msgSilent:function(e,t){var i={WeChatId:this.currentWeChatId,ChatRoomId:e,Action:6,IntValue:t?1:0};this.$store.dispatch("websocket/ChatRoomActionTask",i);var n=this.$loading({lock:!0,text:"正在执行操作",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});setTimeout((function(){n.close()}),2e3)}}},c=o,l=(i("d0ea"),i("2877")),d=Object(l["a"])(c,n,s,!1,null,"5a764728",null);t["default"]=d.exports},decc:function(e,t,i){e.exports=i.p+"static/img/conversation-transfer-money.svg"},decf:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return s}));var n={0:"微笑",1:"撇嘴",2:"色",3:"发呆",4:"得意",5:"流泪",6:"害羞",7:"闭嘴",8:"睡",9:"大哭",10:"尴尬",11:"发怒",12:"调皮",13:"呲牙",14:"惊讶",15:"难过",16:"酷",17:"冷汗",18:"抓狂",19:"吐",20:"偷笑",21:"愉快",22:"白眼",23:"傲慢",24:"饥饿",25:"困",26:"惊恐",27:"流汗",28:"憨笑",29:"悠闲",30:"奋斗",31:"咒骂",32:"疑问",33:"嘘",34:"晕",35:"疯了",36:"衰",37:"骷髅",38:"敲打",39:"再见",40:"擦汗",41:"抠鼻",42:"鼓掌",43:"糗大了",44:"坏笑",45:"左哼哼",46:"右哼哼",47:"哈欠",48:"鄙视",49:"委屈",50:"快哭了",51:"阴险",52:"亲亲",53:"吓",54:"可怜",55:"菜刀",56:"西瓜",57:"啤酒",58:"篮球",59:"乒乓",60:"咖啡",61:"饭",62:"猪头",63:"玫瑰",64:"凋谢",65:"嘴唇",66:"爱心",67:"心碎",68:"蛋糕",69:"闪电",70:"炸弹",71:"刀",72:"足球",73:"瓢虫",74:"便便",75:"月亮",76:"太阳",77:"礼物",78:"拥抱",79:"强",80:"弱",81:"握手",82:"胜利",83:"抱拳",84:"勾引",85:"拳头",86:"差劲",87:"爱你",88:"NO",89:"OK",90:"爱情",91:"飞吻",92:"跳跳",93:"发抖",94:"怄火",95:"转圈",96:"磕头",97:"回头",98:"跳绳",99:"投降",100:"激动",101:"乱舞",102:"献吻",103:"左太极",104:"右太极",105:"笑脸",106:"生病",107:"破涕为笑",108:"吐舌",109:"脸红",110:"恐惧",111:"失望",112:"无语",113:"嘿哈",114:"捂脸",115:"奸笑",116:"机智",117:"皱眉",118:"耶",119:"鬼魂",120:"合十",121:"强壮",122:"庆祝",123:"礼物",124:"红包",125:"鸡",126:"开心",127:"大笑",128:"热情",129:"眨眼",130:"色",131:"接吻",132:"亲吻",133:"露齿笑",134:"满意",135:"戏弄",136:"得意",137:"汗",138:"低落",139:"呸",140:"焦虑",141:"担心",142:"震惊",143:"悔恨",144:"眼泪",145:"哭",146:"晕",147:"心烦",148:"生气",149:"睡觉",150:"恶魔",151:"外星人",152:"心",153:"心碎",154:"丘比特",155:"闪烁",156:"星星",157:"叹号",158:"问号",159:"睡着",160:"水滴",161:"音乐",162:"火",163:"便便",164:"强",165:"弱",166:"拳头",167:"胜利",168:"上",169:"下",170:"右",171:"左",172:"第一",173:"吻",174:"热恋",175:"男孩",176:"女孩",177:"女士",178:"男士",179:"天使",180:"骷髅",181:"红唇",182:"太阳",183:"下雨",184:"多云",185:"雪人",186:"月亮",187:"闪电",188:"海浪",189:"猫",190:"小狗",191:"老鼠",192:"仓鼠",193:"兔子",194:"狗",195:"青蛙",196:"老虎",197:"考拉",198:"熊",199:"猪",200:"牛",201:"野猪",202:"猴子",203:"马",204:"蛇",205:"鸽子",206:"鸡",207:"企鹅",208:"毛虫",209:"章鱼",210:"鱼",211:"鲸鱼",212:"海豚",213:"玫瑰",214:"花",215:"棕榈树",216:"仙人掌",217:"礼盒",218:"南瓜灯",219:"圣诞老人",220:"圣诞树",221:"铃",222:"气球",223:"CD",224:"相机",225:"录像机",226:"电脑",227:"电视",228:"电话",229:"解锁",230:"锁",231:"钥匙",232:"成交",233:"灯泡",234:"邮箱",235:"浴缸",236:"钱",237:"炸弹",238:"手枪",239:"药丸",240:"橄榄球",241:"篮球",242:"足球",243:"棒球",244:"高尔夫",245:"奖杯",246:"入侵者",247:"唱歌",248:"吉他",249:"比基尼",250:"皇冠",251:"雨伞",252:"手提包",253:"口红",254:"戒指",255:"钻石",256:"咖啡",257:"啤酒",258:"干杯",259:"鸡尾酒",260:"汉堡",261:"薯条",262:"意面",263:"寿司",264:"面条",265:"煎蛋",266:"冰激凌",267:"蛋糕",268:"苹果",269:"飞机",270:"火箭",271:"自行车",272:"高铁",273:"警告",274:"旗",275:"男人",276:"女人",277:"O",278:"X",279:"版权",280:"注册商标",281:"商标"},s={"<笑脸>":"1f604","<笑臉>":"1f604","<Laugh>":"1f604","<开心>":"1f60a","<開心>":"1f60a","<Happy>":"1f60a","<大笑>":"1f603","<Big Smile>":"1f603","<热情>":"263a","<熱情>":"263a","<Glowing>":"263a","<眨眼>":"1f609","<Wink>":"1f609","<色>":"1f60d","<Love>":"1f60d","<Drool>":"1f60d","<接吻>":"1f618","<Smooch>":"1f618","<亲吻>":"1f61a","<親吻>":"1f61a","<Kiss>":"1f61a","<脸红>":"1f633","<臉紅>":"1f633","<Blush>":"1f633","<露齿笑>":"1F601","<露齒笑>":"1F601","<Grin>":"1f63c","<满意>":"1f60c","<滿意>":"1f60c","<Satisfied>":"1f60c","<戏弄>":"1f61c","<戲弄>":"1f61c","<Tease>":"1f61c","<吐舌>":"1F61D","<Tongue>":"1F61D","<无语>":"1f612","<無語>":"1f612","<Speechless>":"1f612","<得意>":"1f60f","<Smirk>":"1f60f","<CoolGuy>":"1f60f","<汗>":"1f613","<Sweat>":"1f613","<失望>":"1F614","<Let Down>":"1F614","<合十>":"1f64f","<祈禱>":"1f64f","<低落>":"1f61e","<Low>":"1f61e","<呸>":"1f616","<Ugh>":"1f616","<焦虑>":"1f625","<焦慮>":"1f625","<Anxious>":"1f625","<担心>":"1f630","<擔心>":"1f630","<Worried>":"1f630","<震惊>":"1f628","<震驚>":"1f628","<Shocked>":"1f628","<悔恨>":"1f62b","<D’oh!>":"1f62b","<眼泪>":"1f622","<眼淚>":"1f622","<Tear>":"1f622","<哭>":"1f62d","<Cry>":"1f62d","<破涕为笑>":"1f602","<破涕為笑>":"1f602","<Lol>":"1f602","<晕>":"1F632","<Dead>":"1f632","<Dizzy>":"1f632","<恐惧>":"1f631","<恐懼>":"1f631","<Terror>":"1f631","<心烦>":"1f620","<心煩>":"1f620","<Upset>":"1f620","<生气>":"1F621","<生氣>":"1F621","<Angry>":"1F621","<睡觉>":"1f62a","<睡覺>":"1f62a","<Zzz>":"1f62a","<生病>":"1f637","<Sick>":"1f637","<恶魔>":"1f47f","<惡魔>":"1f47f","<Demon>":"1f47f","<外星人>":"1f47d","<Alien>":"1f47d","<心>":"2764","<Heart>":"2764","<心碎>":"1f494","<Heartbroken>":"1f494","<BrokenHeart>":"1f494","<丘比特>":"1f498","<Cupid>":"1f498","<闪烁>":"2728","<閃爍>":"2728","<Twinkle>":"2728","<星星>":"1f31f","<Star>":"1f31f","<叹号>":"2755","<嘆號>":"2755","<!>":"2755","<问号>":"2754","<問號>":"2754","<?>":"2754","<睡着>":"1f4a4","<睡著>":"1f4a4","<Asleep>":"1f4a4","<水滴>":"1f4a6","<Drops>":"1f4a6","<音乐>":"1f3b5","<音樂>":"1f3b5","<Music>":"1f3b5","<火>":"1f525","<Fire>":"1f525","<便便>":"1f4a9","<Poop>":"1f4a9","<强>":"1f44d","<強>":"1f44d","<ThumbsUp>":"1f44d","<弱>":"1f44e","<ThumbsDown>":"1f44e","<拳头>":"1f44a","<拳頭>":"1f44a","<Punch>":"1f44a","<Fist>":"1f44a","<胜利>":"270c","<勝利>":"270c","<Peace>":"270c","<上>":"1f446","<Up>":"1f446","<下>":"1f447","<Down>":"1f447","<右>":"1f449","<Right>":"1f449","<左>":"1f448","<Left>":"1f448","<第一>":"261d","<#1>":"261d","<强壮>":"1f4aa","<強壯>":"1f4aa","<Strong>":"1f4aa","<吻>":"1f48f","<Kissing>":"1f48f","<热恋>":"1f491","<熱戀>":"1f491","<Couple>":"1f491","<男孩>":"1f466","<Boy>":"1f466","<女孩>":"1f467","<Girl>":"1f467","<女士>":"1f469","<Lady>":"1f469","<男士>":"1f468","<Man>":"1f468","<天使>":"1f47c","<Angel>":"1f47c","<骷髅>":"1f480","<骷髏頭>":"1f480","<骷髏>":"1f480","<Skull>":"1f480","<红唇>":"1f48b","<紅唇>":"1f48b","<Lips>":"1f48b","<太阳>":"2600","<太陽>":"2600","<Sun>":"2600","<下雨>":"2614","<Rain>":"2614","<多云>":"2601","<多雲>":"2601","<Cloud>":"2601","<雪人>":"26c4","<Snowman>":"26c4","<月亮>":"1f319","<Moon>":"1f319","<闪电>":"26a1","<閃電>":"26a1","<Lightning>":"26a1","<海浪>":"1f30a","<Waves>":"1f30a","<猫>":"1f431","<貓>":"1f431","<Cat>":"1f431","<小狗>":"1F436","<Doggy>":"1F436","<老鼠>":"1f42d","<Mouse>":"1f42d","<仓鼠>":"1f439","<倉鼠>":"1f439","<Hamster>":"1f439","<兔子>":"1f430","<Rabbit>":"1f430","<狗>":"1f43a","<Dog>":"1f43a","<青蛙>":"1f438","<Frog>":"1f438","<老虎>":"1f42f","<Tiger>":"1f42f","<考拉>":"1f428","<Koala>":"1f428","<熊>":"1f43b","<Bear>":"1f43b","<猪>":"1f437","<豬>":"1f437","<Pig>":"1f437","<牛>":"1f42e","<Cow>":"1f42e","<野猪>":"1f417","<野豬>":"1f417","<Boar>":"1f417","<猴子>":"1f435","<Monkey>":"1f435","<马>":"1f434","<馬>":"1f434","<Horse>":"1f434","<蛇>":"1f40d","<Snake>":"1f40d","<鸽子>":"1f426","<鴿子>":"1f426","<Pigeon>":"1f426","<鸡>":"1f414","<雞>":"1f414","<Chicken>":"1f414","<企鹅>":"1f427","<企鵝>":"1f427","<Penguin>":"1f427","<毛虫>":"1f41b","<毛蟲>":"1f41b","<Caterpillar>":"1f41b","<章鱼>":"1f419","<八爪魚>":"1f419","<Octopus>":"1f419","<鱼>":"1f420","<魚>":"1f420","<Fish>":"1f420","<鲸鱼>":"1f433","<鯨魚>":"1f433","<Whale>":"1f433","<海豚>":"1f42c","<Dolphin>":"1f42c","<玫瑰>":"1f339","<Rose>":"1f339","<花>":"1f33a","<Flower>":"1f33a","<棕榈树>":"1f334","<棕櫚樹>":"1f334","<Palm>":"1f334","<仙人掌>":"1f335","<Cactus>":"1f335","<礼盒>":"1f49d","<禮盒>":"1f49d","<Candy Box>":"1f49d","<南瓜灯>":"1f383","<南瓜燈>":"1f383","<Jack-o-lantern>":"1f383","<鬼魂>":"1f47b","<Ghost>":"1f47b","<圣诞老人>":"1f385","<聖誕老人>":"1f385","<Santa>":"1f385","<圣诞树>":"1f384","<聖誕樹>":"1f384","<Xmas Tree>":"1f384","<礼物>":"1f381","<禮物>":"1f381","<Gift>":"1f381","<铃>":"1f514","<鈴鐺>":"1f514","<Bell>":"1f514","<庆祝>":"1f389","<慶祝>":"1f389","<Party>":"1f389","<气球>":"1f388","<氣球>":"1f388","<Balloon>":"1f388","<CD>":"1f4bf","<相机>":"1f4f7","<相機>":"1f4f7","<Camera>":"1f4f7","<录像机>":"1f3a5","<錄影機>":"1f3a5","<Film Camera>":"1f3a5","<电脑>":"1f4bb","<電腦>":"1f4bb","<Computer>":"1f4bb","<电视>":"1f4fa","<電視>":"1f4fa","<TV>":"1f4fa","<电话>":"1f4de","<電話>":"1f4de","<Phone>":"1f4de","<解锁>":"1f513","<解鎖>":"1f513","<Unlocked>":"1f513","<锁>":"1f512","<鎖>":"1f512","<Locked>":"1f512","<钥匙>":"1f511","<鑰匙>":"1f511","<Key>":"1f511","<成交>":"1f528","<Judgement>":"1f528","<灯泡>":"1f4a1","<燈泡>":"1f4a1","<Light bulb>":"1f4a1","<邮箱>":"1f4eb","<郵箱>":"1f4eb","<Mail>":"1f4eb","<浴缸>":"1f6c0","<Wash>":"1f6c0","<钱>":"1f4b2","<錢>":"1f4b2","<Money>":"1f4b2","<炸弹>":"1f4a3","<炸彈>":"1f4a3","<Bomb>":"1f4a3","<手枪>":"1f52b","<手槍>":"1f52b","<Pistol>":"1f52b","<药丸>":"1f48a","<藥丸>":"1f48a","<Pill>":"1f48a","<橄榄球>":"1f3c8","<橄欖球>":"1f3c8","<Football>":"1f3c8","<篮球>":"1f3c0","<籃球>":"1f3c0","<Basketball>":"1f3c0","<足球>":"26bd","<Soccer Ball>":"26bd","<Soccer>":"26bd","<棒球>":"26be","<Baseball>":"26be","<高尔夫>":"26f3","<高爾夫>":"26f3","<Golf>":"26f3","<奖杯>":"1f3c6","<獎盃>":"1f3c6","<Trophy>":"1f3c6","<入侵者>":"1f47e","<Invader>":"1f47e","<唱歌>":"1f3a4","<Singing>":"1f3a4","<吉他>":"1f3b8","<Guitar>":"1f3b8","<比基尼>":"1f459","<Bikini>":"1f459","<皇冠>":"1f451","<Crown>":"1f451","<雨伞>":"1f302","<雨傘>":"1f302","<Umbrella>":"1f302","<手提包>":"1f45c","<Purse>":"1f45c","<口红>":"1f484","<口紅>":"1f484","<Lipstick>":"1f484","<戒指>":"1f48d","<Ring>":"1f48d","<钻石>":"1f48e","<鑽石>":"1f48e","<Gem>":"1f48e","<咖啡>":"2615","<Coffee>":"2615","<啤酒>":"1f37a","<Beer>":"1f37a","<干杯>":"1f37b","<乾杯>":"1f37b","<Toast>":"1f37b","<鸡尾酒>":"1F378","<雞尾酒>":"1F378","<Martini>":"1F378","<汉堡>":"1f354","<漢堡>":"1f354","<Burger>":"1f354","<薯条>":"1f35f","<薯條>":"1f35f","<Fries>":"1f35f","<意面>":"1f35d","<意粉>":"1f35d","<Sphaghetti>":"1f35d","<寿司>":"1f363","<壽司>":"1f363","<Sushi>":"1f363","<面条>":"1f35c","<麵條>":"1f35c","<Noodles>":"1f35c","<煎蛋>":"1f373","<Eggs>":"1f373","<冰激凌>":"1f366","<雪糕>":"1f366","<Ice Cream>":"1f366","<蛋糕>":"1f382","<Cake>":"1f382","<苹果>":"1F34E","<蘋果>":"1F34E","<Apple>":"1F34E","<飞机>":"2708","<飛機>":"2708","<Plane>":"2708","<火箭>":"1f680","<Rocket ship>":"1f680","<自行车>":"1f6b2","<單車>":"1f6b2","<Bike>":"1f6b2","<高铁>":"1f684","<高鐵>":"1f684","<Bullet Train>":"1f684","<警告>":"26a0","<Warning>":"26a0","<旗>":"1f3c1","<Flag>":"1f3c1","<男人>":"1f6b9","<男>":"1f6b9","<Men>":"1f6b9","<女人>":"1f6ba","<女>":"1f6ba","<Women>":"1f6ba","<O>":"2b55","<X>":"274C","<版权>":"a9","<版權>":"a9","<Copyright>":"a9","<注册商标>":"ae","<注冊商標>":"ae","<Registered TM>":"ae","<商标>":"2122","<商標>":"2122","<Trademark>":"2122"}},e1a9:function(e,t,i){},e2e4:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"convers-list-all"},[i("div",{staticClass:"all-convs-tabs"},[i("el-select",{attrs:{size:"small",clearable:"",placeholder:"所有微信"},model:{value:e.filterWeChatId,callback:function(t){e.filterWeChatId=t},expression:"filterWeChatId"}},e._l(e.wechatsOnline,(function(e,t){return i("el-option",{key:t,attrs:{label:e.WeChatNick,value:e.WeChatId,disabled:!e.IsOnline}})})),1),i("el-select",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",clearable:"",placeholder:"全部会话"},model:{value:e.unreadFlag,callback:function(t){e.unreadFlag=t},expression:"unreadFlag"}},e._l(e.unreadStates,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),i("div",{staticClass:"search-box"},[i("el-input",{attrs:{"prefix-icon":"el-icon-search",type:"text",placeholder:"搜索",maxlength:"20",size:"small","show-word-limit":"",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchChange(t)}},model:{value:e.searchInfo,callback:function(t){e.searchInfo=t},expression:"searchInfo"}})],1),i("div",{staticClass:"friends-content scroll",attrs:{id:"friends-list"},on:{scroll:e.handlerScroll}},e._l(e.searchInfo?e.searchResult:e.conversations,(function(t,n){return i("div",{key:n,staticClass:"friend-info",class:{selected:e.currentFriendId===t.UserName&&e.currentWeChatId===t.WeChatId},on:{click:function(i){return e.$parent.choseFriend(t,!0)}}},[i("div",{staticClass:"avatar-tip"},[i("el-avatar",{key:t.Avatar,attrs:{shape:"square",size:40,src:t.Avatar}},[i("i",{staticClass:"fa fa-picture-o",attrs:{"aria-hidden":"true",title:"头像miss"}})]),t.UnreadCnt&&t.UnreadCnt>0?i("div",{staticClass:"tip",attrs:{title:t.UnreadCnt},domProps:{textContent:e._s(t.UnreadCnt<99?t.UnreadCnt:"...")}}):e._e()],1),i("div",{staticClass:"nick-content"},[i("div",{staticClass:"friend-nick ellipsis",domProps:{textContent:e._s(t.ShowName)}}),t.Digest?i("div",{staticClass:"chat-content ellipsis",domProps:{textContent:e._s(t.Digest.replace("%s:",""))}}):i("div",{staticClass:"chat-content ellipsis",domProps:{textContent:e._s("")}})]),i("div",{staticClass:"time-disturb"},[i("div",{domProps:{textContent:e._s(e.$options.filters.transformTime(t.UpdateTime))}}),i("div",{staticClass:"opration-btns"},["notifymessage"!==t.UserName?[i("i",{staticClass:"el-icon-upload2",class:{"top-convs":t.IsTop},attrs:{"aria-hidden":"true",title:"置顶"},on:{click:function(i){return i.stopPropagation(),e.setTop(t)}}}),i("i",{staticClass:"fa fa-retweet sigle-fresh",attrs:{"aria-hidden":"true"},on:{click:function(i){return i.stopPropagation(),e.$parent.getFriendDetail(t)}}}),i("i",{staticClass:"el-icon-close-notification",class:{"msg-silent":t.IsSilent},attrs:{"aria-hidden":"true"},on:{click:function(i){return e.msgSilent(t)}}})]:e._e()],2)])])})),0),i("div",{staticClass:"operation-btns"},[i("p",[e._v("共"+e._s(e.totalConvers))]),i("el-select",{attrs:{size:"small",clearable:"",placeholder:"最近三天"},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}},e._l(e.timeStates,(function(e,t){return i("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1),i("i",{staticClass:"el-icon-refresh",on:{click:e.freshAllConv}},[e._v("刷新数据")])],1)])},s=[],a=(i("99af"),i("4de4"),i("4160"),i("c975"),i("fb6a"),i("159b"),i("b85c"));function r(e){if(Array.isArray(e))return e}var o=i("db90"),c=i("06c5");function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e){return r(e)||Object(o["a"])(e)||Object(c["a"])(e)||l()}var u=i("5530"),h=i("2f62"),f=i("2c32"),p={data:function(){return{maxNumber:20,searchInfo:"",filterWeChatId:"",unreadFlag:"",conversUnread:[],unreadStates:[{label:"私聊",value:"friend"},{label:"群聊",value:"room"},{label:"未读",value:"notRead"},{label:"已读",value:"readed"}],startTime:"",timeStates:[{label:"最近一周",value:"week"},{label:"最近一月",value:"month"},{label:"全部",value:"all"}],searchResult:[]}},computed:Object(u["a"])(Object(u["a"])({},Object(h["b"])({wechatsOnline:"conversation/wechatsOnline",allConversations:"conversation/allConversations",currentWeChatId:"conversation/currentWeChatId",currentFriendId:"conversation/currentFriendId"})),{},{conversations:function(){var e=this,t=d(this.allConversations),i=t.slice(0);this.filterWeChatId&&(i=this.allConversations.filter((function(t){return t.WeChatId===e.filterWeChatId}))),"friend"===this.unreadFlag?i=i.filter((function(e){return e.UserName.indexOf("chatroom")<0})):"room"===this.unreadFlag?i=i.filter((function(e){return e.UserName.indexOf("chatroom")>0})):"readed"===this.unreadFlag?i=i.filter((function(e){return!e.UnreadCnt||0===e.UnreadCnt})):"notRead"===this.unreadFlag&&(i=i.filter((function(t){return t.UnreadCnt&&t.UnreadCnt>0||e.conversUnread.indexOf(t.WeChatId+t.UserName)>=0})),this.conversUnread=[],i.forEach((function(t){e.conversUnread.push(t.WeChatId+t.UserName)}))),"notRead"!==this.unreadFlag&&(this.conversUnread=[]);var n=i.filter((function(e){return e.IsTop})),s=i.filter((function(e){return!e.IsTop}));return n.concat(s).slice(0,this.maxNumber)},totalConvers:function(){var e=this,t=d(this.allConversations),i=t.slice(0);return this.filterWeChatId&&(i=this.allConversations.filter((function(t){return t.WeChatId===e.filterWeChatId}))),"friend"===this.unreadFlag?i=i.filter((function(e){return e.UserName.indexOf("chatroom")<0})):"room"===this.unreadFlag?i=i.filter((function(e){return e.UserName.indexOf("chatroom")>0})):"readed"===this.unreadFlag?i=i.filter((function(e){return!e.UnreadCnt||0===e.UnreadCnt})):"notRead"===this.unreadFlag&&(i=i.filter((function(e){return e.UnreadCnt&&e.UnreadCnt>0}))),i.length}}),watch:{searchInfo:function(){this.debounceInput()}},created:function(){this.debounceInput=this._.debounce(this.debounceInput,500)},destroyed:function(){this.$store.commit("conversation/SET_CURRENT_FRIEND",null)},methods:{freshAllConv:function(){var e=(new Date).getTime()-2592e5;if("week"===this.startTime?e=(new Date).getTime()-6048e5:"month"===this.startTime?e=(new Date).getTime()-26784e5:"all"===this.startTime&&(e=0),this.filterWeChatId)this.$store.commit("conversation/DELETE_CONVERSATIONS_BY_ID",this.filterWeChatId),Object(f["C"])(this.filterWeChatId,e);else{this.$store.commit("conversation/RESET_CONVERSATIONS");var t,i=Object(a["a"])(this.wechatsOnline);try{for(i.s();!(t=i.n()).done;){var n=t.value;Object(f["C"])(n.WeChatId,e)}}catch(s){i.e(s)}finally{i.f()}}},handlerScroll:function(){var e=document.getElementById("friends-list").scrollTop,t=document.getElementById("friends-list").clientHeight,i=document.getElementById("friends-list").scrollHeight;e+t+2>=i&&this.maxNumber<=this.allConversations.length&&(this.maxNumber=this.maxNumber+5)},debounceInput:function(){var e=this;if(this.searchInfo){var t=this.allConversations.filter((function(t){return t.ShowName&&t.ShowName.indexOf(e.searchInfo)>=0}));this.searchResult=t}else this.searchResult=[]},msgSilent:function(e){var t={WeChatId:e.WeChatId,ChatRoomId:e.UserName,Action:6,IntValue:e.IsSilent?1:0};this.$store.dispatch("websocket/ChatRoomActionTask",t),this.$message.success("任务已经下发！")},setTop:function(e){var t={WeChatId:e.WeChatId,ChatRoomId:e.UserName,Action:16,IntValue:e.IsTop?0:1};this.$store.dispatch("websocket/ChatRoomActionTask",t),this.$message.success("任务已经下发！")}}},m=p,g=(i("0856"),i("2877")),C=Object(g["a"])(m,n,s,!1,null,"7fd1ed8d",null);t["default"]=C.exports},e30d:function(e,t,i){},e56e:function(e,t,i){e.exports=i.p+"static/img/qqface.png"},e874:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAEqADAAQAAAABAAAAEgAAAAC5YZBvAAACRklEQVQ4EY1TMW/TUBC+e0las7RG6gBCIFfdqTMy4f6AgkXFjDsExIK8ILHhih9AYCtBSjoXoSB+QOyJBRS3O2BYYAAlkRAKxfFxz46d55QITnq+e3ff+3x37x7CAjnZ2ekA0FVENCSEiCJEOKi9eOnJ/byg6iBX16EmHvMxE75cvheP115zfHWGoeDuWtsHgtX418pep4PDPCZyg+7rJixhHxAcQDTh/PHTqvZtm+OjHFNoBLe6POo1Gj/M3JcS0QPdAMAeL9ZT+ScZmiTituOQLk9kGU2ww1mkjpwn1f9BVlketSW2Sm/OGVzzwxKB3CB8witfo8wfAN20rZgqXraffZEwsL2BLoCwCSj8ufUEtHHRSHkMD7thNZ44MwqABHD3+8XEFAJswSVZapDtI9B+WlgflogkBrvdwidJBhcmFgLeIgRL9ki53oyktSSbv1hUkhRFYBTXz440k2fibJNiYS+iiccrzTwTFSOJjngAA1mOJJGpqoB5e7QxPIXhifer3DK3o2nhCZ5p85gXmTT6htmqR6FKdOPRwCMug+SPFeEe+ekT2Q/XQ35Tm3mMAPbeJYnL2mpFHyOoQBHLMSV9DYOsR4jdUkBukC8Bodcw1nnOkl0u3//romRLwlOiO5sfPAa9kg5VOF09Jbu00eTnf6DGpnYA17MhLW6tlpDDtadgxCTKDy0kk8QTLHrKuLLsHxs2ViB6+xv6aoT7NeSntNX6/N4BwS9hu9yOU0T54dt9w2XbZAJj6gvZ7j6vR/50X1J/ALLU3Z3mTcM4AAAAAElFTkSuQmCC"},eaed:function(e,t,i){e.exports=i.p+"static/img/shipin.svg"},ec12:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAEqADAAQAAAABAAAAEgAAAAC5YZBvAAABnUlEQVQ4EZWTMW7CQBBF18QFruAGcQpq4AabAgFVoEyFcwLgBFFOEDhBOEJSAaKw6VJCjxR8A6ejADlvwBvZKFLslT6endl5Ox4Plta66jjOs1LKQ1WUe8VxvEeT5XI5tbrd7oTMIZrijHJTLgcblmU9YPZtkj020/l8PioIOR/vdDobDK8EpJKuhIBGbl4o+RGqltIJAGY4ffTFK/fSsf/sDAjAgOo+0DcqBLKvbloDk+bJer888v1mKqLhmrT+8XhsYhcCXVek/gK0Wq2Gbdsya4pLXlar1Ubs9MpUlA4YO4H47Jv07R6gLz4TN88MSL4UX85vt9syoMpAAFhI42rwDAUmY8L+d8lkx+xkqis02sMO0S2S8l2BnE4nbV5H/lLlcjngbJ3YU5KjTEXDxDGmRy6AvgDQOg3Br4IgiA6Hgya2JecNV138pqKQJvbMrRLIs5IBHnB2fa4I+qwoRC5aLBaeVCa2gEJKPJcnjiJL+sV5+a/u5dVGbF7RBkdUBMRZlyJcGeCb3W73WavVtkDucDoo9wIU8jEepS0/K9PKrlt65+oAAAAASUVORK5CYII="},efb7:function(e,t,i){e.exports=i.p+"static/img/tianjiatupian.png"},f067:function(e,t,i){e.exports=i.p+"static/img/conversation-image-error.svg"},f1b7:function(e,t,i){"use strict";var n=i("b946"),s=i.n(n);s.a},f1e1:function(e,t,i){},f6d6:function(e,t,i){var n=i("23e7"),s=i("23cb"),a=String.fromCharCode,r=String.fromCodePoint,o=!!r&&1!=r.length;n({target:"String",stat:!0,forced:o},{fromCodePoint:function(e){var t,i=[],n=arguments.length,r=0;while(n>r){if(t=+arguments[r++],s(t,1114111)!==t)throw RangeError(t+" is not a valid code point");i.push(t<65536?a(t):a(55296+((t-=65536)>>10),t%1024+56320))}return i.join("")}})},fe55:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"conversation-page"},[i("FirstPart"),i("SecondPart"),i("ThirdPart"),i("div",{attrs:{id:"draggableWrap",draggable:"true"},on:{dragend:function(t){return e.endMove(t)}}},[0===e.chatList.length?i("span",{staticClass:"iconfont icon-friend-circle",staticStyle:{"font-size":"30px",cursor:"pointer"}}):e.chatListVisible?e._e():i("svg",{staticClass:"icon",staticStyle:{"font-size":"30px",cursor:"pointer"},attrs:{"aria-hidden":"true"},on:{click:function(t){return e.showChatList(t)}}},[i("use",{attrs:{"xlink:href":"#icon-friend-circle"}})]),e.chatListVisible&&e.chatMsgData.length>0?i("div",{staticClass:"tip"},[i("span",{staticStyle:{"font-size":"16px","font-weight":"600"}},[e._v("待发朋友圈列表")]),i("i",{staticClass:"el-icon-close",staticStyle:{cursor:"pointer","font-size":"20px"},on:{click:e.hideChatList}})]):e._e(),i("el-table",{directives:[{name:"show",rawName:"v-show",value:e.chatListVisible&&e.chatMsgData.length>0,expression:"chatListVisible && chatMsgData.length > 0"}],staticStyle:{width:"500px"},attrs:{data:e.chatMsgData,"max-height":"400px",stripe:"",border:""}},[i("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),i("el-table-column",{attrs:{prop:"textContent",label:"内容",width:"180"}}),i("el-table-column",{attrs:{prop:"media",label:"媒体"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.media,(function(e,t){return i("img",{key:t,staticStyle:{height:"100px",width:"100px","object-fit":"cover"},attrs:{src:e}})}))}}])}),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.sendChatItem(t.row)}}},[e._v("发送")]),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.deleteChatItem(t.row)}}},[e._v("删除")]),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.insertLocalStorage(t.row)}}},[e._v("存草稿")])]}}])})],1)],1)],1)},s=[],a=(i("99af"),i("4de4"),i("b85c")),r=i("5530"),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"frist-part",class:{"all-convs":e.allConvs}},[e.allConvs?e._e():i("ul",{staticClass:"tab-list"},[i("li",{staticClass:"tab-item can-not-select",class:{"tab-item-chose":"convs"===e.currentTab},on:{click:function(t){return e.setTab("convs")}}},[e._v(" 会话 ")]),i("li",{staticClass:"tab-item can-not-select",class:{"tab-item-chose":"friends"===e.currentTab},on:{click:function(t){return e.setTab("friends")}}},[e._v(" 通讯录 ")]),i("li",{staticClass:"tab-item can-not-select",class:{"tab-item-chose":"rooms"===e.currentTab},on:{click:function(t){return e.setTab("rooms")}}},[e._v(" 群聊 ")])]),"convs"!==e.currentTab||e.allConvs?"convs"===e.currentTab&&e.allConvs?i("ConvsListAll"):"friends"===e.currentTab?i("FriendsList"):i("RoomsList"):i("ConvsList"),e.allConvs?e._e():i("div",{staticClass:"operation-btns"},[i("p",[e._v("共"+e._s(e.totalNum))]),i("i",{staticClass:"el-icon-refresh",on:{click:function(t){return e.freshData(e.currentTab)}}},[e._v("刷新数据")])])],1)},c=[],l=(i("4160"),i("c975"),i("d3b7"),i("159b"),i("2f62")),d=i("2c32"),u=function(){return i.e("conversation").then(i.bind(null,"53ad"))},h=function(){return i.e("conversation").then(i.bind(null,"e2e4"))},f=function(){return i.e("conversation").then(i.bind(null,"67c6"))},p=function(){return i.e("conversation").then(i.bind(null,"dde2"))},m={components:{ConvsList:u,ConvsListAll:h,FriendsList:f,RoomsList:p},data:function(){return{currentTab:"convs"}},computed:Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(l["d"])("nedb",{friends:"friends",chatRooms:"chatRooms"})),Object(l["b"])({allConvs:"allConvs",wechats:"conversation/wechats",refreshButton:"conversation/refreshButton",currentConvs:"conversation/currentConvs",currentFriendId:"conversation/currentFriendId",strangersMap:"nedb/strangersMap",currentWeChatId:"conversation/currentWeChatId"})),{},{conversMap:function(){var e={};return this.friends.forEach((function(t){e[t.FriendId]=t})),this.chatRooms.forEach((function(t){e[t.UserName]=t})),e},totalNum:function(){return"convs"===this.currentTab?this.currentConvs.length:"friends"===this.currentTab?this.friends.length:"rooms"===this.currentTab?this.chatRooms.length:0}}),watch:{currentWeChatId:function(){this.maxNumber=20}},created:function(){this.getFriendDetail=this._.throttle(this.getFriendDetail,2e3)},methods:{setTab:function(e){e!==this.currentTab&&(this.currentTab=e)},freshData:function(){var e=this;if(this.currentWeChatId){if(!this.refreshButton)return void this.$alert("正在获取数据，请稍后再试！","提示",{type:"info"});switch(this.$store.commit("conversation/SET_REFRESH_BUTTON",!1),this.currentTab){case"convs":this.$store.commit("conversation/DELETE_CONVERSATIONS_BY_ID",this.currentWeChatId),Object(d["C"])(this.currentWeChatId);break;case"friends":this.$store.dispatch("nedb/RemoveAllFriensByWechatId",this.currentWeChatId),Object(d["D"])(this.currentWeChatId);break;default:this.$store.dispatch("nedb/RemoveAllRoomByWechatId",this.currentWeChatId),Object(d["z"])(this.currentWeChatId);break}setTimeout((function(){e.$store.commit("conversation/SET_REFRESH_BUTTON",!0)}),3e3)}else this.$message({message:"请先选中微信",type:"warning"})},getFriendDetail:function(e){var t=e.UserName||e.FriendId;t.indexOf("chatroom")>0?Object(d["s"])(e.WeChatId,t):Object(d["t"])(e.WeChatId,t),this.$message.info("指令已经下发！")},setMessageRead:function(e){e.WeChatId&&(this.$store.commit("conversation/SET_CONV_READED",e),Object(d["F"])(e.WeChatId,e.UserName))},choseFriend:function(e,t){if(console.log(e),e.UnreadCnt&&e.UnreadCnt>0&&this.setMessageRead(e),"convs"===this.currentTab||t)if(e.ShowName||Object(d["C"])(e.WeChatId,e.UpdateTime,0),t){var i,n=Object(a["a"])(this.wechats);try{for(n.s();!(i=n.n()).done;){var s=i.value;if(s.WeChatId===e.WeChatId){this.$store.commit("conversation/SET_CURRENT_WECHAT",s);break}}}catch(l){n.e(l)}finally{n.f()}this.$store.commit("conversation/SET_CURRENT_FRIEND",e)}else{var o=this.conversMap[e.UserName],c=this.strangersMap[e.UserName];o?(o=Object(r["a"])(Object(r["a"])({},o),e),this.$store.commit("conversation/SET_CURRENT_FRIENDS",o)):c?(c=Object(r["a"])(Object(r["a"])({},c),e),this.$store.commit("conversation/SET_CURRENT_FRIENDS",c)):this.$store.commit("conversation/SET_CURRENT_FRIENDS",e)}else this.$store.commit("conversation/SET_CURRENT_FRIENDS",e)}}},g=m,C=(i("bd22"),i("2877")),b=Object(C["a"])(g,o,c,!1,null,"034a2242",null),v=b.exports,A=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"conversation-chats"},[i("div",{staticClass:"chats-title"},[i("span",{staticClass:"nick-name ellipsis",domProps:{textContent:e._s(e.currentFriend.ShowName||e.currentFriend.NickName||e.currentFriend.FriendNick)}}),e.currentFriend.MemberList?i("div",{staticClass:"members-number",domProps:{textContent:e._s("("+e.currentFriend.MemberList.length+")")}}):e._e(),e.currentFriend.Gender?i("div",{staticClass:"gender",domProps:{textContent:e._s(e.currentFriend.Gender)}}):e._e(),e.currentFriend.Province?i("div",{staticClass:"address",domProps:{textContent:e._s(e.currentFriend.Province)}}):e._e(),e.currentFriend.City?i("div",{staticClass:"address",domProps:{textContent:e._s(e.currentFriend.City)}}):e._e()]),i("div",{staticClass:"chats-content"},[i("ShowChats",{staticClass:"show-chats"}),i("div",{staticClass:"input-window"},[i("ToolsBar"),i("AnswerWindow")],1)],1)])},D=[],y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tool-bar can-not-select"},[n("div",{staticClass:"tool-start"},[n("el-popover",{attrs:{placement:"top-start",width:"400",trigger:"hover"}},[n("div",{staticClass:"scroll",staticStyle:{height:"210px","overflow-y":"scroll"}},[n("img",{staticClass:"qq-face",attrs:{src:"expression/qqface.png",usemap:"#qqMap"}}),n("map",{attrs:{name:"qqMap"}},e._l(105,(function(t,i){return n("area",{key:i,attrs:{shape:"rect",coords:i%15*25+", "+25*parseInt(i/15)+", "+25*(i%15+1)+", "+25*(parseInt(i/15)+1),title:e.qqFaceMap[i]||i},on:{click:function(t){return e.selectExpression(i)}}})})),0),n("img",{attrs:{src:"expression/emoji.png",usemap:"#emojiMap"}}),n("map",{attrs:{name:"emojiMap"}},e._l(177,(function(t,i){return n("area",{key:i,attrs:{shape:"rect",coords:i%15*25+", "+25*parseInt(i/15)+", "+25*(i%15+1)+", "+25*(parseInt(i/15)+1),title:e.qqFaceMap[105+i]},on:{click:function(t){return e.selectExpression(105+i)}}})})),0)]),n("div",{staticClass:"tool-icon",attrs:{slot:"reference",title:"表情"},slot:"reference"},[n("img",{attrs:{src:i("556a"),alt:"表情"}})])]),n("div",{staticClass:"tool-icon",attrs:{title:"发送文件"}},[e._m(0),n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"toolsFile",attrs:{id:"sendFiles",type:"file",accept:".txt, .doc, .xls, .ppt, .docx, .xlsx, .pptx, .rar, .zip, .exe, .text, .apk, .mp3, .jpg, .png, .gif, .jpeg, .mp4"},on:{change:function(t){return e.choseMedia("File")}}})]),n("div",{staticClass:"tool-icon",attrs:{title:"截图"},on:{click:e.shearScreen}},[n("img",{attrs:{src:i("365b"),alt:"文件"}})]),n("div",{staticClass:"tool-icon",attrs:{title:"发语音"}},[e._m(1),n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"toolsVoice",attrs:{id:"sendVoiceId",type:"file",accept:".amr, .mp3"},on:{change:function(t){return e.choseMedia("Voice")}}})]),n("div",{staticClass:"tool-icon",attrs:{title:"二维码"},on:{click:e.showQrCode}},[n("img",{attrs:{src:i("0759"),alt:"二维码"}})]),n("div",{staticClass:"tool-icon",attrs:{title:"发名片"},on:{click:e.showSendNameCard}},[n("img",{attrs:{src:i("440d"),alt:"名片"}})]),n("div",{staticClass:"tool-icon",attrs:{title:"发红包"},on:{click:function(t){e.redEnvelopeDialog=!0}}},[n("img",{attrs:{src:i("c663"),alt:"红包"}})]),n("div",{staticClass:"tool-icon",attrs:{title:"发小程序"},on:{click:e.showWeApp}},[n("img",{attrs:{src:i("6498"),alt:"小程序"}})]),n("div",{staticClass:"tool-icon",attrs:{title:"发链接"},on:{click:e.showLink}},[n("img",{attrs:{src:i("3d50"),alt:"链接"}})]),e.currentFriendId.indexOf("chatroom")>0?n("div",{staticClass:"tool-icon",attrs:{title:"群二维码"},on:{click:e.showChatRoomQrCode}},[n("img",{attrs:{src:i("0759"),alt:"群二维码"}})]):e._e(),n("div",{staticClass:"tool-icon",attrs:{title:"发Emoji"},on:{click:e.showEmoji}},[n("i",{staticClass:"fa fa-gitlab",attrs:{title:"emoji"}})])],1),n("div",{staticClass:"tool-end"},[n("div",{staticClass:"tool-icon",attrs:{title:"创建群"},on:{click:function(t){return e.createChatRoom()}}},[n("img",{attrs:{src:i("0c01"),alt:"建群"}})]),n("div",{staticClass:"tool-icon",attrs:{title:"朋友圈"},on:{click:function(t){return e.changeAsideRightPage("FriendCircle")}}},[n("img",{attrs:{src:i("e874"),alt:"朋友圈"}})])]),e.friendsDialogVisible?n("SlotFriends",{attrs:{dialogTilte:e.dialogTilte,action:e.action,dialogData:e.dialogData,currentFriend:e.currentFriend,friends:e.dialogData,friendsDialogVisible:e.friendsDialogVisible},on:{closeSlotFriends:function(t){e.friendsDialogVisible=!1}}}):e._e(),n("el-dialog",{staticClass:"qr-code-dialog",attrs:{"append-to-body":"",title:e.currentWechat.WeChatNick+"的二维码","show-close":!0,visible:e.qrCodeDialog},on:{"update:visible":function(t){e.qrCodeDialog=t}}},[n("el-image",{staticClass:"qr-code-img",attrs:{src:e.conversationQrCode["QrCodeUrl"],fit:"scale-down"}},[n("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[n("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"100px"}})])]),n("div",[e.conversationQrCode.ModifyTime?n("span",{domProps:{textContent:e._s(e.$options.filters.timeFilter(e.conversationQrCode["ModifyTime"]))}}):e._e(),n("i",{staticClass:"el-icon-refresh",staticStyle:{"margin-left":"5px",cursor:"pointer",color:"blue"},attrs:{title:"刷新"},on:{click:e.pullWeChatQrCodeTask}})]),n("el-button",{staticStyle:{width:"100px",padding:"5px",margin:"10px 10px 20px 10px"},attrs:{type:"primary",size:"small"},on:{click:e.sendQrCode}},[e._v(" 发送 ")])],1),n("el-dialog",{staticClass:"qr-code-dialog-room",attrs:{"append-to-body":"",title:e.currentFriend.NickName+"的二维码","show-close":!0,visible:e.chatRoomQrCodeDialog},on:{"update:visible":function(t){e.chatRoomQrCodeDialog=t}}},[n("el-image",{staticClass:"qr-code-img",attrs:{src:e.chatRoomQrCode["QrCodeUrl"],fit:"scale-down"}},[n("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[n("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"100px"}})])]),n("div",[e.chatRoomQrCode.ModifyTime?n("span",{domProps:{textContent:e._s(e.$options.filters.timeFilter(e.chatRoomQrCode["ModifyTime"]))}}):e._e(),n("i",{staticClass:"el-icon-refresh",staticStyle:{"margin-left":"5px",cursor:"pointer",color:"blue"},attrs:{title:"刷新"},on:{click:e.pullChatRoomQrCodeTask}})]),n("el-button",{staticStyle:{width:"100px",padding:"5px",margin:"10px 10px 20px 10px"},attrs:{type:"primary",size:"small"},on:{click:e.sendQrCodeRoom}},[e._v(" 发送 ")])],1),n("el-dialog",{staticClass:"red-envelope",attrs:{"append-to-body":"",title:"发红包",visible:e.redEnvelopeDialog,"before-close":e.resetRedForm},on:{"update:visible":function(t){e.redEnvelopeDialog=t}}},[n("el-form",{ref:"redEnvelope",attrs:{model:e.redForm,rules:e.redRules,"label-width":"64px"}},[n("el-form-item",{attrs:{label:"金额",prop:"money"}},[n("el-input",{staticStyle:{width:"145px"},attrs:{size:"small",clearable:"",placeholder:"输入金额"},model:{value:e.redForm.money,callback:function(t){e.$set(e.redForm,"money",t)},expression:"redForm.money"}}),e._v(" 分 ")],1),n("el-form-item",{attrs:{label:"留言",prop:"blessings"}},[n("el-input",{staticStyle:{width:"166px"},attrs:{type:"textarea",size:"small",autosize:{minRows:3,maxRows:3},maxlength:"24",placeholder:"输入留言（24字内）"},model:{value:e.redForm.blessings,callback:function(t){e.$set(e.redForm,"blessings",t)},expression:"redForm.blessings"}})],1),n("el-form-item",{attrs:{label:"密码",prop:"password"}},[n("el-input",{staticStyle:{width:"166px"},attrs:{size:"small",type:"password",autocomplete:"off","show-password":"",placeholder:"输入支付密码"},model:{value:e.redForm.password,callback:function(t){e.$set(e.redForm,"password",t)},expression:"redForm.password"}})],1)],1),n("div",{staticStyle:{"background-color":"#e96037",width:"92px",height:"32px",display:"flex","align-items":"center","justify-content":"center","border-radius":"3px",cursor:"pointer",margin:"0 auto"},on:{click:e.sendLuckyMoneyTask}},[n("img",{attrs:{src:i("9d09"),alt:"红包"}}),n("p",{staticStyle:{color:"#fff","font-size":"14px","margin-left":"5px"}},[e._v("发红包")])])],1),n("el-dialog",{staticClass:"we-app",attrs:{"append-to-body":"",title:"发送小程序",visible:e.wechatAppDialog},on:{"update:visible":function(t){e.wechatAppDialog=t}}},[e._l(e.weAppList,(function(t,i){return n("div",{key:i,staticClass:"we-app-item",class:{"we-app-item-checked":e.weApp2Send.id===t.id},on:{click:function(i){return e.choseWeApp(t)}}},[n("img",{staticClass:"we-app-img",attrs:{src:t.Icon,alt:""}}),n("p",{staticClass:"we-app-name ellipsis",domProps:{textContent:e._s(t.Source)}}),n("i",{staticClass:"el-icon-delete",on:{click:function(i){return e.deleteWeApp(t.id)}}})])})),n("span",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{staticStyle:{"background-color":"#fff",border:"solid #eeeeee 1px",color:"#999999"},attrs:{size:"medium"},on:{click:e.resetWeApp}},[e._v(" 取 消 ")]),n("el-button",{staticStyle:{"background-color":"#ff9f00",border:"solid #ff9f00 1px"},attrs:{size:"medium",type:"primary"},on:{click:function(t){return e.sendWeApp(e.weApp2Send)}}},[e._v(" 发 送 ")])],1)],2),n("el-dialog",{staticClass:"we-app",attrs:{"append-to-body":"",title:"发链接",visible:e.linkDialog},on:{"update:visible":function(t){e.linkDialog=t}}},[e._l(e.linkList,(function(t,i){return n("div",{key:i,staticClass:"we-app-item",class:{"we-app-item-checked":e.link2Send.Url===t.Url},attrs:{title:t.Title},on:{click:function(i){e.link2Send=t}}},[n("img",{staticClass:"we-app-img",attrs:{src:t.Thumb,alt:""}}),n("p",{staticClass:"we-app-name ellipsis",domProps:{textContent:e._s(t.Title)}}),n("i",{staticClass:"el-icon-delete",on:{click:function(i){return e.deleteLink(t.id)}}})])})),n("span",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{staticStyle:{"background-color":"#fff",border:"solid #eeeeee 1px",color:"#999999"},attrs:{size:"medium"},on:{click:e.resetLink}},[e._v(" 取 消 ")]),n("el-button",{staticStyle:{"background-color":"#ff9f00",border:"solid #ff9f00 1px"},attrs:{size:"medium",type:"primary"},on:{click:function(t){return e.sendLink(e.link2Send)}}},[e._v(" 发 送 ")])],1)],2),n("el-dialog",{staticClass:"we-app",attrs:{"append-to-body":"",title:"发Emoji",visible:e.emojiDialog},on:{"update:visible":function(t){e.emojiDialog=t}}},[e._l(e.emojiList,(function(t,i){return n("div",{key:i,staticClass:"we-app-item",class:{"we-app-item-checked":e.emoji2Send.cdnUrl===t.cdnUrl},on:{click:function(i){e.emoji2Send=t}}},[n("img",{staticClass:"we-app-img-emoji",attrs:{src:t.cdnUrl,alt:""}}),n("i",{staticClass:"el-icon-delete",on:{click:function(i){return e.deleteEmoji(t.id)}}})])})),n("span",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{staticStyle:{"background-color":"#fff",border:"solid #eeeeee 1px",color:"#999999"},attrs:{size:"medium"},on:{click:e.resetEmoji}},[e._v(" 取 消 ")]),n("el-button",{staticStyle:{"background-color":"#ff9f00",border:"solid #ff9f00 1px"},attrs:{size:"medium",type:"primary"},on:{click:function(t){return e.sendEmoji(e.emoji2Send)}}},[e._v(" 发 送 ")])],1)],2)],1)},k=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("label",{staticClass:"label",attrs:{for:"sendFiles"}},[n("img",{attrs:{src:i("ec12"),alt:"发文件"}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("label",{staticClass:"label",attrs:{for:"sendVoiceId"}},[n("img",{attrs:{src:i("2eac"),alt:"语音"}})])}],x=(i("b0c0"),i("a9e3"),i("8ba4"),i("ac1f"),i("f6d6"),i("5319"),i("2b0e")),I=new x["default"],w=I,T=i("0e5c"),F=i("decf"),S=i("3496"),E=i("3d6b"),_={components:{SlotFriends:E["a"]},data:function(){var e=this,t=function(t,i,n){if(!i)return n(new Error("金额不能为空"));i=Number(i),Number.isInteger(i)?i<0?n(new Error("必须大于0")):i>2e4?n(new Error("必须小于20000")):parseInt(i/e.redForm.number,10)<1?n(new Error("单个红包金额不可低于0.01元！")):n():n(new Error("请输入数字值"))},i=function(t,i,n){if(!i)return n(new Error("数量不能为空"));i=Number(i),Number.isInteger(i)?i<0?n(new Error("必须大于0")):i>2e4?n(new Error("必须小于100")):parseInt(e.redForm.money/i,10)<1?n(new Error("单个红包金额不可低于0.01元！")):n():n(new Error("请输入数字值"))};return{redEnvelopeDialog:!1,redForm:{money:1,number:1,blessings:"",password:""},redRules:{money:[{required:!0,message:"请输入红包金额1-20000分",trigger:"blur"},{validator:t,trigger:"blur"}],number:[{required:!0,message:"请输入红包个数",trigger:"blur"},{validator:i,trigger:"blur"}],blessings:[{required:!0,message:"请输入祝福语",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:6,message:"密码长度不对",trigger:"blur"}]},wechatAppDialog:!1,weAppList:[],weApp2Send:{},linkDialog:!1,linkList:[],link2Send:{},emojiDialog:!1,emojiList:[],emoji2Send:{},qrCodeDialog:!1,chatRoomQrCodeDialog:!1,ghDialog:!1,transferMoneyDialog:!1,action:0,dialogTilte:"添加群成员",dialogData:[],friendsDialogVisible:!1,remittanceForm:{money:1,password:"",memo:""}}},computed:Object(r["a"])(Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(l["d"])({currentMode:"currentMode"})),Object(l["d"])("nedb",{friends:"friends",conversationQrCode:"conversationQrCode",chatRoomQrCode:"chatRoomQrCode"})),Object(l["b"])({currentUser:"currentUser",content:"conversation/content",contentType:"conversation/contentType",currentWechat:"conversation/currentWechat",currentWeChatId:"conversation/currentWeChatId",currentFriend:"conversation/currentFriend",currentFriendId:"conversation/currentFriendId"})),{},{qqFaceMap:function(){return F["b"]||{}},currentQrCode:function(){return!!this.qrcodes[this.currentWechats.WeChatId]&&this.qrcodes[this.currentWechats.WeChatId]},currentChatRoomQrCode:function(){return!!this.chatRoomQrCodes[this.currentFriendId]&&this.chatRoomQrCodes[this.currentFriendId]}}),mounted:function(){var e=this;document.body.onpaste=function(t){var i=t.clipboardData||window.clipboardData,n=i.items;if(n&&n.length){var s=n[0].getAsFile();if(s){var a=new FormData;a.append("myfile",s,"image.png"),Object(T["a"])(a).then((function(t){e.$store.commit("conversation/SET_CONTENT",t.data.url),e.$store.commit("conversation/SET_CONTENT_TYPE","Picture")})).catch((function(){}))}}}},methods:{selectExpression:function(e){"Text"!==this.contentType&&this.$store.commit("conversation/SET_CONTENT","");var t=F["b"][e],i=[113,114,115,116,117,118,124,125];if(t){if(e<105||i.indexOf(e)>=0)t="["+F["b"][e]+"]";else{t="<"+t+">",t=F["a"][t];var n=parseInt(t,16);t=String.fromCodePoint(n)}var s=this.content+t;this.$store.commit("conversation/SET_CONTENT_TYPE","Text"),this.$store.commit("conversation/SET_CONTENT",s)}},choseMedia:function(e){var t=this,i=new FormData,n="",s="";if(n="Voice"===e?this.$refs.toolsVoice.files:this.$refs.toolsFile.files,n[0]){var a=n[0].size,r=n[0].name,o=n[0].name.replace(/.+\./,"").toLowerCase();if(a>104857600||a<=0)return void this.$message.warning("文件不能大于100M，文件不能是空文件");if("Voice"===e){if(s="Voice",["amr","mp3"].indexOf(o)<0)return void this.$message.warning("发送语音只能选择MP3或AMR文件")}else s="mp4"===o?"Video":["jpg","png","gif","jpeg"].indexOf(o)>=0?"Picture":"File";i.append("myfile",n[0]);var c=this.$loading({lock:!0,text:"文件上传中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});if("Voice"===e){"mp3"===o?i.append("isMp3ToAmr",!0):"amr"===o&&i.append("isAmrToMp3",!1);var l=new FormData;l.append("myfile",n[0]),"mp3"===o?l.append("isMp3ToAmr",!1):"amr"===o&&l.append("isAmrToMp3",!0),Object(T["a"])(l)}Object(T["a"])(i).then((function(i){var n=i.data.url;"File"===s&&(n=JSON.stringify({name:r,url:i.data.url,size:a,Source:"pc"})),t.$store.commit("conversation/SET_CONTENT",n),t.$store.commit("conversation/SET_CONTENT_TYPE",s),c.close(),"Voice"===e?t.$refs.toolsVoice.value="":t.$refs.toolsFile.value=""})).catch((function(){t.$message({message:"文件上传失败!",type:"error",duration:1e3}),c.close()}))}},sendLuckyMoneyTask:function(){var e=this;this.currentWeChatId?this.$refs["redEnvelope"].validate((function(t){if(!t)return!1;e.$confirm("即将发送红包?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={WeChatId:e.currentWeChatId,FriendId:e.currentFriendId,Money:e.redForm.money,Number:1,Passwd:e.redForm.password,Wish:e.redForm.blessings};e.$store.dispatch("websocket/SendLuckyMoneyTask",t),e.$message.success("任务已经下发！"),e.redEnvelopeDialog=!1,e.$refs["redEnvelope"].resetFields()})).catch((function(){}))})):this.$message.warning("请选选中微信！")},resetRedForm:function(e){this.$refs["redEnvelope"].resetFields(),e()},showWeApp:function(){var e=this;this.wechatAppDialog=!0,Object(S["s"])(this.currentUser.SupplierId,1,100,13).then((function(t){if(0===t.code&&t.data.rows){var i=[];t.data.rows.forEach((function(e){var t=JSON.parse(e.content);t.id=e.id,i.push(t)})),e.weAppList=i}else e.weAppList=[]}))},choseWeApp:function(e){this.weApp2Send=e},sendWeApp:function(e){this.weApp2Send.AppId?(Object(d["y"])(this.currentWeChatId,this.currentFriendId,"WeApp",JSON.stringify(e)),this.$message.success("任务已经下发！"),this.resetWeApp()):this.$alert("请先选中一个小程序！","提示",{type:"warning"})},resetWeApp:function(){this.weApp2Send={},this.wechatAppDialog=!1},deleteWeApp:function(e){var t=this;e&&Object(S["i"])(e).then((function(i){0===i.code&&(t.weAppList=t.weAppList.filter((function(t){return t.id!==e})))}))},deleteLink:function(e){var t=this;e&&Object(S["i"])(e).then((function(i){0===i.code&&(t.linkList=t.linkList.filter((function(t){return t.id!==e})))}))},deleteEmoji:function(e){var t=this;e&&Object(S["i"])(e).then((function(i){0===i.code&&(t.emojiList=t.emojiList.filter((function(t){return t.id!==e})))}))},showLink:function(){var e=this;this.linkDialog=!0,Object(S["s"])(this.currentUser.SupplierId,1,100,6).then((function(t){if(0===t.code&&t.data.rows){var i=[];t.data.rows.forEach((function(e){var t=JSON.parse(e.content);t.id=e.id,i.push(t)})),e.linkList=i}else e.linkList=[]}))},resetLink:function(){this.link2Send={},this.linkDialog=!1},sendLink:function(e){this.link2Send.Url?(Object(d["y"])(this.currentWeChatId,this.currentFriendId,"Link",JSON.stringify(e)),this.$message.success("任务已经下发！"),this.resetLink()):this.$alert("请先选中一个链接页面！","提示",{type:"warning"})},showEmoji:function(){var e=this;this.emojiDialog=!0,Object(S["s"])(this.currentUser.SupplierId,1,100,14).then((function(t){if(0===t.code&&t.data.rows){var i=[];t.data.rows.forEach((function(e){var t=JSON.parse(e.content);t.id=e.id,i.push(t)})),e.emojiList=i}else e.emojiList=[]}))},resetEmoji:function(){this.emoji2Send={},this.emojiDialog=!1},sendEmoji:function(e){Object(d["y"])(this.currentWeChatId,this.currentFriendId,"Emoji",JSON.stringify(e)),this.$message.success("任务已经下发！"),this.resetEmoji()},showQrCode:function(){this.currentWeChatId?(this.conversationQrCode.WeChatId!==this.currentWeChatId&&this.$store.dispatch("nedb/SetConversationQrCode",this.currentWeChatId),this.dialogTilte="微信二维码",this.qrCodeDialog=!0):this.$message.warning("请先选中微信！")},pullWeChatQrCodeTask:function(){this.$store.dispatch("websocket/PullWeChatQrCodeTask",this.currentWeChatId),this.$message.info("正在获取，请稍等")},sendQrCode:function(){this.$store.commit("conversation/SET_CONTENT_TYPE","Picture"),this.$store.commit("conversation/SET_CONTENT",this.conversationQrCode.QrCodeUrl)},sendQrCodeRoom:function(){this.$store.commit("conversation/SET_CONTENT_TYPE","Picture"),this.$store.commit("conversation/SET_CONTENT",this.chatRoomQrCode.QrCodeUrl)},showChatRoomQrCode:function(){var e=this;this.currentWeChatId?(this.chatRoomQrCode.ChatRoomId&&this.chatRoomQrCode.ChatRoomId===this.currentFriendId||this.$store.dispatch("nedb/SetChatRoomQrCode",this.currentFriend),this.dialogTilte="群聊二维码",setTimeout((function(){e.chatRoomQrCodeDialog=!0}),100)):this.$message.warning("请先选中微信！")},pullChatRoomQrCodeTask:function(){this.$store.dispatch("websocket/PullChatRoomQrCodeTask",this.currentFriend),this.$message.info("正在获取，请稍等")},changeAsideRightPage:function(e){this.currentFriendId?"FriendCircle"===e&&(this.currentFriendId.indexOf("chatroom")>0?this.$alert("群没有朋友圈!","提示",{type:"warning"}):w.$emit("toggleAsideRightPage",e)):this.$alert("请先选中一个好友!","提示",{type:"warning"})},showSendNameCard:function(){this.currentWeChatId?(this.dialogTilte="发送名片",this.action="NameCard",this.dialogData=this.friends,this.friendsDialogVisible=!0):this.$message.warning("请先选中微信！")},createChatRoom:function(){this.currentWeChatId?(this.dialogTilte="创建群聊",this.action=8,this.dialogData=this.friends,this.friendsDialogVisible=!0):this.$message.warning("请先选中微信！")},shearScreen:function(){"web"!==this.currentMode?"electron"===this.currentMode&&this.$ipcRenderer.send("operations","screencap"):this.$alert("网页版不支持截图功能！","提示",{type:"warning"})}}},O=_,N=(i("678c"),Object(C["a"])(O,y,k,!1,null,"345195ae",null)),M=N.exports,L=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"anwser-window"},[i("div",{staticClass:"scroll show-content"},["Text"===e.contentType?i("textarea",{ref:"anwserText",staticClass:"scroll show-content-textarea",attrs:{id:"textarea",maxlength:"1000",autofocus:""},domProps:{value:e.content},on:{input:e.setContent,keydown:function(t){return t.type.indexOf("key")||13===t.keyCode?t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.enterSend(t):null},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?t.shiftKey||t.altKey||t.metaKey?null:e.lineFeed(t):null}}}):"Picture"===e.contentType?i("img",{staticClass:"show-content-img",attrs:{src:e.content,alt:"图片丢失"}}):"Video"===e.contentType?i("video",{staticClass:"show-content-video",attrs:{src:e.content,controls:""}}):e._e(),"Voice"===e.contentType&&/.mp3$/.test(e.content)?i("audio",{staticClass:"show-content-voice",attrs:{src:e.content,type:"audio/mp3",controls:""}}):e._e(),"Voice"!==e.contentType||/.mp3$/.test(e.content)?"File"===e.contentType?i("span",{staticClass:"show-content-file",domProps:{textContent:e._s(e.$options.filters.getFileName(e.content))}}):e._e():i("span",{staticClass:"show-content-file",domProps:{textContent:e._s(e.content)}})]),i("div",{staticClass:"opration-btn"},[e.quoteMsg?i("div",{staticClass:"quote-msg"},[i("div",{staticClass:"quote-content"},[i("span",{domProps:{textContent:e._s(e.quoteDetail.displayName)}}),i("span",[e._v(":")]),i("span",{staticClass:"ellipsis",staticStyle:{width:"200px"},domProps:{textContent:e._s(e.quoteDetail.content)}})]),i("span",{staticClass:"close-btn",on:{click:e.cancelQuote}},[e._v("x")])]):i("div",[e._v("按ctrl + enter 换行")]),i("div",{staticClass:"right-btns"},[i("el-button",{staticStyle:{"background-color":"#fff",border:"solid #fff 1px",color:"black"},attrs:{size:"small"},on:{click:e.clearContent}},[e._v(" 清空 ")]),i("el-button",{staticStyle:{"background-color":"#ff9f00",border:"solid #ff9f00 1px"},attrs:{type:"primary",size:"small"},on:{click:e.talkToFriendTask}},[e._v(" 发送(Enter) ")])],1)])])},B=[],W={data:function(){return{}},computed:Object(r["a"])(Object(r["a"])({},Object(l["d"])("conversation",{quoteMsg:"quoteMsg",quoteDetail:"quoteDetail"})),Object(l["b"])({remark:"conversation/remark",content:"conversation/content",contentType:"conversation/contentType",currentWechat:"conversation/currentWechat",currentFriend:"conversation/currentFriend",currentWeChatId:"conversation/currentWeChatId",currentFriendId:"conversation/currentFriendId"})),created:function(){this.talkToFriendTask=this._.throttle(this.talkToFriendTask,500)},methods:{talkToFriendTask:function(){if(this.currentWeChatId)if("{}"!==JSON.stringify(this.currentFriend)){var e=this.content.replace(/\s/gi,"");e?(this.currentFriendId.indexOf("@chatroom")>0||this.currentFriendId.indexOf("@im.chatroom")>0)&&this.currentFriend.MemberList&&this.currentFriend.MemberList.indexOf(this.currentWeChatId)<0?this.$message({type:"warning",message:"你已被踢出群聊,不能在该群发送消息!",duration:1e3}):this.quoteMsg?"Text"===this.contentType?(Object(d["y"])(this.currentWeChatId,this.currentFriendId,"QuoteMsg",this.content,this.quoteMsg),this.clearContent(),this.cancelQuote()):this.$alert("引用消息只能是文本消息","提示",{type:"warning"}):(Object(d["y"])(this.currentWeChatId,this.currentFriendId,this.contentType,this.content,this.remark),this.clearContent()):this.$message.warning("请设置发送内容！")}else this.$message.warning("请先选择一个好友！");else this.$message.warning("请先选中微信！")},lineFeed:function(){var e=this.content+"\r\n";this.$store.commit("conversation/SET_CONTENT",e)},enterSend:function(e){e.preventDefault(),this.talkToFriendTask()},setContent:function(){var e=this.$refs.anwserText.value;this.$store.commit("conversation/SET_CONTENT",e)},clearContent:function(){this.$store.commit("conversation/SET_CONTENT",""),this.$store.commit("conversation/SET_CONTENT_TYPE","Text"),this.$store.commit("conversation/SET_REMARK","")},cancelQuote:function(){this.$store.commit("conversation/SET_QUOTE_MSG",""),this.$store.commit("conversation/SET_QUOTE_DETAIL",{})}}},U=W,R=(i("0100"),Object(C["a"])(U,L,B,!1,null,"94df11a4",null)),j=R.exports,P=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"show-chats scroll",attrs:{id:"show-chat"},on:{scroll:e.newPage}},[e._l(e.currentChats,(function(t,n){return i("div",{key:n,staticClass:"chat-item"},[i("div",{staticClass:"chat-time",domProps:{textContent:e._s(e.$options.filters.timeFilter(t.CreateTime))}}),i("div",{staticClass:"chat-content",class:{"chat-content-send":!!t.IsSend}},[-1===e.notShow.indexOf(t.ContentType)?i("el-avatar",{attrs:{shape:"square",size:40,src:e.getAvatar(t),title:"头像"},nativeOn:{click:function(i){return e.showMemberDetail(t)}}},[i("i",{staticClass:"fa fa-picture-o",attrs:{"aria-hidden":"true",title:"头像miss"}})]):e._e(),e.currentFriendId.indexOf("chatroom")>0&&!t.IsSend&&-1===e.notShow.indexOf(t.ContentType)?i("div",{staticClass:"member-info"},[i("span",{domProps:{textContent:e._s(e.getMemberName(t.Content))}}),i("el-button",{staticStyle:{"margin-left":"10px",color:"#909399",padding:"5px"},attrs:{type:"plant",size:"mini"},on:{click:function(i){return e.atSomebody(t)}}},[e._v(" @Ta ")]),e.currentFriend.Owner&&e.currentFriend.Owner===e.currentWeChatId?i("el-button",{staticStyle:{"margin-left":"10px",color:"#909399",padding:"5px"},attrs:{type:"plant",size:"mini",disabled:e.knicking,loading:e.knicking},on:{click:function(i){return e.knickSomeBody(t)}}},[e._v(" 踢人 ")]):e._e()],1):e._e(),i("div",{staticClass:"content-content",class:[{"triangle-send":t.IsSend&&-1===e.notShow.indexOf(t.ContentType)},{triangle:-1===e.notShow.indexOf(t.ContentType)&&!t.IsSend},{"chat-room":e.currentFriendId.indexOf("chatroom")>0&&!t.IsSend&&-1===e.notShow.indexOf(t.ContentType)},{"system-info":e.notShow.indexOf(t.ContentType)>-1}]},[i("div",{staticClass:"chat-text",class:[{"chat-picture":"Picture"===t.ContentType||2===t.ContentType},{"chat-voice":"Voice"===t.ContentType||3===t.ContentType},{"chat-video":"Video"===t.ContentType||4===t.ContentType},{"chat-link":"Link"===t.ContentType||6===t.ContentType},{"chat-file":"File"===t.ContentType||8===t.ContentType},{"chat-namecard":"NameCard"===t.ContentType||9===t.ContentType},{"chat-luckmoney":"LuckyMoney"===t.ContentType||11===t.ContentType},{"chat-moneytran":"MoneyTrans"===t.ContentType||12===t.ContentType},{"chat-app":"WeApp"===t.ContentType||13===t.ContentType},{"chat-system":e.notShow.indexOf(t.ContentType)>-1}],domProps:{innerHTML:e._s(e.decodeChat(t))},on:{click:function(i){return e.whatToDo(t)}}}),"System"===t.ContentType&&t.Content&&t.Content.includes("发送朋友验证")?i("span",{staticClass:"verify-text",on:{click:function(i){return e.verifyContact(t)}}},[e._v(" 发送朋友验证 ")]):e._e()]),i("div",{staticClass:"send-state",class:{"chat-room":e.currentFriendId.indexOf("chatroom")>0&&!t.IsSend&&-1===e.notShow.indexOf(t.ContentType)}},[t.IsSend&&-1===e.notShow.indexOf(t.ContentType)&&t.hasOwnProperty("LocalSend")?i("el-button",{staticClass:"el-icon-loading",attrs:{type:"text"}}):5===t.Status?i("i",{staticClass:"el-icon-warning",staticStyle:{color:"red","font-size":"20px"},attrs:{type:"text"}}):e._e(),"LuckyMoney"===t.ContentType?i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini"},on:{click:function(i){return e.takeLuckMoney(t)}}},[e._v(" 打开 ")]):e._e(),"LuckyMoney"===t.ContentType?i("el-button",{attrs:{size:"mini"},on:{click:function(i){return e.queryHbDetailTask(t)}}},[e._v(" 查看 ")]):e._e(),t.IsSend&&t.MsgSvrId&&e.revokeMap.indexOf(t.ContentType)>=0?i("el-button",{staticStyle:{"margin-left":"10px",color:"#909399",padding:"5px"},attrs:{type:"plant",size:"mini"},on:{click:function(i){return e.revokeMessageTask(t)}}},[e._v(" 撤回 ")]):e._e(),t.MsgSvrId&&e.transportType.indexOf(t.ContentType)>=0?i("el-button",{staticClass:"el-icon-s-promotion",staticStyle:{"margin-left":"10px",color:"#909399",padding:"5px"},attrs:{type:"plant",size:"mini"},on:{click:function(i){return e.canTransform(t)}}},[e._v(" 转发 ")]):e._e(),t.MsgSvrId&&e.quoteType.indexOf(t.ContentType)>=0?i("el-button",{staticClass:"el-icon-s-promotion",staticStyle:{"margin-left":"10px",color:"#909399",padding:"5px"},attrs:{type:"plant",size:"mini"},on:{click:function(i){return e.quoteMsg(t)}}},[e._v(" 引用 ")]):e._e(),t.MsgSvrId&&e.collectionType.includes(t.ContentType)?i("el-button",{staticClass:"el-icon-s-promotion",staticStyle:{"margin-left":"10px",color:"#909399",padding:"5px"},attrs:{type:"plant",size:"mini",title:"收藏之后可以发送好友"},on:{click:function(i){return e.collectionMsg(t)}}},[e._v(" 收藏 ")]):e._e(),!t.MsgSvrId||"Picture"!==t.ContentType&&"Text"!==t.ContentType?e._e():i("el-checkbox",{staticStyle:{"margin-left":"10px",color:"#909399",padding:"5px"},attrs:{checked:e.chatListMap.indexOf(t.MsgSvrId)>=0},on:{change:function(i){return e.setCircleContent(t)}}},[e._v(" 选为待发素材 ")])],1)],1)])})),i("div",{staticClass:"demo-image__preview big-img-box"},[i("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{id:"bigImageBox",src:e.bigImageUrl,"preview-src-list":[e.bigImageUrl]}})],1),i("el-dialog",{staticClass:"member-detail-dialog",attrs:{"close-on-click-modal":!1,title:"群成员详情","append-to-body":"",visible:e.memberDialog},on:{"update:visible":function(t){e.memberDialog=t}}},[i("div",{staticClass:"member-detail-info"},[i("el-avatar",{attrs:{shape:"square",size:100,src:e.memberDetail.Avatar}},[i("i",{staticClass:"fa fa-picture-o",attrs:{"aria-hidden":"true",title:"头像miss"}})]),i("div",{staticClass:"member-detail-text"},[i("p",[e._v(" 微信： "),i("span",{domProps:{textContent:e._s(e.memberDetail.FriendId)}})]),i("p",[e._v(" 昵称： "),i("span",{domProps:{textContent:e._s(e.memberDetail.FriendNick||"- -")}})]),i("p",[e._v(" 性别： "),i("span",{domProps:{textContent:e._s(e.memberDetail.Gender||"- -")}})]),i("p",[e._v(" 地址： "),i("span",{domProps:{textContent:e._s(e.memberDetail.Province||"-")}}),e._v(" "),i("span",{domProps:{textContent:e._s(e.memberDetail.City||"-")}})])])],1),i("div",{staticClass:"member-detail-btns"},[e.friendsMap[e.memberDetail.FriendId]?e._e():i("el-button",{staticStyle:{"background-color":"#ff9f00",color:"#ffffff",border:"none"},attrs:{size:"medium"},on:{click:e.getMemberDetail}},[e._v(" 获取详情 ")]),e.friendsMap[e.memberDetail.FriendId]?e._e():i("el-button",{staticStyle:{"background-color":"#ff9f00",color:"#ffffff",border:"none"},attrs:{size:"medium"},on:{click:e.addToAddress}},[e._v(" 添加到通讯录 ")])],1)]),i("el-dialog",{staticClass:"hb-detail",attrs:{title:"红包详情","append-to-body":"",visible:e.hbDetailVisible},on:{"update:visible":function(t){e.hbDetailVisible=t}}},[i("ul",[i("li",[e._v("当前微信："+e._s(e.hbDetail.WeChatId))]),i("li",[e._v("红包来源："+e._s(e._f("hbUrlFilter")(e.hbDetail.HbUrl)))]),i("li",[e._v("红包总数："+e._s(e.hbDetail.TotalNum))]),i("li",[e._v("红包总金额："+e._s(e.hbDetail.TotalAmount))]),i("li",[e._v("已抢的数量："+e._s(e.hbDetail.RecNum))]),i("li",[e._v("已抢的金额："+e._s(e.hbDetail.RecAmount))])]),e._v(" 抢红包的好友列表 "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.hbDetail.Records||[]}},[i("el-table-column",{attrs:{prop:"UserName",label:"微信id",width:"180"}}),i("el-table-column",{attrs:{prop:"UserName",label:"微信昵称",width:"180",formatter:e.userNameFormatter}}),i("el-table-column",{attrs:{prop:"Amount",label:"金额"}}),i("el-table-column",{attrs:{prop:"Time",label:"时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{domProps:{textContent:e._s(e.$options.filters.timeFilter(t.row.Time))}})]}}])})],1),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticStyle:{"background-color":"#fff",border:"solid #eeeeee 1px",color:"#999999"},attrs:{size:"medium"},on:{click:function(t){e.hbDetailVisible=!1}}},[e._v(" 取 消 ")])],1)],1),i("el-dialog",{staticClass:"transport-message-dialog",attrs:{"append-to-body":"",title:"转发消息",visible:e.transportMessageVisible,"close-on-click-modal":!1,"before-close":e.beforeCloseHandle},on:{"update:visible":function(t){e.transportMessageVisible=t}}},[i("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"转发好友",name:"friends"}},[i("div",{staticClass:"friends-list"},[i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.friendsPages[e.currentPage-1],stripe:"",border:"",height:"400px"},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{label:"昵称",prop:"FriendNick"}}),i("el-table-column",{attrs:{label:"头像",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e.row.Avatar}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"50px"}})])])]}}])}),i("el-table-column",{attrs:{label:"备注名",prop:"Memo"}}),i("el-table-column",{attrs:{type:"selection",width:"55"}})],1),i("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[50,100,150,200],"page-size":e.pageSize,"pager-count":7,layout:"total, sizes, prev, pager, next, jumper",total:e.totalFriendNum},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),i("el-tab-pane",{attrs:{label:"转发群聊",name:"chatrooms"}},[i("div",{staticClass:"friends-list"},[i("el-table",{ref:"multipleTable2",staticStyle:{width:"100%"},attrs:{data:e.chatRoomsPages[e.currentPage-1],stripe:"",border:"",height:"400px"},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{label:"昵称",prop:"NickName"}}),i("el-table-column",{attrs:{label:"头像",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e.row.Avatar}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"50px"}})])])]}}])}),i("el-table-column",{attrs:{label:"备注名",prop:"Memo"}}),i("el-table-column",{attrs:{type:"selection",width:"55"}})],1),i("el-pagination",{attrs:{"current-page":e.pageNo,"page-sizes":[50,100,150,200],"page-size":e.chatRoomPageSize,"pager-count":7,layout:"total, sizes, prev, pager, next, jumper",total:e.totalChatRoomNum},on:{"size-change":e.handleChatRoomSizeChange,"current-change":e.handleChatRoomCurrentChange}})],1)])],1),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.transportMessageVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.forwardMessage}},[e._v("转发消息")])],1)],1)],2)},$=[],z=(i("c740"),i("caad"),i("a15b"),i("4d63"),i("25f0"),i("8a79"),i("2532"),i("1276"),i("2ca0"),i("498a"),i("466d"),{"[微笑]":"0","[撇嘴]":"1","[色]":"2","[发呆]":"3","[得意]":"4","[流泪]":"5","[害羞]":"6","[闭嘴]":"7","[睡]":"8","[大哭]":"9","[尴尬]":"10","[发怒]":"11","[调皮]":"12","[呲牙]":"13","[惊讶]":"14","[难过]":"15","[酷]":"16","[冷汗]":"17","[囧]":"17","[抓狂]":"18","[吐]":"19","[偷笑]":"20","[可爱]":"20","[愉快]":"21","[白眼]":"22","[傲慢]":"23","[饥饿]":"24","[困]":"25","[惊恐]":"26","[流汗]":"27","[憨笑]":"28","[悠闲]":"29","[大兵]":"29","[奋斗]":"30","[咒骂]":"31","[疑问]":"32","[嘘]":"33","[晕]":"34","[疯了]":"35","[折磨]":"35","[衰]":"36","[骷髅]":"37","[敲打]":"38","[再见]":"39","[擦汗]":"40","[抠鼻]":"41","[鼓掌]":"42","[糗大了]":"43","[坏笑]":"44","[左哼哼]":"45","[右哼哼]":"46","[哈欠]":"47","[鄙视]":"48","[委屈]":"49","[快哭了]":"50","[阴险]":"51","[亲亲]":"52","[吓]":"53","[可怜]":"54","[菜刀]":"55","[西瓜]":"56","[啤酒]":"57","[篮球]":"58","[乒乓]":"59","[咖啡]":"60","[饭]":"61","[猪头]":"62","[玫瑰]":"63","[凋谢]":"64","[嘴唇]":"65","[示爱]":"65","[爱心]":"66","[心碎]":"67","[蛋糕]":"68","[闪电]":"69","[炸弹]":"70","[刀]":"71","[足球]":"72","[瓢虫]":"73","[便便]":"74","[月亮]":"75","[太阳]":"76","[礼物]":"77","[拥抱]":"78","[强]":"79","[弱]":"80","[握手]":"81","[胜利]":"82","[抱拳]":"83","[勾引]":"84","[拳头]":"85","[差劲]":"86","[爱你]":"87","[NO]":"88","[OK]":"89","[爱情]":"90","[飞吻]":"91","[跳跳]":"92","[发抖]":"93","[怄火]":"94","[转圈]":"95","[磕头]":"96","[回头]":"97","[跳绳]":"98","[投降]":"99","[激动]":"100","[乱舞]":"101","[献吻]":"102","[左太极]":"103","[右太极]":"104"}),Q={"[嘿哈]":"8","[捂脸]":"9","[奸笑]":"10","[机智]":"11","[皱眉]":"12","[耶]":"13","[鸡]":"20","[红包]":"19"},V={"\\ue415":"0","%uD83D%uDE04":"0","\\ue40C":"1","%uD83D%uDE37":"1","\\ue412":"2","%uD83D%uDE02":"2","\\ue409":"3","%uD83D%uDE1D":"3","\\ue40D":"4","%uD83D%uDE33":"4","\\ue107":"5","%uD83D%uDE31":"5","\\ue403":"6","%uD83D%uDE14":"6","\\ue40E":"7","%uD83D%uDE12":"7","\\ue11B":"14","%uD83D%uDC7B":"14","\\ue41D":"15","\\ue14C":"16","%uD83D%uDCAA":"16","\\ue312":"17","%uD83C%uDF89":"17","\\ue112":"18","%uD83C%uDF81":"18","%uD83D%uDE0A":"21","%uD83D%uDE03":"22","%u263A":"23","%uD83D%uDE09":"24","%uD83D%uDE0D":"25","%uD83D%uDE18":"26","%uD83D%uDE1A":"27","%uD83D%uDE01":"28","%uD83D%uDE0C":"29","%uD83D%uDE1C":"30","%uD83D%uDE0F":"31","%uD83D%uDE13":"32","%uD83D%uDE1E":"33","%uD83D%uDE16":"34","%uD83D%uDE25":"35","%uD83D%uDE30":"36","%uD83D%uDE28":"37","%uD83D%uDE2B":"38","%uD83D%uDE23":"38","%uD83D%uDE22":"39","%uD83D%uDE2D":"40","%uD83D%uDE32":"41","%uD83D%uDE35":"41","%uD83D%uDE20":"42","%uD83D%uDE21":"43","%uD83D%uDE2A":"44","%uD83D%uDC7F":"45","%uD83D%uDC7D":"46","%u2764":"47","%uD83D%uDC94":"48","%uD83D%uDC98":"49","%u2728":"50","%uD83C%uDF1F":"51","\\ue021":"52","%u2755":"52","%u2754":"53","%uD83D%uDCA4":"54","%uD83D%uDCA6":"55","%uD83C%uDFB5":"56","%uD83D%uDD25":"57","%uD83D%uDCA9":"58","%uD83D%uDC4D":"59","%uD83D%uDC4E":"60","%uD83D%uDC4A":"61","%u270C":"62","%uD83D%uDC46":"63","%uD83D%uDC47":"64","%uD83D%uDC49":"65","%uD83D%uDC48":"66","%u261D":"67","%uD83D%uDC8F":"68","%uD83D%uDC91":"69","%uD83D%uDC66":"70","%uD83D%uDC67":"71","%uD83D%uDC69":"72","%uD83D%uDC68":"73","%uD83D%uDC7C":"74","%uD83D%uDC80":"75","%uD83D%uDC8B":"76","%u2600":"77","%u2614":"78","%u2601":"79","%u26C4":"80","%uD83C%uDF19":"81","%u26A1":"82","%uD83C%uDF0A":"83","%uD83D%uDC31":"84","%uD83D%uDC36":"85","%uD83D%uDC2D":"86","%uD83D%uDC39":"87","%uD83D%uDC30":"88","%uD83D%uDC3A":"89","%uD83D%uDC38":"90","%uD83D%uDC2F":"91","%uD83D%uDC28":"92","%uD83D%uDC3B":"93","%uD83D%uDC37":"94","%uD83D%uDC2E":"95","%uD83D%uDC17":"96","%uD83D%uDC35":"97","%uD83D%uDC34":"98","%uD83D%uDC0D":"99","%uD83D%uDC26":"100","%uD83D%uDC14":"101","%uD83D%uDC27":"102","%uD83D%uDC1B":"103","%uD83D%uDC19":"104","%uD83D%uDC20":"105","%uD83D%uDC33":"106","%uD83D%uDC2C":"107","%uD83C%uDF39":"108","%uD83C%uDF3A":"109","%uD83C%uDF34":"110","%uD83C%uDF35":"111","%uD83D%uDC9D":"112","%uD83C%uDF83":"113","%uD83C%uDF85":"114","%uD83C%uDF84":"115","%uD83D%uDD14":"116","%uD83C%uDF88":"117","%uD83D%uDCBF":"118","%uD83D%uDCF7":"119","%uD83C%uDFA5":"120","%uD83D%uDCBB":"121","%uD83D%uDCFA":"122","%u260E":"123","%uD83D%uDD13":"124","%uD83D%uDD12":"125","%uD83D%uDD11":"126","%uD83D%uDD28":"127","%uD83D%uDCA1":"128","%uD83D%uDCEB":"129","%uD83D%uDEC0":"130","%uD83D%uDCB0":"131","%uD83D%uDCA3":"132","%uD83D%uDD2B":"133","%uD83D%uDC8A":"134","%uD83C%uDFC8":"135","%uD83C%uDFC0":"136","%u26BD":"137","%u26BE":"138","%u26F3":"139","%uD83C%uDFC6":"140","%uD83D%uDC7E":"141","%uD83C%uDFA4":"142","%uD83C%uDFB8":"143","%uD83D%uDC59":"144","%uD83D%uDC51":"145","%uD83C%uDF02":"146","%uD83D%uDC5C":"147","%uD83D%uDC84":"148","%uD83D%uDC8D":"149","%uD83D%uDC8E":"150","%u2615":"151","%uD83C%uDF7A":"152","%uD83C%uDF7B":"153","%uD83C%uDF78":"154","%uD83C%uDF54":"155","%uD83C%uDF5F":"156","%uD83C%uDF5D":"157","%uD83C%uDF63":"158","%uD83C%uDF5C":"159","%uD83C%uDF73":"160","%uD83C%uDF66":"161","%uD83C%uDF82":"162","%uD83C%uDF4E":"163","%u2708":"164","%uD83D%uDE80":"165","%uD83D%uDEB2":"166","%uD83D%uDE84":"167","%u26A0":"168","%uD83C%uDFC1":"169","%uD83D%uDEB9":"170","%uD83D%uDEBA":"171","%u2B55":"172","%u274C":"173","%A9":"174","%AE":"175","%u2122":"176"},q=/%uD83D%uDE32|%uD83D%uDE22|%uD83D%uDE16|%u2122|%AE|%A9|%u274C|%u2B55|%uD83D%uDEBA|%uD83D%uDEB9|%uD83C%uDFC1|%u26A0|%uD83D%uDE84|%uD83D%uDEB2|%uD83D%uDE80|%u2708|%uD83C%uDF4E|%uD83C%uDF82|%uD83C%uDF66|%uD83C%uDF73|%uD83C%uDF5C|%uD83C%uDF63|%uD83C%uDF5D|%uD83C%uDF5F|%uD83C%uDF54|%uD83C%uDF78|%uD83C%uDF7B|%uD83C%uDF7A|%u2615|%uD83D%uDC8E|%uD83D%uDC8D|%uD83D%uDC84|%uD83D%uDC5C|%uD83C%uDF02|%uD83D%uDC51|%uD83D%uDC59|%uD83C%uDFB8|%uD83C%uDFA4|%uD83D%uDC7E|%uD83C%uDFC6|%u26F3|%u26BE|%u26BD|%uD83C%uDFC0|%uD83C%uDFC8|%uD83D%uDC8A|%uD83D%uDD2B|%uD83D%uDCA3|%uD83D%uDCB0|%uD83D%uDEC0|%uD83D%uDCEB|%uD83D%uDCA1|%uD83D%uDD28|%uD83D%uDD11|%uD83D%uDD12|%uD83D%uDD13|%u260E|%uD83D%uDCFA|%uD83D%uDCBB|%uD83C%uDFA5|%uD83D%uDCF7|%uD83D%uDCBF|%uD83C%uDF88|%uD83C%uDF89|%uD83D%uDD14|%uD83C%uDF81|%uD83C%uDF84|%uD83C%uDF85|%uD83D%uDC7B|%uD83C%uDF83|%uD83D%uDC9D|%uD83C%uDF35|%uD83C%uDF34|%uD83C%uDF3A|%uD83C%uDF39|%uD83D%uDC2C|%uD83D%uDC33|%uD83D%uDC20|%uD83D%uDC19|%uD83D%uDC1B|%uD83D%uDC27|%uD83D%uDC14|%uD83D%uDC26|%uD83D%uDC0D|%uD83D%uDC34|%uD83D%uDC35|%uD83D%uDC17|%uD83D%uDC2E|%uD83D%uDC37|%uD83D%uDC3B|%uD83D%uDC28|%uD83D%uDC2F|%uD83D%uDC38|%uD83D%uDC3A|%uD83D%uDC30|%uD83D%uDC39|%uD83D%uDC2D|%uD83D%uDC36|%uD83D%uDC31|%uD83C%uDF0A|%u26A1|%uD83C%uDF19|%u26C4|%u2601|%u2614|%u2600|%uD83D%uDC8B|%uD83D%uDC80|%uD83D%uDC7C|%uD83D%uDC68|%uD83D%uDC69|%uD83D%uDC67|%uD83D%uDC66|%uD83D%uDC91|%uD83D%uDC8F|%uD83D%uDCAA|%u261D|%uD83D%uDC48|%uD83D%uDC47|%uD83D%uDC49|%uD83D%uDC46|%u270C|%uD83D%uDC4A|%uD83D%uDC4E|%uD83D%uDC4D|%uD83D%uDCA9|%uD83D%uDD25|%uD83C%uDFB5|%uD83D%uDCA6|%uD83D%uDCA4|%u2754|%u2755|%uD83C%uDF1F|%u2728|%uD83D%uDC98|%u2764|%uD83D%uDC94|%uD83D%uDC7D|%uD83D%uDC7F|%uD83D%uDE37|%uD83D%uDE2A|%uD83D%uDE21|%uD83D%uDE20|%uD83D%uDE31|%uD83D%uDE35|%uD83D%uDE02|%uD83D%uDE2D|%uD83D%uDE23|%uD83D%uDE28|%uD83D%uDE30|%uD83D%uDE25|%uD83D%uDE2B|%uD83D%uDE14|%uD83D%uDE13|%uD83D%uDE0F|%uD83D%uDE12|%uD83D%uDE1E|%uD83D%uDE1D|%uD83D%uDE1C|%uD83D%uDE0C|%uD83D%uDE01|%uD83D%uDE04|%uD83D%uDE0A|%uD83D%uDE03|%u263A|%uD83D%uDE09|%uD83D%uDE0D|%uD83D%uDE18|%uD83D%uDE1A|%uD83D%uDE33/gi,J={"0%u20E3":"1","1%u20E3":"2","2%u20E3":"3","3%u20E3":"4","4%u20E3":"5","5%u20E3":"6","6%u20E3":"7","7%u20E3":"8","8%u20E3":"9","\\ue303":"96","\\ue110":"102","%uD83C%uDF40":"102","9%u20E3":"10"},Y=/%uD83C%uDF40|[0-9]%u20E3|\\ue110|\\ue303/gi;function K(e){var t=/\[[\u4e00-\u9fa5]{1,3}\]|\[\w{1,3}\]/gi,i=e?e.match(t):e;if(i){var n,s=Object(a["a"])(i);try{for(s.s();!(n=s.n()).done;){var r=n.value;if(z[r]){var o="qq-face-map qq-face-map-"+z[r];e=e.replace(r,'<div class="'+o+'"></div>')}else if(Q[r]){var c="emoji-map emoji-"+Q[r];e=e.replace(r,'<div class="'+c+'"></div>')}}}catch(T){s.e(T)}finally{s.f()}}var l=/\\uE[\w]{3}/gi,d=/%ue|%uE/g,u=/%0A/g;e=escape(e).replace(d,"\\ue"),e=e.replace(u,"<br/>");var h=e.match(l);if(h){var f,p=Object(a["a"])(h);try{for(p.s();!(f=p.n()).done;){var m=f.value;if(V[m]){var g="emoji-map emoji-"+V[m];e=e.replace(m,'<div class="'+g+'"></div>')}}}catch(T){p.e(T)}finally{p.f()}}var C=e.match(q);if(C){var b,v=Object(a["a"])(C);try{for(v.s();!(b=v.n()).done;){var A=b.value;if(V[A]){var D="emoji-map emoji-"+V[A];e=e.replace(A,'<div class="'+D+'"></div>')}}}catch(T){v.e(T)}finally{v.f()}}var y=e.match(Y);if(y){var k,x=Object(a["a"])(y);try{for(x.s();!(k=x.n()).done;){var I=k.value;if(J[I]){var w="emojis-map emojis-"+J[I];e=e.replace(I,'<div class="'+w+'"></div>')}}}catch(T){x.e(T)}finally{x.f()}}return e=unescape(e),e}var H={qqFaceImgMap:K},G=i("f067"),X=i("decc"),Z={data:function(){return{size:10,notShow:["System","Sys_LuckyMoney","RoomSystem","PaiYiPai",5,16,17,26],revokeMap:["Text","NameCard","Picture","Voice","Video","File","Link","WeApp","Emoji","QuoteMsg"],detailDialogVisible:!1,knicking:!1,memberDialog:!1,memberDetail:{},hb2detail:{},bigImageUrl:"https://cube.elemecdn.com/9/c2/f0ee8a3c7c9638a54940382568c9dpng.png",transportMessageVisible:!1,activeName:"friends",currentPage:1,pageSize:50,pageNo:1,chatRoomPageSize:50,chat2Transport:{},multipleSelection:[],transportType:[1,2,4,6,8,13,"Text","Picture","Video","Link","WeApp","File"],quoteType:[1,2,4,"Text","Picture","Video"],collectionType:[6,13,14,24,"Link","WeApp","Emoji","ShiPinHao"],chatChose:{},lastSt:-1,lastFetchTime:0}},computed:Object(r["a"])(Object(r["a"])(Object(r["a"])({},Object(l["d"])("nedb",{friends:"friends",chatRooms:"chatRooms",strangers:"strangers",currentMode:"currentMode"})),Object(l["b"])({currentUser:"currentUser",friendsPages:"nedb/friendsPages",luckMoneyMap:"nedb/luckMoneyMap",chatRoomsPages:"nedb/chatRoomsPages",friendsMap:"nedb/friendsMap",strangersMap:"nedb/strangersMap",hbDetail:"conversation/hbDetail",atContent:"conversation/content",currentChats:"conversation/currentChats",currentWechat:"conversation/currentWechat",currentFriend:"conversation/currentFriend",currentFriendId:"conversation/currentFriendId",currentWeChatId:"conversation/currentWeChatId",bigImageMap:"conversation/bigImageMap",chatListMap:"circleManager/chatListMap"})),{},{totalFriendNum:function(){return this.friends.length},totalChatRoomNum:function(){return this.chatRooms.length},chatslength:function(){return this.currentChats.length},hbDetailVisible:{get:function(){return this.$store.getters["conversation/hbDetailVisible"]},set:function(e){this.$store.commit("conversation/SET_HB_DETAIL_VISIBLE",e),e||(this.$store.commit("conversation/SET_HB_DETAIL",{WeChatId:"",Success:!1,ErrMsg:"",HbUrl:"",TotalNum:null,TotalAmount:null,RecNum:null,Records:[],RecAmount:null}),this.hb2detail={})}}}),watch:{currentWeChatId:function(e){this.$store.commit("conversation/RESET_CURRENT_CHATS"),this.lastSt=-1,this.lastFetchTime=0,e&&this.currentFriendId&&Object(d["E"])(e,this.currentFriendId,0,0,10)},currentFriendId:function(e){this.$store.commit("conversation/RESET_CURRENT_CHATS"),this.lastSt=-1,this.lastFetchTime=0,e&&this.currentWeChatId&&Object(d["E"])(this.currentWeChatId,e,0,0,10)},chatslength:function(e){e>0&&this.$nextTick((function(){(-1===this.lastSt||this.lastSt>20)&&this.setBottom()}))}},methods:{setBottom:function(){var e=document.getElementById("show-chat");if(e){var t=document.getElementById("show-chat").scrollHeight,i=document.getElementById("show-chat").clientHeight;document.getElementById("show-chat").scrollTop=t-i}},newPage:function(){var e=document.getElementById("show-chat").scrollTop,t=document.getElementById("show-chat").scrollHeight,i=document.getElementById("show-chat").clientHeight;if(this.lastSt=e,0===e&&t>i){var n=this.currentChats[0]?this.currentChats[0].CreateTime:0;n===this.lastFetchTime&&(this.lastFetchTime=n),Object(d["E"])(this.currentWeChatId,this.currentFriendId,0,n,10)}},getAvatar:function(e){if(e.IsSend)return this.currentWechat.Avatar||"";if(e.FriendId&&e.FriendId.indexOf("chatroom")>0){var t=e.Content.split(":")[0];return this.friendsMap[t]?this.friendsMap[t].Avatar:this.strangersMap[t]?this.strangersMap[t].Avatar:""}return this.currentFriend.Avatar},userNameFormatter:function(e){var t=e.UserName;return this.friendsMap[t]?this.friendsMap[t].FriendNick:this.strangersMap[t]?this.strangersMap[t].FriendNick:"本地数据库没有该好友的信息"},getMemberName:function(e){var t=e.split(":")[0],i=t;return this.friendsMap[t]?i=this.friendsMap[t].FriendNick:this.strangersMap[t]&&(i=this.strangersMap[t].Nickname),i},showMemberDetail:function(e){if(!(this.currentFriendId.indexOf("chatroom")<0)&&this.currentFriendId){var t=e.Content.split(":")[0];this.friendsMap[t]?(this.memberDetail=this.friendsMap[t],this.memberDialog=!0):this.strangersMap[t]?(this.memberDetail={WeChatId:this.currentWeChatId,FriendId:t,Avatar:this.strangersMap[t].Avatar?this.strangersMap[t].Avatar:"",FriendNick:this.strangersMap[t].Nickname?this.strangersMap[t].Nickname:"",LabelIds:""},this.memberDialog=!0):(this.memberDetail={WeChatId:this.currentWeChatId,FriendId:t,Avatar:"",FriendNick:"",LabelIds:""},this.getMemberDetail())}},addToAddress:function(){var e={WeChatId:this.memberDetail.WeChatId,ChatroomId:this.currentFriendId,FriendId:this.memberDetail.FriendId,Message:"",Remark:""};this.$store.dispatch("websocket/AddFriendInChatRoomTask",e),this.memberDialog=!1,this.$message.info("指令已经下发！")},getMemberDetail:function(){Object(d["t"])(this.memberDetail.WeChatId,this.memberDetail.FriendId),this.memberDialog=!1,this.$message.info("指令已经下发！")},decodeChat:function(e){try{var t=e.Content,i=new RegExp(/^{.+}$/),n={},s="",a="",r="";switch(e.FriendId&&e.FriendId.indexOf("chatroom")>0&&!i.test(t)&&(t.startsWith("http")||(t=t.replace(/\S+?:/,"").replace(/^\n+|\n+$/g,""))),"string"===typeof t&&i.test(t)&&(n=JSON.parse(t)),e.ContentType){case"Text":case 1:return H.qqFaceImgMap(t);case"Picture":case 2:return n.Thumb&&n.Thumb.startsWith("http")?'<img class="chat-img" src="'.concat(n.Thumb,'" title="点击看大图" alt="图片"/>'):e.Url?'<img class="chat-img" src="'.concat(e.Url,'" title="点击看大图" alt="图片"/>'):n.Thumb||""===n.Thumb?'<img class="chat-img" src="'.concat(G,'" title="点击看大图" alt="图片"/>'):'<img class="chat-img" src="'.concat(t,'" title="点击看大图" alt="图片"/>');case"Voice":case 3:return e.Url||this.bigImageMap[e.MsgId]?' <audio src="'.concat(e.Url||this.bigImageMap[e.MsgId],'" alt="语音" controls></audio>'):(s=t.includes(".amr?")?t.replace(/.amr/,".mp3"):t,s.startsWith("http://")?' <audio src="'.concat(s,'" alt="语音" controls></audio>'):e);case"Video":case 4:return a=e.Url||this.bigImageMap[e.MsgId]?'<video class="video-box" src="'.concat(e.Url||this.bigImageMap[e.MsgId],'" type="video/mp4" alt="视频" controls></video>'):n.Thumb&&n.Thumb.startsWith("http")?'<img class="video-box-no" src="'.concat(n.Thumb,'"  alt="视频" />\n                 <i class="fa fa-play-circle-o fa-2x play-video" aria-hidden="true" title="点击播放"></i>'):n.Thumb||""===n.Thumb?'<img class="video-box-no" src="'.concat(G,'"  alt="视频" />\n                 <i class="fa fa-play-circle-o fa-2x play-video" aria-hidden="true" title="点击播放"></i>'):'<video class="video-box" src="'.concat(t,'" type="video/mp4" alt="视频"></video>'),a;case"System":case 5:return t.includes("发送朋友验证")?(t=t.replace(/。<.*/,"。"),"<p>".concat(t,"</p>")):t;case"Link":case 6:if("string"===typeof t&&i.test(t)){switch(n=JSON.parse(t),n.TypeStr){case"[聊天记录]":a='\n                        <span class="link-title">'.concat(n.Title,'</span>\n                        <div class="link-content">\n                         <span class="link-des">').concat(n.Des,'...</span>\n                        </div>\n                        <div class="link-type">').concat(n.TypeStr,"</div>\n                        ");break;default:a='\n                        <span class="link-title">'.concat(n.Title,'</span>\n                        <div class="link-content">\n                         <span class="link-des">').concat(n.Des,'</span>\n                          <img class="link-img" src="').concat(n.Thumb,'" alt="链接图片" />\n                        </div>\n                        <div class="link-type">').concat(n.TypeStr,"</div>\n                        ");break}return a}return t;case"LinkExt":case 7:return"LinkExt消息：".concat(t);case"File":case 8:if("{}"!==JSON.stringify(n)){var o=0,c="";n.size&&(o=n.size<1024?n.size+"B":n.size<1048576?parseInt(n.size/1024,10)+"KB":parseInt(n.size/1048576,10)+"MB"),n.Des&&(o=n.Des.replace(/,.*/,""),c=n.Des.replace(/.*,/,"").trim());var l=o||"",d=n.Title||n.name||"",u=c||n.name||"",h=n.Source||"手机",f="fa-question-circle-o";switch(u){case"doc":case"docx":f="fa-file-word-o";break;case"xls":case"xlsx":f="fa-file-excel-o";break;case"ppt":case"pptx":f="fa-file-powerpoint-o";break;case"zip":case"rar":f="fa-file-archive-o";break;case"text":case"txt":f="fa-file-text-o";break;case"mp3":f="fa-file-sound-o";break;default:f="fa-question-circle-o";break}return a='\n                  <span class="file-title">'.concat(d,'</span>\n                  <div class="file-content">\n                    <span class="file-des">').concat(l,'</span>\n                    <i class="fa ').concat(f,' file-icon" aria-hidden="true"></i>\n                  </div>\n                  <div class="file-type">').concat(h,"</div>\n                "),a}return t;case"NameCard":case 9:return n.Nickname?(s=n.HeadImg?n.HeadImg:"",r=n.Nickname):(s=this.friendsMap[t]?this.friendsMap[t].Avatar:"",r=this.friendsMap[t]?this.friendsMap[t].FriendNick:""),a='\n                    <div class="namecard-info">\n                      <img class="namecard-img" src="'.concat(s,'" alt="好友头像" />\n                      <span class="namecard-nickname ellipsis2">').concat(r,'</span>\n                    </div>\n                    <div class="namecard-tip">个人名片</div>\n                  '),a;case"Location":case 10:return"位置消息：".concat(t);case"LuckyMoney":case 11:return n.Key?'\n                  <div class="luck-info">\n                    <span class="luck-img" > &nbsp;&nbsp;🧧 </span>\n                    <span class="luck-wish ellipsis2" >'.concat(n.Title||"恭喜发财，大吉大利",'</span>\n                    <span class="luck-flag ellipsis2" ></span>\n                  </div>\n                  <div class="luckmoney-tip">微信红包</div>\n                  '):n;case"MoneyTrans":case 12:var p="";switch(n.PaySubType){case 1:p=e.IsSend?"转账给".concat(this.currentFriend.FriendNick):"转账给你";break;case 3:p="已收钱";break;default:break}if(3===n.PaySubType)a='\n                        <div class="moneytran-info">\n                            <img class="moneytran-img" src="'.concat(X,'" alt />\n                            <span class="moneytran-feed" >').concat(n.Feedesc||0,'</span>\n                            <span class="moneytran-flag">').concat(p,'</span>\n                            <span class="moneytran-flag"></span>\n                        </div>\n                        <div class="moneytran-tip">微信转账</div>\n                    ');else{var m=this.luckMoneyMap[e.MsgSvrId]?"已被领取":"";a='\n                        <div class="moneytran-info">\n                            <img class="moneytran-img" src="'.concat(X,'" alt />\n                            <span class="moneytran-feed" >').concat(n.Feedesc||0,'</span>\n                            <span class="moneytran-flag">').concat(p,'</span>\n                            <span class="moneytran-flag">').concat(m,'</span>\n                        </div>\n                        <div class="moneytran-tip">微信转账</div>\n                  ')}return a;case"WeApp":case 13:var g=G,C="无效小程序",b="无效小程序",v="",A="小程序";return"string"===typeof t&&i.test(t)&&(n=JSON.parse(t),g=n.Icon&&"undefined"!==typeof n.Icon?n.Icon:G,C=n.Source,b=n.Title||n.Des,v=n.Thumb,A=n.TypeStr?n.TypeStr:"小程序"),a='\n                  <div class="app-des">\n                  <img class="app-icon" src="'.concat(g,'" alt="icon" />\n                  <span class="app-source ellipsis">').concat(C,'</span>\n                  </div>\n                  <div class="app-title ellipsis">').concat(b,'</div>\n                  <img class="app-img" src="').concat(v,'" />\n                  <div class="app-typestr">').concat(A,"</div>\n                   "),a;case"Emoji":case 14:var D={"jsb_j.png":"http://emoji.qpic.cn/wx_emoji/abG5b87mcOW7YxBZFZPZOBXUjE99n48g6Znn6zaUiaVRtxMBYaEEKoA/","jsb_s.png":"http://emoji.qpic.cn/wx_emoji/ARQOAfC52Cu6iczyCvLhibUNQxCialTeaeObDoEMsL7uJjyV5dqzCNCFQ/","jsb_b.png":"http://emoji.qpic.cn/wx_emoji/Ty7jp6YeVib7MibicS8eb9buorVCg7mYTFXxuEpVDyQMaqK6PUoOcGxbQ/","dice_1.png":"http://emoji.qpic.cn/wx_emoji/QsDXJwBwXEXGFwLHJCm6haBlFls30vzPQcZTib9dyhLiazKxoPX6kp0A/","dice_2.png":"http://emoji.qpic.cn/wx_emoji/YbCHM38dRYCIWbKmiaBrdnPrfuuwicLD2iacSWaPoAiaFrUySG87ELibOXQ/","dice_3.png":"http://emoji.qpic.cn/wx_emoji/lgVbvPFtzP8ytMiaKZMUoV3BXNPRfUaP69vozHfNarmX3MlTrgOhrkA/","dice_4.png":"http://emoji.qpic.cn/wx_emoji/zaBCJf5hVDn8NlibdrxV4NoPc12d28S7s67UCJqwynRmB0spdttIbeQ/","dice_5.png":"http://emoji.qpic.cn/wx_emoji/72IJJTdBzuibcxvnpFVicUAzCWRJC3cKhtkpMHTFejC2cyOeEGSHibTKw/","dice_6.png":"http://emoji.qpic.cn/wx_emoji/Jowow1icuI3XqtkFeQgIuzjIEYHdtJZictGFJjTsAFwW1g6cx1uTaQfw/"};return s=n.Thumb||n.cdnUrl,s?D[s]?'<img class="chat-img" src="'.concat(D[s],'" title="点击看大图" alt="图片"/>'):'<img class="chat-img" src="'.concat(s,'" title="点击看大图" alt="图片"/>'):t;case"RoomManage":case 15:return"RoomManage";case"Sys_LuckyMoney":case 16:return JSON.parse(e.Content).Title;case"RoomSystem":case 17:return n.title?n.title:t;case"NotifyMsg":case 21:return n.title?'\n                      <span class="link-title">'.concat(n.source,'</span>\n                      <div class="link-content">\n                       <span class="link-des">').concat(n.title,'...</span>\n                      </div>\n                      <div class="link-type">').concat(n.des,"</div>\n                      "):t;case"BizLink":return t;case 22:case"QuoteMsg":return n.title?n.displayName?(a=H.qqFaceImgMap(n.title)+'<div class="quote-content"><span class="link-des">'.concat(n.displayName,":").concat(n.content,"</span></div>"),a):n:"引用消息"+t;case 24:case"ShiPinHao":return n.title?"\n                    <div>\n                      <p>".concat(n.title,'</p>\n                      <img style="width:200px;" src="').concat(n.thumb,'" alt="好友头像" />\n                    </div>\n                    <div style="display:flex;align-items:center;">\n                      <img style="width:30px;border-radius:15px;" class="namecard-img" src="').concat(n.avatar,'" alt="好友头像" />\n                      <span style="margin-left:10px;">').concat(n.nickname,"</span>\n                    </div>\n                  "):t;case 26:case"PaiYiPai":return t;default:return"不支持的消息类型 ".concat(e.ContentType)}}catch(y){return console.log(y),e}},whatToDo:function(e){switch(e.ContentType){case"Voice":case"Picture":case"Video":case"File":this.getChatDetail(e);break;case"Link":case 6:this.openLink(e);break;case"MoneyTrans":this.taskTransMoney(e);break;default:console.log(e);break}},getChatDetail:function(e){var t=e.WeChatId,i=e.FriendId,n=e.MsgId,s=e.MsgSvrId,a=e.ContentType,r=e.Url,o=r||this.bigImageMap[n]||"";if(o)if("Picture"===a){this.bigImageUrl=o;var c=document.getElementById("bigImageBox");c&&c.click()}else if("File"===a)this.$confirm("下载该文件?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=document.createElement("a");e.setAttribute("href",o),e.setAttribute("target","_blank"),e.setAttribute("id","file_a"),document.getElementById("file_a")&&document.body.removeChild(document.getElementById("file_a")),document.body.appendChild(e),e.click()})).catch((function(){}));else{if("Video"===a)return;if("Voice"===a)return}else s?(Object(d["u"])(t,i,n,s,"",!1),this.$message({type:"info",message:"正在从手机获取资源，请稍后再试！",duration:1e3})):this.$message({type:"warning",message:"没有MsgSvrId不能获取资源！",duration:2e3})},openLink:function(e){var t=e.Content,i=new RegExp(/^{.+}$/);if((e.FriendId.indexOf("@chatroom")>0||e.FriendId.indexOf("@im.chatroom")>0)&&(t=t.replace(/\S+?:/,"").replace(/^\n+|\n+$/g,"")),"string"===typeof t&&i.test(t)){var n=JSON.parse(t);switch(n.TypeStr){case"[链接]":if("邀请你加入群聊"===n.Title||"邀请您加入群聊"===n.Title){var s={WeChatId:e.WeChatId,Talker:e.FriendId,MsgSvrId:e.MsgSvrId,MsgContent:JSON.stringify(n)};this.$store.dispatch("websocket/AgreeJoinChatRoomTask",s)}else{var a=n.Url;if("electron"===this.currentMode){var r=window.require("electron"),o=r.shell;o.openExternal(a)}else{var c=document.createElement("a");c.setAttribute("href",a),c.setAttribute("target","_blank"),c.setAttribute("id","js_a"),document.getElementById("js_a")&&document.body.removeChild(document.getElementById("js_a")),document.body.appendChild(c),c.click()}}break;case"[聊天记录]":break;default:break}}},verifyContact:function(e){e.WeChatId&&e.FriendId&&this.$confirm("确认添加好友?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(d["w"])(e.WeChatId,e.FriendId)})).catch((function(){}))},taskTransMoney:function(e){var t=e.Content,i=new RegExp(/^{.+}$/);if((e.FriendId.indexOf("@chatroom")>0||e.FriendId.indexOf("@im.chatroom")>0)&&(t=t.replace(/\S+?:/,"").replace(/^\n+|\n+$/g,"")),"string"===typeof t&&i.test(t)){var n=JSON.parse(t);if(e.IsSend)return;if(n.PaySubType&&3===n.PaySubType)return void this.$message({type:"info",message:"该转账已经接收！",duration:1e3});var s=parseInt((new Date).getTime()/1e3,10);if(s-n.InvalidTime>=86400)return void this.$message({type:"info",message:"该转账已经过期！",duration:1e3});Object(d["x"])(e.WeChatId,e.FriendId,e.MsgSvrId,n.Key)}},queryHbDetailTask:function(e){var t=e.Content,i=new RegExp(/^{.+}$/);(e.FriendId.indexOf("@chatroom")>0||e.FriendId.indexOf("@im.chatroom")>0)&&(t=t.replace(/\S+?:/,"").replace(/^\n+|\n+$/g,"")),"string"===typeof t&&i.test(t)&&(t=JSON.parse(t)),t.Key&&e.WeChatId&&(Object(d["r"])(e.WeChatId,t.Key),this.$message({type:"info",message:"正在获取红包详情！",duration:1e3}))},takeLuckMoney:function(e){var t=e.Content,i=new RegExp(/^{.+}$/);if(e.FriendId.endsWith("chatroom"))t=t.replace(/\S+?:/,"").replace(/^\n+|\n+$/g,""),this.$alert("不能打开自己的红包！","提示");else{if(e.FriendId.endsWith("openim"))return void this.$alert("企业微信的红包暂不支持！","提示");e.IsSend&&this.$alert("不能打开自己的红包！","提示")}if("string"===typeof t&&i.test(t)){var n=JSON.parse(t),s=parseInt((new Date).getTime()/1e3,10);if(s-n.InvalidTime>=86400)return void this.$message.warning("已过期");Object(d["x"])(e.WeChatId,e.FriendId,e.MsgSvrId,n.Key)}},canTransform:function(e){this.transportType.indexOf(e.ContentType)>=0?(this.chat2Transport=e,this.transportMessageVisible=!0):this.$message.info("该消息类型不能转发！")},collectionMsg:function(e){var t=this;console.log(e);var i={Link:6,WeApp:13,Emoji:14,ShiPinHao:24};if("Emoji"===e.ContentType){if(e.IsSend)return void this.$message.warning("不能收藏自己发的emoji!");var n=e.WeChatId,s=e.Content;if(n&&s){var a=JSON.parse(s.replace(/\w{6,20}:{?/,"{")),r=a.Md5;if(!r)return;Object(d["o"])(n,r)}}else{var o=e.Content.replace(/\w{6,20}:{?/,"{");Object(S["c"])(this.currentUser.SupplierId,o,i[e.ContentType],e.MsgSvrId).then((function(e){0===e.code&&t.$message({type:"success",message:"添加到素材库成功！",duration:1e3})})).catch((function(e){t.$alert(e.message,"提示")}))}},setCircleContent:function(e){var t=this.chatListMap.findIndex((function(t){return t===e.MsgSvrId}));if(t>=0)this.$store.commit("circleManager/REMOVE_CHAT_LIST",t);else if(this.$store.commit("circleManager/SET_CHAT_LIST",e),"Picture"===e.ContentType){if(e.Url)return;this.bigImageMap[e.MsgId]?e.Url=this.bigImageMap[e.MsgId]:this.getChatDetail(e)}},handleSelectionChange:function(e){this.multipleSelection=e},beforeCloseHandle:function(e){this.multipleSelection=[],this.$refs.multipleTable.clearSelection(),this.$refs.multipleTable2.clearSelection(),e()},forwardMessage:function(){if(0!==this.multipleSelection.length)if(this.multipleSelection.length>9)this.$alert("最多只能选择9个转发对象！","提示",{type:"warning",confirmButtonText:"确定"});else{var e=[];this.multipleSelection.forEach((function(t){t.FriendId?e.push(t.FriendId):e.push(t.UserName)}));var t={MsgSrvId:this.chat2Transport.MsgSvrId,WeChatId:this.chat2Transport.WeChatId,FriendIds:e.join(","),ExtMsg:"",Talker:this.chat2Transport.FriendId};this.$store.dispatch("websocket/ForwardMessageTask",t),this.transportMessageVisible=!1,this.multipleSelection=[],this.$refs.multipleTable.clearSelection(),this.$refs.multipleTable2.clearSelection()}else this.$alert("至少选择一个转发对象！","提示",{type:"warning",confirmButtonText:"确定"})},handleSizeChange:function(e){this.pageSize=e},handleChatRoomSizeChange:function(e){this.chatRoomPageSize=e},handleCurrentChange:function(e){this.currentPage=e},handleChatRoomCurrentChange:function(e){this.pageNo=e},revokeMessageTask:function(e){(new Date).getTime()-e.CreateTime>=12e4?this.$message.warning("消息发出超过2分钟，不能测回！"):Object(d["v"])(this.currentWeChatId,this.currentFriendId,e.MsgSvrId,"")},atSomebody:function(e){var t=e.Content.split(":")[0];if(this.currentFriend.MemberList&&this.currentFriend.MemberList.indexOf(t)<0)this.$message.warning("该成员已经不在群里！");else{var i=this.getMemberName(e.Content);i?(this.$store.commit("conversation/SET_REMARK",t),this.$store.commit("conversation/SET_CONTENT","".concat(this.atContent,"@").concat(i," "))):this.$message.warning("请先刷新群信息！")}},quoteMsg:function(e){var t={quoteSvrId:e.MsgSvrId||e.MsgSvrId,quoteType:e.ContentType};if(e.FriendId.indexOf("@chatroom")>0||e.FriendId.indexOf("@im.chatroom")>0)if(e.IsSend)t.displayName=this.currentWechat.WeChatNick,t.quoteUser=this.currentWechat.WeChatId,t.content=e.Content;else{var i=e.Content,n=i.split(":")[0];t.quoteUser=n,t.content=i.replace(/\S+?:/,"").replace(/^\n+|\n+$/g,""),t.displayName=this.getMemberName(e.Content)}else e.IsSend?(t.displayName=this.currentWechat.WeChatNick,t.quoteUser=this.currentWechat.WeChatId,t.content=e.Content):(t.displayName=this.currentFriend.FriendNick,t.quoteUser=this.currentFriend.FriendId,t.content=e.Content);this.$store.commit("conversation/SET_QUOTE_MSG",e.MsgSvrId||e.MsgSvrId),this.$store.commit("conversation/SET_QUOTE_DETAIL",t)},knickSomeBody:function(e){var t=this,i=e.Content.split(":")[0],n=this.getMemberName(e.Content);this.currentFriend.MemberList.indexOf(i)<0?this.$message.warning("该成员已经不在群里！"):this.$confirm("是否确认删除成员 ".concat(n," ?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.knicking=!0;var e={WeChatId:t.currentWeChatId,ChatRoomId:t.currentFriendId,Action:3,Content:i};t.$store.dispatch("websocket/ChatRoomActionTask",e),setTimeout((function(){t.knicking=!1}),2e3)})).catch((function(){}))}}},ee=Z,te=(i("284b"),Object(C["a"])(ee,P,$,!1,null,"52f1f9ea",null)),ie=te.exports,ne={components:{ToolsBar:M,AnswerWindow:j,ShowChats:ie},data:function(){return{}},computed:Object(r["a"])({},Object(l["b"])({currentFriend:"conversation/currentFriend"}))},se=ne,ae=(i("f1b7"),Object(C["a"])(se,A,D,!1,null,"93140e5a",null)),re=ae.exports,oe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"conversation-tools"},[i("ul",{staticClass:"tab-list"},[i("li",{staticClass:"tab-item",class:{"tab-item-chose":"FastReply"===e.currentPage},on:{click:function(t){return e.setCurrentPage("FastReply")}}},[e._v(" 公共话术 ")]),i("li",{staticClass:"tab-item",class:{"tab-item-chose":"FriendInfo"===e.currentPage||"ChatRoomManager"===e.currentPage},on:{click:function(t){return e.setCurrentPage("InfoManager")}}},[e._v(" 信息管理 ")])]),i(e.currentPage,{tag:"component"})],1)},ce=[],le=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fast-reply scroll"},[i("el-row",{staticStyle:{"margin-bottom":"5px"},attrs:{type:"flex",align:"middle"}},[i("el-input",{attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.searchContent,callback:function(t){e.searchContent=t},expression:"searchContent"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.queryReply},slot:"append"})],1)],1),e._l(e.groups,(function(t,n){return i("div",{key:n,staticClass:"common-groups"},[i("div",{staticClass:"common-groups-tname"},[i("p",{staticClass:"ellipsis",staticStyle:{width:"200px"},domProps:{textContent:e._s(n)}}),i("div",{staticClass:"reply-btns"},[i("i",{staticClass:"fa fa-chevron-circle-down",attrs:{title:"显示/收起","aria-hidden":"true"},on:{click:function(t){return e.toggleCommonList(n)}}}),i("i",{staticClass:"fa fa-sun-o",attrs:{title:"发送","aria-hidden":"true"},on:{click:function(i){return i.stopPropagation(),e.sendReplys(t)}}})])]),i("div",{directives:[{name:"show",rawName:"v-show",value:-1===e.showGroups.indexOf(n),expression:"showGroups.indexOf(index) === -1"}]},e._l(t,(function(t,n){return i("div",{key:n,staticClass:"every-reply",on:{click:function(i){return e.sendMsg(t)},mouseenter:function(i){return e.showCp(i,t)},mouseleave:e.hideCp}},[i("div",{staticClass:"cp-name"},[i("span",{staticClass:"cpname ellipsis",domProps:{textContent:e._s(t.name)}}),i("div",{staticClass:"show-cp"},[i("i",{staticClass:"fa fa-paper-plane-o",attrs:{title:"发送","aria-hidden":"true"},on:{click:function(i){return i.stopPropagation(),e.sendReply(t)}}})])])])})),0)])})),i("div",{directives:[{name:"show",rawName:"v-show",value:e.currentReply,expression:"currentReply"}],attrs:{id:"replyDetail"}},[e.currentReply&&1===e.currentReply.ctype?i("p",{domProps:{textContent:e._s(e.currentReply.content)}}):e.currentReply&&2===e.currentReply.ctype?i("img",{attrs:{src:e.currentReply.content,alt:"图片"}}):e.currentReply&&3===e.currentReply.ctype?i("video",{attrs:{src:e.currentReply.content,controls:""}}):e.currentReply&&4===e.currentReply.ctype?i("audio",{attrs:{src:e.currentReply.content,controls:""}}):e._e()])],2)},de=[],ue=(i("a434"),{name:"FastReply",data:function(){return{searchContent:"",currentReply:null,showGroups:[]}},computed:Object(r["a"])(Object(r["a"])({},Object(l["b"])({currentUser:"currentUser",publicReply:"conversation/publicReply",currentWeChatId:"conversation/currentWeChatId",currentFriendId:"conversation/currentFriendId"})),{},{groups:function(){var e,t={},i=Object(a["a"])(this.publicReply);try{for(i.s();!(e=i.n()).done;){var n=e.value;if(t[n.tname])t[n.tname].push(n);else{var s=[];s.push(n),t[n.tname]=s}}}catch(r){i.e(r)}finally{i.f()}return t}}),mounted:function(){0===this.publicReply.length&&this.queryReply()},methods:{queryReply:function(){var e=this;Object(S["o"])(this.currentUser.UnionId,this.searchContent).then((function(t){0===t.code&&e.$store.commit("conversation/SET_PUBLIC_REPLY",t.data)})).catch((function(t){e.$message.error(t.message)}))},toggleCommonList:function(e){var t=this.showGroups.indexOf(e);-1===t?this.showGroups.push(e):this.showGroups.splice(t,1)},sendReply:function(e){var t=e.content,i=e.ctype;this.currentWeChatId&&this.currentFriendId&&Object(d["y"])(this.currentWeChatId,this.currentFriendId,i,t)},sendReplys:function(e){var t,i=Object(a["a"])(e);try{for(i.s();!(t=i.n()).done;){var n=t.value;this.sendReply(n)}}catch(s){i.e(s)}finally{i.f()}},showCp:function(e,t){5!==t.ctype&&(this.currentReply=t,document.getElementById("replyDetail").style.top=e.pageY-64-e.offsetY+"px")},hideCp:function(){this.currentReply=null},sendMsg:function(e){var t="Text";switch(e.ctype){case 1:t="Text";break;case 2:t="Picture";break;case 3:t="Video";break;case 4:t="Voice";break;case 5:t="File";break;default:t="Text";break}var i=e.content;if("File"===t){var n=e.name+e.content.replace(/.*\./,".");i=JSON.stringify({name:n,url:e.content,size:"",Source:"公共术语"})}this.$store.commit("conversation/SET_CONTENT_TYPE",t),this.$store.commit("conversation/SET_CONTENT",i)}}}),he=ue,fe=(i("8fc2"),Object(C["a"])(he,le,de,!1,null,"759d7182",null)),pe=fe.exports,me=function(){return i.e("conversation").then(i.bind(null,"2630"))},ge=function(){return i.e("conversation").then(i.bind(null,"3e80"))},Ce=function(){return i.e("conversation").then(i.bind(null,"8d36"))},be={components:{FastReply:pe,FriendInfo:ge,FriendCircle:me,ChatRoomManager:Ce},data:function(){return{currentPage:"FastReply"}},computed:Object(r["a"])({},Object(l["b"])({currentUser:"currentUser",currentWeChatId:"conversation/currentWeChatId",currentFriendId:"conversation/currentFriendId"})),watch:{currentWeChatId:function(){this.resetPage()},currentFriendId:function(){this.resetPage()}},mounted:function(){var e=this;w.$on("toggleAsideRightPage",(function(t){e.currentPage===t?e.resetPage():e.currentPage=t}))},methods:{setCurrentPage:function(e){this.currentPage="InfoManager"===e?this.currentFriendId.endsWith("chatroom")?"ChatRoomManager":"FriendInfo":e},resetPage:function(){this.currentPage="FastReply"}}},ve=be,Ae=(i("8fd4"),Object(C["a"])(ve,oe,ce,!1,null,"d9e7aaf6",null)),De=Ae.exports,ye=i("ca00"),ke={name:"ConversationPage",components:{FirstPart:v,SecondPart:re,ThirdPart:De},data:function(){return{routerViewName:"conversation",chatListVisible:!1}},computed:Object(r["a"])(Object(r["a"])({},Object(l["b"])({chatList:"circleManager/chatList"})),{},{chatMsgData:function(){var e,t=[],i={},n=Object(a["a"])(this.chatList);try{for(n.s();!(e=n.n()).done;){var s=e.value,r=s.WeChatId+s.FriendId;if(i[r]){var o,c=Object(a["a"])(t);try{for(c.s();!(o=c.n()).done;){var l=o.value;if(l.id===r){if("Text"===s.ContentType)l.textContent=l.textContent?l.textContent+" "+s.Content:s.Content;else if("Picture"===s.ContentType)if(s.Url)l.media?l.media.push(s.Url):l.media=[s.Url];else{var d=JSON.parse(s.Content).Thumb;l.media?l.media.push(d):l.media=[d]}break}}}catch(h){c.e(h)}finally{c.f()}}else{i[r]=!0;var u={};u.id=s.WeChatId+s.FriendId,"Text"===s.ContentType?u.textContent=s.Content:"Picture"===s.ContentType&&(s.Url?u.media=[s.Url]:u.media=[JSON.parse(s.Content).Thumb]),t.push(u)}}}catch(h){n.e(h)}finally{n.f()}return t}}),mounted:function(){var e=this;Object(S["a"])(this.$store.getters.currentUser.UnionId).then((function(t){if(0===t.code&&t.data){var i,n=[],s=Object(a["a"])(t.data);try{for(s.s();!(i=s.n()).done;){var r=i.value,o={};for(var c in r)Object.hasOwnProperty.call(r,c)&&("avatar"===c?o["Avatar"]=r.avatar:"isonline"===c?o["IsOnline"]=0===r.isonline:"wechatno"===c?o["WeChatNo"]=r.wechatno:"wechatnick"===c?o["WeChatNick"]=r.wechatnick:"wechatid"===c?o["WeChatId"]=r.wechatid:o[c]=r[c]);n.push(o)}}catch(l){s.e(l)}finally{s.f()}e.$store.commit("conversation/SET_WECHATS",n)}}))},methods:{endMove:function(e){var t=document.getElementById("draggableWrap");t&&(t.style.left=e.clientX-120+"px",t.style.top=e.clientY-64+"px")},showChatList:function(e){var t=document.getElementById("draggableWrap");t&&(t.style.left=(e.clientX-120)/2+"px",t.style.top=(e.clientY-60)/2+"px"),this.chatListVisible=!this.chatListVisible},hideChatList:function(){var e=document.getElementById("draggableWrap");e&&(console.log(window.innerWidth),console.log(window.innerHeight),e.style.left=window.innerWidth-200+"px",e.style.top=window.innerHeight-200+"px"),this.chatListVisible=!1},deleteChatItem:function(e){this.$store.commit("circleManager/DELETE_CHAT_LIST_BY_ID",e.id);var t=localStorage.getItem("chatListLocal");if(t){var i=JSON.parse(t),n=i.filter((function(t){return e.id!==t.WeChatId+t.FriendId}));localStorage.setItem("chatListLocal",JSON.stringify(n))}},sendChatItem:function(e){this.$store.commit("circleManager/SET_CIRCLE_2_SEND",e),this.$router.push({path:"/circleManager"}),this.$store.commit("circleManager/SET_CURRENT_CIRLCLE_NAV","sendCircle")},insertLocalStorage:function(e){var t=this.chatList.filter((function(t){return t.circleId=t.WeChatId+t.FriendId,t.WeChatId+t.FriendId===e.id})),i=localStorage.getItem("chatListLocal");if(i){var n=JSON.parse(i),s=Object(ye["c"])(n.concat(t),"MsgSvrId");localStorage.setItem("chatListLocal",JSON.stringify(s))}else localStorage.setItem("chatListLocal",JSON.stringify(t));this.$message.success("存为草稿成功")}}},xe=ke,Ie=(i("7ca9"),Object(C["a"])(xe,n,s,!1,null,"47711c44",null));t["default"]=Ie.exports}}]);